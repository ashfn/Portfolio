"use strict";
var __create = Object.create;
var __defProp = Object.defineProperty;
var __getOwnPropDesc = Object.getOwnPropertyDescriptor;
var __getOwnPropNames = Object.getOwnPropertyNames;
var __getProtoOf = Object.getPrototypeOf;
var __hasOwnProp = Object.prototype.hasOwnProperty;
var __export = (target, all) => {
  for (var name in all)
    __defProp(target, name, { get: all[name], enumerable: true });
};
var __copyProps = (to, from2, except, desc) => {
  if (from2 && typeof from2 === "object" || typeof from2 === "function") {
    for (let key of __getOwnPropNames(from2))
      if (!__hasOwnProp.call(to, key) && key !== except)
        __defProp(to, key, { get: () => from2[key], enumerable: !(desc = __getOwnPropDesc(from2, key)) || desc.enumerable });
  }
  return to;
};
var __toESM = (mod, isNodeMode, target) => (target = mod != null ? __create(__getProtoOf(mod)) : {}, __copyProps(
  isNodeMode || !mod || !mod.__esModule ? __defProp(target, "default", { value: mod, enumerable: true }) : target,
  mod
));
var __toCommonJS = (mod) => __copyProps(__defProp({}, "__esModule", { value: true }), mod);

// src/index.tsx
var src_exports = {};
__export(src_exports, {
  OstSSP: () => OstSSP,
  Outstatic: () => Outstatic,
  OutstaticApi: () => OutstaticApi,
  OutstaticContext: () => OutstaticContext,
  OutstaticProvider: () => OutstaticProvider,
  PostContext: () => PostContext
});
module.exports = __toCommonJS(src_exports);

// src/pages/index.tsx
var import_client3 = require("@apollo/client");
var import_router7 = require("next/router");
var import_react30 = require("react");

// src/context/index.tsx
var import_react = require("react");
var import_jsx_runtime = require("react/jsx-runtime");
var OutstaticContext = (0, import_react.createContext)({
  repoOwner: "",
  repoSlug: "",
  contentPath: "",
  monorepoPath: "",
  session: null
});
var OutstaticProvider = ({
  children,
  repoOwner,
  repoSlug,
  contentPath,
  monorepoPath,
  session,
  collections,
  pages: pages2,
  addPage,
  removePage
}) => {
  return /* @__PURE__ */ (0, import_jsx_runtime.jsx)(OutstaticContext.Provider, {
    value: {
      repoOwner: repoOwner || "",
      repoSlug: repoSlug || "",
      contentPath: contentPath || "outstatic/content",
      monorepoPath: monorepoPath || "",
      session,
      collections,
      pages: pages2,
      addPage,
      removePage
    },
    children
  });
};
var PostContext = (0, import_react.createContext)({});

// src/graphql/generated/index.ts
var import_client = require("@apollo/client");
var Apollo = __toESM(require("@apollo/client"));
var defaultOptions = {};
var CreateCommitDocument = import_client.gql`
  mutation createCommit($input: CreateCommitOnBranchInput!) {
    createCommitOnBranch(input: $input) {
      commit {
        oid
      }
    }
  }
`;
function useCreateCommitMutation(baseOptions) {
  const options3 = { ...defaultOptions, ...baseOptions };
  return Apollo.useMutation(CreateCommitDocument, options3);
}
var CollectionsDocument = import_client.gql`
  query Collections($owner: String!, $name: String!, $contentPath: String!) {
    repository(owner: $owner, name: $name) {
      id
      object(expression: $contentPath) {
        ... on Tree {
          entries {
            name
          }
        }
      }
    }
  }
`;
var OidDocument = import_client.gql`
  query Oid($owner: String!, $name: String!) {
    repository(owner: $owner, name: $name) {
      id
      ref(qualifiedName: "main") {
        target {
          ... on Commit {
            history(first: 1) {
              nodes {
                oid
              }
            }
          }
        }
      }
    }
  }
`;
function useOidLazyQuery(baseOptions) {
  const options3 = { ...defaultOptions, ...baseOptions };
  return Apollo.useLazyQuery(OidDocument, options3);
}
var PostDocument = import_client.gql`
  query Post($owner: String!, $name: String!, $filePath: String!) {
    repository(owner: $owner, name: $name) {
      id
      object(expression: $filePath) {
        ... on Blob {
          text
        }
      }
    }
  }
`;
function usePostQuery(baseOptions) {
  const options3 = { ...defaultOptions, ...baseOptions };
  return Apollo.useQuery(PostDocument, options3);
}
var PostsDocument = import_client.gql`
  query Posts($owner: String!, $name: String!, $contentPath: String!) {
    repository(owner: $owner, name: $name) {
      id
      object(expression: $contentPath) {
        ... on Tree {
          entries {
            name
            object {
              ... on Blob {
                text
              }
            }
          }
        }
      }
    }
  }
`;
function usePostsQuery(baseOptions) {
  const options3 = { ...defaultOptions, ...baseOptions };
  return Apollo.useQuery(
    PostsDocument,
    options3
  );
}

// src/utils/apollo.ts
var import_client2 = require("@apollo/client");
var import_context = require("@apollo/client/link/context");
var import_cross_fetch = __toESM(require("cross-fetch"));
var import_react2 = require("react");
var apolloClient;
var apolloCache = new import_client2.InMemoryCache({
  typePolicies: {}
});
async function getSession() {
  const response = await (0, import_cross_fetch.default)("/api/outstatic/user");
  return response.json();
}
function createApolloClient(session) {
  const httpLink = (0, import_client2.createHttpLink)({
    uri: "https://api.github.com/graphql",
    fetch: import_cross_fetch.default
  });
  const authLink = (0, import_context.setContext)(async (_, { headers }) => {
    var _a;
    const data = session ? { session } : await getSession();
    const modifiedHeader = {
      headers: {
        ...headers,
        authorization: ((_a = data.session) == null ? void 0 : _a.access_token) ? `Bearer ${data.session.access_token}` : ""
      }
    };
    return modifiedHeader;
  });
  return new import_client2.ApolloClient({
    ssrMode: typeof window === "undefined",
    link: (0, import_client2.from)([authLink, httpLink]),
    cache: apolloCache
  });
}
function initializeApollo(initialState = null, session) {
  const apolloClientGlobal = apolloClient ?? createApolloClient(session);
  if (initialState) {
    apolloClientGlobal.cache.restore(initialState);
  }
  if (typeof window === "undefined")
    return apolloClientGlobal;
  apolloClient = apolloClient ?? apolloClientGlobal;
  return apolloClient;
}
function useApollo(initialState = null, session) {
  const store = (0, import_react2.useMemo)(
    () => initializeApollo(initialState, session),
    [initialState, session]
  );
  return store;
}

// src/utils/auth/auth.ts
var Iron = __toESM(require("@hapi/iron"));

// src/utils/auth/auth-cookies.ts
var import_cookie = require("cookie");
var TOKEN_NAME = "ost_token";
var MAX_AGE = 60 * 60 * 8;
function setTokenCookie(res, token) {
  const cookie = (0, import_cookie.serialize)(TOKEN_NAME, token, {
    maxAge: MAX_AGE,
    expires: new Date(Date.now() + MAX_AGE * 1e3),
    httpOnly: true,
    secure: process.env.NODE_ENV === "production",
    path: "/",
    sameSite: "lax"
  });
  res.setHeader("Set-Cookie", cookie);
}
function removeTokenCookie(res) {
  const cookie = (0, import_cookie.serialize)(TOKEN_NAME, "", {
    maxAge: -1,
    path: "/"
  });
  res.setHeader("Set-Cookie", cookie);
}
function parseCookies(req) {
  var _a;
  if (req.cookies)
    return req.cookies;
  const cookie = (_a = req.headers) == null ? void 0 : _a.cookie;
  return (0, import_cookie.parse)(cookie || "");
}
function getTokenCookie(req) {
  const cookies = parseCookies(req);
  return cookies[TOKEN_NAME];
}

// src/utils/auth/auth.ts
var TOKEN_SECRET = process.env.OST_TOKEN_SECRET ?? "";
async function setLoginSession(res, session) {
  const obj = { ...session };
  const token = await Iron.seal(obj, TOKEN_SECRET, Iron.defaults);
  setTokenCookie(res, token);
}
async function getLoginSession(req) {
  const token = getTokenCookie(req);
  if (!token)
    return null;
  try {
    const session = await Iron.unseal(token, TOKEN_SECRET, Iron.defaults);
    const expires = session.expires + MAX_AGE * 1e3;
    if (Date.now() > expires) {
      throw new Error("Session expired");
    }
    return session;
  } catch {
    return null;
  }
}

// src/utils/envVarsCheck.ts
var initialEnvVars = {
  required: {
    OST_GITHUB_ID: false,
    OST_GITHUB_SECRET: false,
    OST_TOKEN_SECRET: false
  },
  optional: {
    OST_CONTENT_PATH: false,
    OST_REPO_OWNER: false
  }
};
var envVars = function() {
  const envVarsObj = {
    hasMissingEnvVars: false,
    envVars: {
      required: {},
      optional: {}
    }
  };
  if (process.env.OST_REPO_SLUG) {
    initialEnvVars.required.OST_REPO_SLUG = true;
  } else if (process.env.VERCEL_GIT_REPO_SLUG) {
    initialEnvVars.required.VERCEL_GIT_REPO_SLUG = true;
  } else {
    initialEnvVars.required.OST_REPO_SLUG = false;
  }
  Object.entries(initialEnvVars.required).forEach(([key]) => {
    envVarsObj.envVars.required[key] = !!process.env[key];
    if (!process.env[key]) {
      envVarsObj.hasMissingEnvVars = true;
    }
  });
  Object.entries(initialEnvVars.optional).forEach(([key]) => {
    envVarsObj.envVars.optional[key] = !!process.env[key];
  });
  return envVarsObj;
}();

// src/pages/404.tsx
var import_head = __toESM(require("next/head"));
var import_jsx_runtime = require("react/jsx-runtime");
function FourOhFour() {
  return /* @__PURE__ */ (0, import_jsx_runtime.jsxs)(import_jsx_runtime.Fragment, {
    children: [
      /* @__PURE__ */ (0, import_jsx_runtime.jsx)(import_head.default, {
        children: /* @__PURE__ */ (0, import_jsx_runtime.jsx)("title", {
          children: "404 | Outstatic"
        })
      }),
      /* @__PURE__ */ (0, import_jsx_runtime.jsx)("div", {
        className: "absolute bottom-10 w-full left-0 overflow-hidden z-0 md:-top-10",
        children: /* @__PURE__ */ (0, import_jsx_runtime.jsx)("svg", {
          width: "100%",
          height: "100%",
          viewBox: "0 0 1200 365",
          fill: "none",
          xmlns: "http://www.w3.org/2000/svg",
          children: /* @__PURE__ */ (0, import_jsx_runtime.jsx)("path", {
            d: "M-276.32 159.182C-232.477 130.613 -193.037 95.4797 -149.142 66.8773C-123.398 50.1026 -99.0091 30.5473 -69.5694 19.7442C-38.5686 8.36831 -2.85928 -3.31376 37.4064 4.54405C65.5725 10.0406 93.927 20.2194 125.473 43.3305C150.292 61.5127 166.609 84.5943 185.936 114.255C220.569 167.405 225.81 223.228 224.615 265.934C223.2 316.536 198.5 341.652 158.621 340.382C121.027 339.185 71.9868 320.328 45.0005 250.638C8.63388 156.723 111.095 159.937 149.344 159.325C235.509 157.945 334.997 185.056 433.145 218.102C547.034 256.448 651.041 336.753 780 356C940 384.5 1235.5 330.311 1237.95 70.5232",
            stroke: "#1E293B",
            className: "stroke-2 md:stroke-1",
            strokeLinecap: "round"
          })
        })
      }),
      /* @__PURE__ */ (0, import_jsx_runtime.jsxs)("main", {
        className: "relative flex h-screen flex-col items-center justify-center z-10 p-4",
        children: [
          /* @__PURE__ */ (0, import_jsx_runtime.jsx)("h1", {
            className: "mb-8 text-center text-xl font-semibold text-white",
            children: /* @__PURE__ */ (0, import_jsx_runtime.jsx)("svg", {
              fill: "none",
              height: "32",
              viewBox: "0 0 775 135",
              width: "200",
              xmlns: "http://www.w3.org/2000/svg",
              "aria-label": "Outstatic",
              children: /* @__PURE__ */ (0, import_jsx_runtime.jsxs)("g", {
                fill: "#1e293b",
                children: [
                  /* @__PURE__ */ (0, import_jsx_runtime.jsx)("path", {
                    d: "m63.9963 134.869c-11.3546 0-21.0957-1.913-29.2232-5.738-8.008-3.824-14.522-8.904-19.5419-15.239-5.02-6.454-8.72517-13.565-11.11562-21.3344-2.39045-7.769-3.585673-15.5379-3.585673-23.3069 0-7.5299 1.254983-15.1196 3.764953-22.769 2.62949-7.769 6.51394-14.8805 11.65344-21.3347 5.259-6.4543 11.773-11.6535 19.5419-15.59772 7.8885-3.94424 17.0917-5.91636 27.6097-5.91636 10.996 0 20.4383 1.97212 28.3268 5.91636 8.008 3.94422 14.5813 9.20322 19.7213 15.77692 5.139 6.4542 8.964 13.5061 11.474 21.1555 2.63 7.6494 3.944 15.2391 3.944 22.769 0 7.4104-1.314 15.0001-3.944 22.769-2.51 7.6495-6.394 14.7613-11.653 21.3343-5.14 6.455-11.5941 11.654-19.363 15.598-7.769 3.944-16.9722 5.917-27.6097 5.917zm.8964-9.323c6.9323 0 12.9084-1.554 17.9284-4.662 5.1394-3.107 9.3227-7.231 12.5498-12.37 3.3467-5.259 5.7971-10.9962 7.3511-17.2114 1.553-6.3347 2.33-12.6096 2.33-18.8248 0-7.6494-.896-15-2.689-22.0519-1.793-7.1713-4.5419-13.5658-8.2471-19.1833-3.5856-5.7371-8.0677-10.2192-13.4462-13.4463-5.3785-3.3466-11.5937-5.0199-18.6455-5.0199-6.9323 0-12.9682 1.6135-18.1077 4.8406-5.1394 3.2271-9.3227 7.4702-12.5498 12.7292-3.2271 5.1394-5.6773 10.8765-7.3506 17.2112-1.5538 6.2152-2.3307 12.4901-2.3307 18.8248 0 6.2151.8366 12.7889 2.5099 19.7212 1.6734 6.9323 4.2431 13.3865 7.7092 19.3626 3.4662 5.976 7.8885 10.817 13.267 14.522 5.4981 3.705 12.0718 5.558 19.7212 5.558z"
                  }),
                  /* @__PURE__ */ (0, import_jsx_runtime.jsx)("path", {
                    d: "m179.299 134.869c-6.693 0-12.251-1.255-16.673-3.765-4.303-2.51-7.53-6.634-9.681-12.371-2.152-5.857-3.227-13.566-3.227-23.1276v-28.1475c0-2.0319 0-4.1235 0-6.2749.119-2.271.358-4.4821.717-6.6335-2.032.1195-4.183.239-6.454.3585-2.271 0-4.303.0598-6.096.1793v-9.502h4.303c5.976 0 10.458-.5379 13.446-1.6136s5.08-2.2111 6.275-3.4064h6.813v54.6815c0 9.4422 1.314 16.4942 3.944 21.1552 2.629 4.662 7.052 6.933 13.267 6.813 4.064 0 7.948-1.195 11.653-3.586 3.825-2.39 6.933-5.199 9.323-8.426v-42.4901c0-2.6295.06-5.0797.179-7.3507.12-2.3904.359-4.6613.718-6.8127-2.152.1195-4.363.239-6.634.3585-2.271 0-4.363.0598-6.275.1793v-9.502h5.199c5.259 0 9.383-.5379 12.371-1.6136s5.139-2.2111 6.454-3.4064h6.813l-.179 65.9767c0 1.912-.06 4.542-.18 7.888-.119 3.227-.298 6.096-.538 8.606 2.032-.12 4.124-.239 6.275-.359 2.271-.119 4.363-.179 6.275-.179v9.502h-28.506c-.239-1.912-.478-3.705-.717-5.379-.119-1.673-.299-3.286-.538-4.84-3.705 3.466-8.008 6.514-12.908 9.143-4.901 2.63-10.04 3.945-15.419 3.945z"
                  }),
                  /* @__PURE__ */ (0, import_jsx_runtime.jsx)("path", {
                    d: "m283.918 134.869c-2.988 0-5.976-.419-8.964-1.255-2.988-.718-5.797-2.212-8.426-4.483-2.51-2.39-4.482-5.796-5.916-10.219-1.435-4.422-2.152-10.279-2.152-17.57l.359-48.9439h-13.267v-10.0399c3.227-.1196 6.514-1.3148 9.86-3.5857 3.347-2.2709 6.275-5.3187 8.785-9.1435 2.51-3.8247 4.243-7.9482 5.199-12.3705h8.427v25.0997h27.609v9.3227l-27.609.3586-.359 47.8687c0 4.5418.359 8.5458 1.076 12.0118.837 3.347 2.151 5.976 3.944 7.889 1.913 1.793 4.482 2.689 7.709 2.689 2.749 0 5.558-.837 8.427-2.51 2.988-1.673 5.796-4.422 8.426-8.247l6.096 5.378c-2.869 4.184-5.737 7.471-8.606 9.861-2.868 2.39-5.618 4.124-8.247 5.199-2.629 1.195-5.02 1.913-7.171 2.152-2.152.358-3.885.538-5.2.538z"
                  }),
                  /* @__PURE__ */ (0, import_jsx_runtime.jsx)("path", {
                    d: "m358.946 134.869c-5.618 0-10.817-.777-15.598-2.331-4.781-1.434-8.605-3.168-11.474-5.199l.538 5.916h-9.502l-.897-30.837h7.53c.239 4.423 1.614 8.427 4.124 12.012 2.51 3.586 5.737 6.395 9.681 8.427 4.064 2.031 8.426 3.047 13.088 3.047 2.749 0 5.438-.418 8.068-1.255 2.629-.956 4.84-2.33 6.633-4.123 1.793-1.913 2.689-4.243 2.689-6.992 0-2.988-.956-5.439-2.868-7.351-1.793-2.032-4.303-3.825-7.53-5.378-3.108-1.5542-6.693-3.108-10.757-4.6618-3.586-1.4342-7.231-2.9282-10.936-4.482-3.586-1.5538-6.933-3.4064-10.04-5.5578-3.108-2.1514-5.558-4.7809-7.351-7.8885-1.793-3.2271-2.689-7.1714-2.689-11.8327 0-2.749.538-5.6773 1.613-8.7849 1.076-3.2271 2.809-6.1554 5.2-8.7849 2.39-2.749 5.617-4.9602 9.681-6.6335 4.064-1.7928 9.084-2.6893 15.06-2.6893 3.227 0 6.812.5379 10.757 1.6136 4.063 1.0757 7.828 2.9283 11.295 5.5578l-.18-6.2749h9.502v31.5539h-7.709c-.358-4.1833-1.494-8.0678-3.406-11.6535-1.793-3.5856-4.363-6.5139-7.709-8.7849-3.347-2.2709-7.411-3.4064-12.192-3.4064-4.661 0-8.486 1.1953-11.474 3.5857-2.868 2.2709-4.303 5.1395-4.303 8.6056 0 3.4662 1.076 6.275 3.227 8.4264 2.271 2.1514 5.2 4.004 8.785 5.5578 3.586 1.5537 7.47 3.1075 11.654 4.6613 5.02 2.0319 9.741 4.2431 14.163 6.6335 4.422 2.3905 8.008 5.3785 10.757 8.9642s4.124 8.1273 4.124 13.6253c0 5.976-1.554 10.996-4.662 15.06-2.988 3.944-6.872 6.873-11.653 8.785s-9.861 2.869-15.239 2.869z"
                  }),
                  /* @__PURE__ */ (0, import_jsx_runtime.jsx)("path", {
                    d: "m439.216 134.869c-2.988 0-5.976-.419-8.964-1.255-2.988-.718-5.797-2.212-8.427-4.483-2.51-2.39-4.482-5.796-5.916-10.219-1.434-4.422-2.151-10.279-2.151-17.57l.358-48.9439h-13.267v-10.0399c3.227-.1196 6.514-1.3148 9.861-3.5857 3.346-2.2709 6.275-5.3187 8.785-9.1435 2.51-3.8247 4.243-7.9482 5.199-12.3705h8.426v25.0997h27.61v9.3227l-27.61.3586-.358 47.8687c0 4.5418.358 8.5458 1.075 12.0118.837 3.347 2.152 5.976 3.945 7.889 1.912 1.793 4.482 2.689 7.709 2.689 2.749 0 5.558-.837 8.426-2.51 2.988-1.673 5.797-4.422 8.426-8.247l6.096 5.378c-2.869 4.184-5.737 7.471-8.606 9.861-2.868 2.39-5.617 4.124-8.247 5.199-2.629 1.195-5.02 1.913-7.171 2.152-2.151.358-3.884.538-5.199.538z"
                  }),
                  /* @__PURE__ */ (0, import_jsx_runtime.jsx)("path", {
                    d: "m528.944 132c-.239-1.912-.418-3.586-.537-5.02-.12-1.434-.299-2.928-.538-4.482-4.064 4.064-8.427 7.171-13.088 9.323-4.661 2.032-9.502 3.048-14.522 3.048-8.606 0-15.119-2.092-19.542-6.275-4.303-4.303-6.454-9.622-6.454-15.957 0-5.498 1.614-10.279 4.841-14.3423 3.227-4.0638 7.47-7.3507 12.729-9.8606 5.259-2.6295 10.996-4.5419 17.211-5.7371 6.215-1.3148 12.311-1.9721 18.287-1.9721v-10.5778c0-3.8247-.359-7.3506-1.076-10.5777-.717-3.3466-2.211-6.0359-4.482-8.0678-2.151-2.1514-5.558-3.2271-10.219-3.2271-3.108-.1195-6.215.4781-9.323 1.7929-3.107 1.1952-5.498 3.2271-7.171 6.0956.956.9562 1.554 2.0917 1.793 3.4064.358 1.1952.538 2.3307.538 3.4064 0 1.6733-.718 3.5857-2.152 5.7371-1.434 2.0318-3.884 2.988-7.35 2.8685-2.869 0-5.08-.9562-6.634-2.8685-1.434-2.0319-2.151-4.3626-2.151-6.9921 0-4.3028 1.553-8.1275 4.661-11.4741 3.227-3.3467 7.59-5.9762 13.088-7.8885 5.498-1.9124 11.653-2.8686 18.466-2.8686 10.279 0 17.928 2.6893 22.948 8.0678 5.14 5.3785 7.709 13.8646 7.709 25.4583v12.3705c0 3.9443-.059 7.8885-.179 11.8328v12.55c0 1.793-.06 3.825-.179 6.095-.12 2.271-.299 4.662-.538 7.172 2.032-.12 4.124-.239 6.275-.359 2.151-.119 4.183-.179 6.096-.179v9.502zm-1.613-43.0281c-3.825.2391-7.769.7769-11.833 1.6136-3.944.8366-7.53 2.0916-10.757 3.7649s-5.856 3.8247-7.888 6.4546c-1.913 2.629-2.869 5.796-2.869 9.502.239 4.063 1.554 7.051 3.944 8.964 2.51 1.912 5.439 2.868 8.785 2.868 4.184 0 7.889-.777 11.116-2.33 3.227-1.674 6.394-3.945 9.502-6.813-.12-1.315-.179-2.63-.179-3.944 0-1.435 0-2.929 0-4.482 0-1.076 0-3.048 0-5.9168.119-2.988.179-6.2151.179-9.6813z"
                  }),
                  /* @__PURE__ */ (0, import_jsx_runtime.jsx)("path", {
                    d: "m602.217 134.869c-2.988 0-5.976-.419-8.964-1.255-2.988-.718-5.797-2.212-8.427-4.483-2.51-2.39-4.482-5.796-5.916-10.219-1.434-4.422-2.151-10.279-2.151-17.57l.358-48.9439h-13.267v-10.0399c3.227-.1196 6.514-1.3148 9.861-3.5857 3.346-2.2709 6.275-5.3187 8.785-9.1435 2.51-3.8247 4.243-7.9482 5.199-12.3705h8.426v25.0997h27.61v9.3227l-27.61.3586-.358 47.8687c0 4.5418.358 8.5458 1.075 12.0118.837 3.347 2.152 5.976 3.945 7.889 1.912 1.793 4.482 2.689 7.709 2.689 2.749 0 5.558-.837 8.426-2.51 2.988-1.673 5.797-4.422 8.426-8.247l6.096 5.378c-2.868 4.184-5.737 7.471-8.606 9.861-2.868 2.39-5.617 4.124-8.247 5.199-2.629 1.195-5.02 1.913-7.171 2.152-2.151.358-3.884.538-5.199.538z"
                  }),
                  /* @__PURE__ */ (0, import_jsx_runtime.jsx)("path", {
                    d: "m639.057 124.47c3.585 0 6.095-.837 7.53-2.51 1.434-1.673 2.271-4.004 2.51-6.992.358-2.988.538-6.454.538-10.398v-37.1121c0-2.0319.059-4.0638.179-6.0957.119-2.1514.299-4.4223.538-6.8127-2.032.1195-4.184.239-6.455.3585-2.27 0-4.362.0598-6.275.1793v-9.502c5.379 0 9.622-.2391 12.73-.7172 3.227-.5976 5.677-1.2549 7.35-1.9721 1.793-.7171 3.108-1.494 3.945-2.3307h6.812v69.2037c0 2.151-.059 4.362-.179 6.633-.119 2.152-.299 4.363-.538 6.634 1.913-.12 3.825-.179 5.737-.179 2.032-.12 3.885-.24 5.558-.359v9.502h-39.98zm19.183-100.3988c-3.107 0-5.737-1.1354-7.888-3.4063-2.152-2.3905-3.227-5.259-3.227-8.6057 0-3.34658 1.135-6.15536 3.406-8.42628 2.271-2.39045 4.841-3.5856788 7.709-3.5856788 3.108 0 5.677 1.1952288 7.709 3.5856788 2.152 2.27092 3.227 5.0797 3.227 8.42628 0 3.3467-1.075 6.2152-3.227 8.6057-2.032 2.2709-4.601 3.4063-7.709 3.4063z"
                  }),
                  /* @__PURE__ */ (0, import_jsx_runtime.jsx)("path", {
                    d: "m735.314 134.869c-8.008 0-15.359-1.793-22.052-5.379-6.693-3.705-12.072-8.964-16.136-15.777-3.944-6.813-5.916-15.0598-5.916-24.7411 0-6.4542 1.136-12.6096 3.407-18.4662 2.27-5.9761 5.438-11.2949 9.502-15.9562 4.183-4.6614 9.083-8.3068 14.701-10.9363 5.737-2.7491 12.072-4.1236 19.004-4.1236 7.052 0 13.088 1.0757 18.108 3.2271 5.019 2.1514 8.844 4.9602 11.474 8.4264 2.749 3.4661 4.123 7.2311 4.123 11.2948 0 2.8686-.837 5.3785-2.51 7.5299-1.673 2.1515-4.064 3.2272-7.171 3.2272-3.466.1195-5.917-.8965-7.351-3.0479-1.434-2.2709-2.151-4.3625-2.151-6.2749 0-1.0757.179-2.2709.538-3.5857.358-1.4342 1.016-2.6892 1.972-3.7649-.956-2.51-2.51-4.3626-4.662-5.5578-2.151-1.1952-4.362-1.9721-6.633-2.3307s-4.183-.5379-5.737-.5379c-7.291.1196-13.446 3.2869-18.466 9.5021-4.901 6.0956-7.351 14.9403-7.351 26.5339 0 7.4104 1.076 14.0439 3.227 19.9008 2.271 5.856 5.558 10.518 9.861 13.984s9.442 5.259 15.418 5.378c5.379 0 10.578-1.374 15.598-4.123 5.02-2.869 9.083-6.454 12.191-10.757l5.737 5.02c-3.466 5.378-7.47 9.621-12.012 12.729-4.422 3.107-8.964 5.319-13.625 6.633-4.542 1.315-8.905 1.973-13.088 1.973z"
                  })
                ]
              })
            })
          }),
          /* @__PURE__ */ (0, import_jsx_runtime.jsx)("div", {
            className: "text-center mb-20 flex max-w-2xl flex-col items-center p-8 px-4 md:p-8 text-black bg-white rounded-lg border border-gray-200 shadow-md",
            children: /* @__PURE__ */ (0, import_jsx_runtime.jsx)("p", {
              className: "text-2xl",
              children: "404 - Nothing here..."
            })
          })
        ]
      })
    ]
  });
}

// src/pages/edit-collection/index.tsx
var import_yup = require("@hookform/resolvers/yup");
var import_router5 = require("next/router");
var import_pluralize = require("pluralize");
var import_react23 = require("react");
var import_react_hook_form6 = require("react-hook-form");
var import_url_slug3 = require("url-slug");
var yup = __toESM(require("yup"));

// src/components/AdminHeader/index.tsx
var import_link = __toESM(require("next/link"));
var import_react4 = require("react");

// src/utils/auth/hooks.tsx
var import_router = __toESM(require("next/router"));
var import_react3 = require("react");
var import_swr = __toESM(require("swr"));
var fetcher = (url) => fetch(url).then((r) => {
  return r.json();
}).then((data) => {
  return data || null;
});
var useOstSession = ({
  redirectTo,
  redirectIfFound
} = {}) => {
  const { data, error } = (0, import_swr.default)("/api/outstatic/user", fetcher);
  const session = data == null ? void 0 : data.session;
  const finished = Boolean(data);
  const hasUser = Boolean(session);
  (0, import_react3.useEffect)(() => {
    if (!redirectTo || !finished)
      return;
    if (redirectTo && !redirectIfFound && !hasUser || redirectIfFound && hasUser) {
      import_router.default.push(redirectTo);
    }
  }, [redirectTo, redirectIfFound, finished, hasUser]);
  if (!data) {
    return {
      session: null,
      status: "loading"
    };
  }
  if (data && !hasUser || error) {
    return {
      session: null,
      status: "unauthenticated"
    };
  }
  return {
    session,
    status: "authenticated"
  };
};
async function ostSignOut() {
  import_router.default.push("/api/outstatic/signout");
}

// src/components/AdminHeader/index.tsx
var import_jsx_runtime = require("react/jsx-runtime");
var AdminHeader = ({
  name,
  email,
  image,
  status,
  toggleSidebar
}) => {
  const [isOpen, setIsOpen] = (0, import_react4.useState)(false);
  return /* @__PURE__ */ (0, import_jsx_runtime.jsx)(import_jsx_runtime.Fragment, {
    children: /* @__PURE__ */ (0, import_jsx_runtime.jsx)("nav", {
      className: "relative border-b border-gray-200 bg-white px-2 py-2.5 sm:px-4 h-full h-14",
      children: /* @__PURE__ */ (0, import_jsx_runtime.jsxs)("div", {
        className: "mx-auto flex flex-wrap items-center justify-between",
        children: [
          /* @__PURE__ */ (0, import_jsx_runtime.jsxs)("button", {
            "data-collapse-toggle": "mobile-menu-2",
            type: "button",
            className: "ml-1 inline-flex items-center rounded-lg p-2 text-sm text-gray-500 hover:bg-gray-100 focus:outline-none focus:ring-2 focus:ring-gray-200 dark:text-gray-400 md:hidden",
            "aria-controls": "mobile-menu-2",
            "aria-expanded": "false",
            onClick: toggleSidebar,
            children: [
              /* @__PURE__ */ (0, import_jsx_runtime.jsx)("span", {
                className: "sr-only",
                children: "Open main menu"
              }),
              /* @__PURE__ */ (0, import_jsx_runtime.jsx)("svg", {
                className: "h-6 w-6",
                fill: "currentColor",
                viewBox: "0 0 20 20",
                xmlns: "http://www.w3.org/2000/svg",
                children: /* @__PURE__ */ (0, import_jsx_runtime.jsx)("path", {
                  fillRule: "evenodd",
                  d: "M3 5a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zM3 10a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zM3 15a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1z",
                  clipRule: "evenodd"
                })
              }),
              /* @__PURE__ */ (0, import_jsx_runtime.jsx)("svg", {
                className: "hidden h-6 w-6",
                fill: "currentColor",
                viewBox: "0 0 20 20",
                xmlns: "http://www.w3.org/2000/svg",
                children: /* @__PURE__ */ (0, import_jsx_runtime.jsx)("path", {
                  fillRule: "evenodd",
                  d: "M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z",
                  clipRule: "evenodd"
                })
              })
            ]
          }),
          /* @__PURE__ */ (0, import_jsx_runtime.jsx)(import_link.default, {
            href: "/outstatic",
            children: /* @__PURE__ */ (0, import_jsx_runtime.jsx)("a", {
              className: "flex items-center",
              "aria-label": "Outstatic",
              children: /* @__PURE__ */ (0, import_jsx_runtime.jsx)("svg", {
                fill: "none",
                height: "20",
                viewBox: "0 0 775 135",
                width: "115",
                xmlns: "http://www.w3.org/2000/svg",
                children: /* @__PURE__ */ (0, import_jsx_runtime.jsxs)("g", {
                  fill: "#1e293b",
                  children: [
                    /* @__PURE__ */ (0, import_jsx_runtime.jsx)("path", {
                      d: "m63.9963 134.869c-11.3546 0-21.0957-1.913-29.2232-5.738-8.008-3.824-14.522-8.904-19.5419-15.239-5.02-6.454-8.72517-13.565-11.11562-21.3344-2.39045-7.769-3.585673-15.5379-3.585673-23.3069 0-7.5299 1.254983-15.1196 3.764953-22.769 2.62949-7.769 6.51394-14.8805 11.65344-21.3347 5.259-6.4543 11.773-11.6535 19.5419-15.59772 7.8885-3.94424 17.0917-5.91636 27.6097-5.91636 10.996 0 20.4383 1.97212 28.3268 5.91636 8.008 3.94422 14.5813 9.20322 19.7213 15.77692 5.139 6.4542 8.964 13.5061 11.474 21.1555 2.63 7.6494 3.944 15.2391 3.944 22.769 0 7.4104-1.314 15.0001-3.944 22.769-2.51 7.6495-6.394 14.7613-11.653 21.3343-5.14 6.455-11.5941 11.654-19.363 15.598-7.769 3.944-16.9722 5.917-27.6097 5.917zm.8964-9.323c6.9323 0 12.9084-1.554 17.9284-4.662 5.1394-3.107 9.3227-7.231 12.5498-12.37 3.3467-5.259 5.7971-10.9962 7.3511-17.2114 1.553-6.3347 2.33-12.6096 2.33-18.8248 0-7.6494-.896-15-2.689-22.0519-1.793-7.1713-4.5419-13.5658-8.2471-19.1833-3.5856-5.7371-8.0677-10.2192-13.4462-13.4463-5.3785-3.3466-11.5937-5.0199-18.6455-5.0199-6.9323 0-12.9682 1.6135-18.1077 4.8406-5.1394 3.2271-9.3227 7.4702-12.5498 12.7292-3.2271 5.1394-5.6773 10.8765-7.3506 17.2112-1.5538 6.2152-2.3307 12.4901-2.3307 18.8248 0 6.2151.8366 12.7889 2.5099 19.7212 1.6734 6.9323 4.2431 13.3865 7.7092 19.3626 3.4662 5.976 7.8885 10.817 13.267 14.522 5.4981 3.705 12.0718 5.558 19.7212 5.558z"
                    }),
                    /* @__PURE__ */ (0, import_jsx_runtime.jsx)("path", {
                      d: "m179.299 134.869c-6.693 0-12.251-1.255-16.673-3.765-4.303-2.51-7.53-6.634-9.681-12.371-2.152-5.857-3.227-13.566-3.227-23.1276v-28.1475c0-2.0319 0-4.1235 0-6.2749.119-2.271.358-4.4821.717-6.6335-2.032.1195-4.183.239-6.454.3585-2.271 0-4.303.0598-6.096.1793v-9.502h4.303c5.976 0 10.458-.5379 13.446-1.6136s5.08-2.2111 6.275-3.4064h6.813v54.6815c0 9.4422 1.314 16.4942 3.944 21.1552 2.629 4.662 7.052 6.933 13.267 6.813 4.064 0 7.948-1.195 11.653-3.586 3.825-2.39 6.933-5.199 9.323-8.426v-42.4901c0-2.6295.06-5.0797.179-7.3507.12-2.3904.359-4.6613.718-6.8127-2.152.1195-4.363.239-6.634.3585-2.271 0-4.363.0598-6.275.1793v-9.502h5.199c5.259 0 9.383-.5379 12.371-1.6136s5.139-2.2111 6.454-3.4064h6.813l-.179 65.9767c0 1.912-.06 4.542-.18 7.888-.119 3.227-.298 6.096-.538 8.606 2.032-.12 4.124-.239 6.275-.359 2.271-.119 4.363-.179 6.275-.179v9.502h-28.506c-.239-1.912-.478-3.705-.717-5.379-.119-1.673-.299-3.286-.538-4.84-3.705 3.466-8.008 6.514-12.908 9.143-4.901 2.63-10.04 3.945-15.419 3.945z"
                    }),
                    /* @__PURE__ */ (0, import_jsx_runtime.jsx)("path", {
                      d: "m283.918 134.869c-2.988 0-5.976-.419-8.964-1.255-2.988-.718-5.797-2.212-8.426-4.483-2.51-2.39-4.482-5.796-5.916-10.219-1.435-4.422-2.152-10.279-2.152-17.57l.359-48.9439h-13.267v-10.0399c3.227-.1196 6.514-1.3148 9.86-3.5857 3.347-2.2709 6.275-5.3187 8.785-9.1435 2.51-3.8247 4.243-7.9482 5.199-12.3705h8.427v25.0997h27.609v9.3227l-27.609.3586-.359 47.8687c0 4.5418.359 8.5458 1.076 12.0118.837 3.347 2.151 5.976 3.944 7.889 1.913 1.793 4.482 2.689 7.709 2.689 2.749 0 5.558-.837 8.427-2.51 2.988-1.673 5.796-4.422 8.426-8.247l6.096 5.378c-2.869 4.184-5.737 7.471-8.606 9.861-2.868 2.39-5.618 4.124-8.247 5.199-2.629 1.195-5.02 1.913-7.171 2.152-2.152.358-3.885.538-5.2.538z"
                    }),
                    /* @__PURE__ */ (0, import_jsx_runtime.jsx)("path", {
                      d: "m358.946 134.869c-5.618 0-10.817-.777-15.598-2.331-4.781-1.434-8.605-3.168-11.474-5.199l.538 5.916h-9.502l-.897-30.837h7.53c.239 4.423 1.614 8.427 4.124 12.012 2.51 3.586 5.737 6.395 9.681 8.427 4.064 2.031 8.426 3.047 13.088 3.047 2.749 0 5.438-.418 8.068-1.255 2.629-.956 4.84-2.33 6.633-4.123 1.793-1.913 2.689-4.243 2.689-6.992 0-2.988-.956-5.439-2.868-7.351-1.793-2.032-4.303-3.825-7.53-5.378-3.108-1.5542-6.693-3.108-10.757-4.6618-3.586-1.4342-7.231-2.9282-10.936-4.482-3.586-1.5538-6.933-3.4064-10.04-5.5578-3.108-2.1514-5.558-4.7809-7.351-7.8885-1.793-3.2271-2.689-7.1714-2.689-11.8327 0-2.749.538-5.6773 1.613-8.7849 1.076-3.2271 2.809-6.1554 5.2-8.7849 2.39-2.749 5.617-4.9602 9.681-6.6335 4.064-1.7928 9.084-2.6893 15.06-2.6893 3.227 0 6.812.5379 10.757 1.6136 4.063 1.0757 7.828 2.9283 11.295 5.5578l-.18-6.2749h9.502v31.5539h-7.709c-.358-4.1833-1.494-8.0678-3.406-11.6535-1.793-3.5856-4.363-6.5139-7.709-8.7849-3.347-2.2709-7.411-3.4064-12.192-3.4064-4.661 0-8.486 1.1953-11.474 3.5857-2.868 2.2709-4.303 5.1395-4.303 8.6056 0 3.4662 1.076 6.275 3.227 8.4264 2.271 2.1514 5.2 4.004 8.785 5.5578 3.586 1.5537 7.47 3.1075 11.654 4.6613 5.02 2.0319 9.741 4.2431 14.163 6.6335 4.422 2.3905 8.008 5.3785 10.757 8.9642s4.124 8.1273 4.124 13.6253c0 5.976-1.554 10.996-4.662 15.06-2.988 3.944-6.872 6.873-11.653 8.785s-9.861 2.869-15.239 2.869z"
                    }),
                    /* @__PURE__ */ (0, import_jsx_runtime.jsx)("path", {
                      d: "m439.216 134.869c-2.988 0-5.976-.419-8.964-1.255-2.988-.718-5.797-2.212-8.427-4.483-2.51-2.39-4.482-5.796-5.916-10.219-1.434-4.422-2.151-10.279-2.151-17.57l.358-48.9439h-13.267v-10.0399c3.227-.1196 6.514-1.3148 9.861-3.5857 3.346-2.2709 6.275-5.3187 8.785-9.1435 2.51-3.8247 4.243-7.9482 5.199-12.3705h8.426v25.0997h27.61v9.3227l-27.61.3586-.358 47.8687c0 4.5418.358 8.5458 1.075 12.0118.837 3.347 2.152 5.976 3.945 7.889 1.912 1.793 4.482 2.689 7.709 2.689 2.749 0 5.558-.837 8.426-2.51 2.988-1.673 5.797-4.422 8.426-8.247l6.096 5.378c-2.869 4.184-5.737 7.471-8.606 9.861-2.868 2.39-5.617 4.124-8.247 5.199-2.629 1.195-5.02 1.913-7.171 2.152-2.151.358-3.884.538-5.199.538z"
                    }),
                    /* @__PURE__ */ (0, import_jsx_runtime.jsx)("path", {
                      d: "m528.944 132c-.239-1.912-.418-3.586-.537-5.02-.12-1.434-.299-2.928-.538-4.482-4.064 4.064-8.427 7.171-13.088 9.323-4.661 2.032-9.502 3.048-14.522 3.048-8.606 0-15.119-2.092-19.542-6.275-4.303-4.303-6.454-9.622-6.454-15.957 0-5.498 1.614-10.279 4.841-14.3423 3.227-4.0638 7.47-7.3507 12.729-9.8606 5.259-2.6295 10.996-4.5419 17.211-5.7371 6.215-1.3148 12.311-1.9721 18.287-1.9721v-10.5778c0-3.8247-.359-7.3506-1.076-10.5777-.717-3.3466-2.211-6.0359-4.482-8.0678-2.151-2.1514-5.558-3.2271-10.219-3.2271-3.108-.1195-6.215.4781-9.323 1.7929-3.107 1.1952-5.498 3.2271-7.171 6.0956.956.9562 1.554 2.0917 1.793 3.4064.358 1.1952.538 2.3307.538 3.4064 0 1.6733-.718 3.5857-2.152 5.7371-1.434 2.0318-3.884 2.988-7.35 2.8685-2.869 0-5.08-.9562-6.634-2.8685-1.434-2.0319-2.151-4.3626-2.151-6.9921 0-4.3028 1.553-8.1275 4.661-11.4741 3.227-3.3467 7.59-5.9762 13.088-7.8885 5.498-1.9124 11.653-2.8686 18.466-2.8686 10.279 0 17.928 2.6893 22.948 8.0678 5.14 5.3785 7.709 13.8646 7.709 25.4583v12.3705c0 3.9443-.059 7.8885-.179 11.8328v12.55c0 1.793-.06 3.825-.179 6.095-.12 2.271-.299 4.662-.538 7.172 2.032-.12 4.124-.239 6.275-.359 2.151-.119 4.183-.179 6.096-.179v9.502zm-1.613-43.0281c-3.825.2391-7.769.7769-11.833 1.6136-3.944.8366-7.53 2.0916-10.757 3.7649s-5.856 3.8247-7.888 6.4546c-1.913 2.629-2.869 5.796-2.869 9.502.239 4.063 1.554 7.051 3.944 8.964 2.51 1.912 5.439 2.868 8.785 2.868 4.184 0 7.889-.777 11.116-2.33 3.227-1.674 6.394-3.945 9.502-6.813-.12-1.315-.179-2.63-.179-3.944 0-1.435 0-2.929 0-4.482 0-1.076 0-3.048 0-5.9168.119-2.988.179-6.2151.179-9.6813z"
                    }),
                    /* @__PURE__ */ (0, import_jsx_runtime.jsx)("path", {
                      d: "m602.217 134.869c-2.988 0-5.976-.419-8.964-1.255-2.988-.718-5.797-2.212-8.427-4.483-2.51-2.39-4.482-5.796-5.916-10.219-1.434-4.422-2.151-10.279-2.151-17.57l.358-48.9439h-13.267v-10.0399c3.227-.1196 6.514-1.3148 9.861-3.5857 3.346-2.2709 6.275-5.3187 8.785-9.1435 2.51-3.8247 4.243-7.9482 5.199-12.3705h8.426v25.0997h27.61v9.3227l-27.61.3586-.358 47.8687c0 4.5418.358 8.5458 1.075 12.0118.837 3.347 2.152 5.976 3.945 7.889 1.912 1.793 4.482 2.689 7.709 2.689 2.749 0 5.558-.837 8.426-2.51 2.988-1.673 5.797-4.422 8.426-8.247l6.096 5.378c-2.868 4.184-5.737 7.471-8.606 9.861-2.868 2.39-5.617 4.124-8.247 5.199-2.629 1.195-5.02 1.913-7.171 2.152-2.151.358-3.884.538-5.199.538z"
                    }),
                    /* @__PURE__ */ (0, import_jsx_runtime.jsx)("path", {
                      d: "m639.057 124.47c3.585 0 6.095-.837 7.53-2.51 1.434-1.673 2.271-4.004 2.51-6.992.358-2.988.538-6.454.538-10.398v-37.1121c0-2.0319.059-4.0638.179-6.0957.119-2.1514.299-4.4223.538-6.8127-2.032.1195-4.184.239-6.455.3585-2.27 0-4.362.0598-6.275.1793v-9.502c5.379 0 9.622-.2391 12.73-.7172 3.227-.5976 5.677-1.2549 7.35-1.9721 1.793-.7171 3.108-1.494 3.945-2.3307h6.812v69.2037c0 2.151-.059 4.362-.179 6.633-.119 2.152-.299 4.363-.538 6.634 1.913-.12 3.825-.179 5.737-.179 2.032-.12 3.885-.24 5.558-.359v9.502h-39.98zm19.183-100.3988c-3.107 0-5.737-1.1354-7.888-3.4063-2.152-2.3905-3.227-5.259-3.227-8.6057 0-3.34658 1.135-6.15536 3.406-8.42628 2.271-2.39045 4.841-3.5856788 7.709-3.5856788 3.108 0 5.677 1.1952288 7.709 3.5856788 2.152 2.27092 3.227 5.0797 3.227 8.42628 0 3.3467-1.075 6.2152-3.227 8.6057-2.032 2.2709-4.601 3.4063-7.709 3.4063z"
                    }),
                    /* @__PURE__ */ (0, import_jsx_runtime.jsx)("path", {
                      d: "m735.314 134.869c-8.008 0-15.359-1.793-22.052-5.379-6.693-3.705-12.072-8.964-16.136-15.777-3.944-6.813-5.916-15.0598-5.916-24.7411 0-6.4542 1.136-12.6096 3.407-18.4662 2.27-5.9761 5.438-11.2949 9.502-15.9562 4.183-4.6614 9.083-8.3068 14.701-10.9363 5.737-2.7491 12.072-4.1236 19.004-4.1236 7.052 0 13.088 1.0757 18.108 3.2271 5.019 2.1514 8.844 4.9602 11.474 8.4264 2.749 3.4661 4.123 7.2311 4.123 11.2948 0 2.8686-.837 5.3785-2.51 7.5299-1.673 2.1515-4.064 3.2272-7.171 3.2272-3.466.1195-5.917-.8965-7.351-3.0479-1.434-2.2709-2.151-4.3625-2.151-6.2749 0-1.0757.179-2.2709.538-3.5857.358-1.4342 1.016-2.6892 1.972-3.7649-.956-2.51-2.51-4.3626-4.662-5.5578-2.151-1.1952-4.362-1.9721-6.633-2.3307s-4.183-.5379-5.737-.5379c-7.291.1196-13.446 3.2869-18.466 9.5021-4.901 6.0956-7.351 14.9403-7.351 26.5339 0 7.4104 1.076 14.0439 3.227 19.9008 2.271 5.856 5.558 10.518 9.861 13.984s9.442 5.259 15.418 5.378c5.379 0 10.578-1.374 15.598-4.123 5.02-2.869 9.083-6.454 12.191-10.757l5.737 5.02c-3.466 5.378-7.47 9.621-12.012 12.729-4.422 3.107-8.964 5.319-13.625 6.633-4.542 1.315-8.905 1.973-13.088 1.973z"
                    })
                  ]
                })
              })
            })
          }),
          status === "loading" || /* @__PURE__ */ (0, import_jsx_runtime.jsxs)("div", {
            className: "flex items-center md:order-2",
            children: [
              /* @__PURE__ */ (0, import_jsx_runtime.jsxs)("button", {
                type: "button",
                className: "mr-3 flex items-center rounded-full bg-gray-800 text-sm focus:ring-4 focus:ring-gray-300 dark:focus:ring-gray-600 md:mr-0",
                id: "user-menu-button",
                "aria-expanded": "false",
                "data-dropdown-toggle": "dropdown",
                onClick: () => setIsOpen(!isOpen),
                children: [
                  /* @__PURE__ */ (0, import_jsx_runtime.jsx)("span", {
                    className: "sr-only",
                    children: "Open user menu"
                  }),
                  /* @__PURE__ */ (0, import_jsx_runtime.jsx)("img", {
                    className: "h-8 w-8 rounded-full",
                    src: image || "",
                    alt: "user"
                  })
                ]
              }),
              /* @__PURE__ */ (0, import_jsx_runtime.jsxs)("div", {
                className: `right-0 top-[60px] z-50 my-4 w-full list-none divide-y divide-gray-100 rounded-br rounded-bl bg-white text-base shadow md:-right-0 md:top-[52px] md:w-auto ${isOpen ? "block" : "hidden"}`,
                id: "dropdown",
                style: {
                  position: "absolute",
                  margin: "0px"
                },
                children: [
                  /* @__PURE__ */ (0, import_jsx_runtime.jsxs)("div", {
                    className: "py-3 px-4",
                    children: [
                      /* @__PURE__ */ (0, import_jsx_runtime.jsx)("span", {
                        className: "block text-sm text-gray-900",
                        children: name
                      }),
                      /* @__PURE__ */ (0, import_jsx_runtime.jsx)("span", {
                        className: "block truncate text-sm font-medium text-gray-500",
                        children: email
                      })
                    ]
                  }),
                  /* @__PURE__ */ (0, import_jsx_runtime.jsx)("ul", {
                    className: "py-1",
                    "aria-labelledby": "dropdown",
                    children: /* @__PURE__ */ (0, import_jsx_runtime.jsx)("li", {
                      children: /* @__PURE__ */ (0, import_jsx_runtime.jsx)("a", {
                        className: "block cursor-pointer py-2 px-4 text-sm text-gray-700 hover:bg-gray-100",
                        onClick: () => ostSignOut(),
                        children: "Sign out"
                      })
                    })
                  })
                ]
              })
            ]
          })
        ]
      })
    })
  });
};
var AdminHeader_default = AdminHeader;

// src/components/AdminLayout/index.tsx
var import_head2 = __toESM(require("next/head"));
var import_router2 = require("next/router");
var import_react6 = require("react");

// src/components/Sidebar/index.tsx
var import_link2 = __toESM(require("next/link"));
var import_react5 = require("react");
var import_jsx_runtime = require("react/jsx-runtime");
var Sidebar = ({ isOpen = false }) => {
  const { collections } = (0, import_react5.useContext)(OutstaticContext);
  return /* @__PURE__ */ (0, import_jsx_runtime.jsxs)("aside", {
    className: `absolute top-[53px] z-20 h-full w-full md:relative md:top-0 md:block md:w-64 md:min-w-[16rem]${isOpen ? "block" : "hidden"}`,
    "aria-label": "Sidebar",
    children: [
      /* @__PURE__ */ (0, import_jsx_runtime.jsx)("div", {
        className: "py-4 px-3 h-full max-h-[calc(100vh-96px)] overflow-y-scroll scrollbar-hide bg-gray-50 ",
        children: /* @__PURE__ */ (0, import_jsx_runtime.jsxs)("ul", {
          className: "space-y-2",
          children: [
            /* @__PURE__ */ (0, import_jsx_runtime.jsx)("li", {
              children: /* @__PURE__ */ (0, import_jsx_runtime.jsx)(import_link2.default, {
                href: "/outstatic",
                children: /* @__PURE__ */ (0, import_jsx_runtime.jsxs)("a", {
                  className: "flex items-center rounded-lg p-2 text-base font-normal text-gray-900 hover:bg-gray-100",
                  children: [
                    /* @__PURE__ */ (0, import_jsx_runtime.jsxs)("svg", {
                      className: "h-6 w-6 shrink-0 text-gray-500 transition duration-75 group-hover:text-gray-900",
                      xmlns: "http://www.w3.org/2000/svg",
                      viewBox: "0 0 24 24",
                      width: "24",
                      height: "24",
                      children: [
                        /* @__PURE__ */ (0, import_jsx_runtime.jsx)("path", {
                          fill: "none",
                          d: "M0 0h24v24H0z"
                        }),
                        /* @__PURE__ */ (0, import_jsx_runtime.jsx)("path", {
                          fill: "currentColor",
                          d: "M13 21V11h8v10h-8zM3 13V3h8v10H3zm6-2V5H5v6h4zM3 21v-6h8v6H3zm2-2h4v-2H5v2zm10 0h4v-6h-4v6zM13 3h8v6h-8V3zm2 2v2h4V5h-4z"
                        })
                      ]
                    }),
                    /* @__PURE__ */ (0, import_jsx_runtime.jsx)("span", {
                      className: "ml-3",
                      children: "Collections"
                    })
                  ]
                })
              })
            }),
            /* @__PURE__ */ (0, import_jsx_runtime.jsx)(import_jsx_runtime.Fragment, {
              children: collections.map((collection) => /* @__PURE__ */ (0, import_jsx_runtime.jsx)("li", {
                children: /* @__PURE__ */ (0, import_jsx_runtime.jsx)(import_link2.default, {
                  href: `/outstatic/${collection}`,
                  children: /* @__PURE__ */ (0, import_jsx_runtime.jsxs)("a", {
                    className: "flex items-center rounded-lg p-2 text-base font-normal text-gray-900 hover:bg-gray-100",
                    children: [
                      /* @__PURE__ */ (0, import_jsx_runtime.jsx)("svg", {
                        className: "h-6 w-6 shrink-0 text-gray-500 transition duration-75 group-hover:text-gray-900",
                        fill: "none",
                        stroke: "currentColor",
                        viewBox: "0 0 24 24",
                        xmlns: "http://www.w3.org/2000/svg",
                        children: /* @__PURE__ */ (0, import_jsx_runtime.jsx)("path", {
                          strokeLinecap: "round",
                          strokeLinejoin: "round",
                          strokeWidth: "2",
                          d: "M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"
                        })
                      }),
                      /* @__PURE__ */ (0, import_jsx_runtime.jsx)("span", {
                        className: "ml-3 capitalize",
                        children: collection
                      })
                    ]
                  })
                })
              }, collection))
            }),
            /* @__PURE__ */ (0, import_jsx_runtime.jsx)("li", {
              children: /* @__PURE__ */ (0, import_jsx_runtime.jsx)(import_link2.default, {
                href: "/outstatic/settings",
                children: /* @__PURE__ */ (0, import_jsx_runtime.jsxs)("a", {
                  className: "flex items-center rounded-lg p-2 text-base font-normal text-gray-900 hover:bg-gray-100",
                  children: [
                    /* @__PURE__ */ (0, import_jsx_runtime.jsx)("svg", {
                      className: "h-6 w-6 shrink-0 text-gray-500 transition duration-75 group-hover:text-gray-900",
                      fill: "none",
                      stroke: "currentColor",
                      viewBox: "0 0 24 24",
                      xmlns: "http://www.w3.org/2000/svg",
                      children: /* @__PURE__ */ (0, import_jsx_runtime.jsx)("path", {
                        strokeLinecap: "round",
                        strokeLinejoin: "round",
                        strokeWidth: 2,
                        d: "M12 6V4m0 2a2 2 0 100 4m0-4a2 2 0 110 4m-6 8a2 2 0 100-4m0 4a2 2 0 110-4m0 4v2m0-6V4m6 6v10m6-2a2 2 0 100-4m0 4a2 2 0 110-4m0 4v2m0-6V4"
                      })
                    }),
                    /* @__PURE__ */ (0, import_jsx_runtime.jsx)("span", {
                      className: "ml-3 flex-1 whitespace-nowrap",
                      children: "Settings"
                    })
                  ]
                })
              })
            })
          ]
        })
      }),
      /* @__PURE__ */ (0, import_jsx_runtime.jsxs)("div", {
        className: "h-10 bg-gray-50 py-2 px-4 border-t text-xs flex justify-between items-center w-full",
        children: [
          /* @__PURE__ */ (0, import_jsx_runtime.jsx)("a", {
            className: "font-semibold text-gray-500 hover:underline hover:text-gray-900",
            href: "https://outstatic.com/docs",
            target: "_blank",
            rel: "noreferrer",
            children: "Documentation"
          }),
          /* @__PURE__ */ (0, import_jsx_runtime.jsxs)("div", {
            className: "gap-4 flex",
            children: [
              /* @__PURE__ */ (0, import_jsx_runtime.jsx)("a", {
                href: "https://github.com/avitorio/outstatic",
                target: "_blank",
                "aria-label": "Github",
                rel: "noreferrer",
                className: "group",
                children: /* @__PURE__ */ (0, import_jsx_runtime.jsx)("svg", {
                  xmlns: "http://www.w3.org/2000/svg",
                  width: "20",
                  height: "20",
                  fill: "none",
                  "aria-label": "Github logo",
                  children: /* @__PURE__ */ (0, import_jsx_runtime.jsx)("path", {
                    fillRule: "evenodd",
                    clipRule: "evenodd",
                    d: "M8 0C3.58 0 0 3.58 0 8C0 11.54 2.29 14.53 5.47 15.59C5.87 15.66 6.02 15.42 6.02 15.21C6.02 15.02 6.01 14.39 6.01 13.72C4 14.09 3.48 13.23 3.32 12.78C3.23 12.55 2.84 11.84 2.5 11.65C2.22 11.5 1.82 11.13 2.49 11.12C3.12 11.11 3.57 11.7 3.72 11.94C4.44 13.15 5.59 12.81 6.05 12.6C6.12 12.08 6.33 11.73 6.56 11.53C4.78 11.33 2.92 10.64 2.92 7.58C2.92 6.71 3.23 5.99 3.74 5.43C3.66 5.23 3.38 4.41 3.82 3.31C3.82 3.31 4.49 3.1 6.02 4.13C6.66 3.95 7.34 3.86 8.02 3.86C8.7 3.86 9.38 3.95 10.02 4.13C11.55 3.09 12.22 3.31 12.22 3.31C12.66 4.41 12.38 5.23 12.3 5.43C12.81 5.99 13.12 6.7 13.12 7.58C13.12 10.65 11.25 11.33 9.47 11.53C9.76 11.78 10.01 12.26 10.01 13.01C10.01 14.08 10 14.94 10 15.21C10 15.42 10.15 15.67 10.55 15.59C13.71 14.53 16 11.53 16 8C16 3.58 12.42 0 8 0Z",
                    transform: "scale(1.2)",
                    className: "fill-gray-400 group-hover:fill-gray-900"
                  })
                })
              }),
              /* @__PURE__ */ (0, import_jsx_runtime.jsx)("a", {
                href: "https://twitter.com/outstatic",
                target: "_blank",
                "aria-label": "Twitter",
                rel: "noreferrer",
                className: "group",
                children: /* @__PURE__ */ (0, import_jsx_runtime.jsx)("svg", {
                  xmlns: "http://www.w3.org/2000/svg",
                  viewBox: "0 0 248 204",
                  width: "20",
                  height: "20",
                  fill: "none",
                  children: /* @__PURE__ */ (0, import_jsx_runtime.jsx)("path", {
                    className: "fill-gray-400 group-hover:fill-gray-900",
                    d: "M221.95 51.29c.15 2.17.15 4.34.15 6.53 0 66.73-50.8 143.69-143.69 143.69v-.04c-27.44.04-54.31-7.82-77.41-22.64 3.99.48 8 .72 12.02.73 22.74.02 44.83-7.61 62.72-21.66-21.61-.41-40.56-14.5-47.18-35.07 7.57 1.46 15.37 1.16 22.8-.87-23.56-4.76-40.51-25.46-40.51-49.5v-.64c7.02 3.91 14.88 6.08 22.92 6.32C11.58 63.31 4.74 33.79 18.14 10.71c25.64 31.55 63.47 50.73 104.08 52.76-4.07-17.54 1.49-35.92 14.61-48.25 20.34-19.12 52.33-18.14 71.45 2.19 11.31-2.23 22.15-6.38 32.07-12.26-3.77 11.69-11.66 21.62-22.2 27.93 10.01-1.18 19.79-3.86 29-7.95-6.78 10.16-15.32 19.01-25.2 26.16z"
                  })
                })
              })
            ]
          })
        ]
      })
    ]
  });
};
var Sidebar_default = Sidebar;

// src/components/AdminLayout/index.tsx
var import_jsx_runtime = require("react/jsx-runtime");
function AdminLayout({
  children,
  error,
  settings,
  title
}) {
  const { session, status } = useOstSession();
  const { push, asPath } = (0, import_router2.useRouter)();
  const [openSidebar, setOpenSidebar] = (0, import_react6.useState)(false);
  const toggleSidebar = () => {
    setOpenSidebar(!openSidebar);
  };
  if (status === "unauthenticated") {
    if (typeof window !== "undefined") {
      push(`/outstatic/?callbackUrl=${asPath}`);
    }
    return null;
  }
  return /* @__PURE__ */ (0, import_jsx_runtime.jsxs)(import_jsx_runtime.Fragment, {
    children: [
      /* @__PURE__ */ (0, import_jsx_runtime.jsx)(import_head2.default, {
        children: /* @__PURE__ */ (0, import_jsx_runtime.jsx)("title", {
          children: title ? `${title} | Outstatic` : "Outstatic"
        })
      }),
      status === "loading" ? null : /* @__PURE__ */ (0, import_jsx_runtime.jsxs)("div", {
        className: "flex h-screen flex-col bg-white text-black",
        children: [
          /* @__PURE__ */ (0, import_jsx_runtime.jsx)(AdminHeader_default, {
            ...session == null ? void 0 : session.user,
            status,
            toggleSidebar
          }),
          /* @__PURE__ */ (0, import_jsx_runtime.jsxs)("div", {
            className: "flex grow flex-col-reverse justify-between md:flex-row",
            children: [
              /* @__PURE__ */ (0, import_jsx_runtime.jsx)(Sidebar_default, {
                isOpen: openSidebar
              }),
              /* @__PURE__ */ (0, import_jsx_runtime.jsxs)("main", {
                className: "w-auto flex-auto p-5 md:p-10 bg-white max-h-[calc(100vh-53px)] overflow-y-scroll scrollbar-hide",
                children: [
                  error && /* @__PURE__ */ (0, import_jsx_runtime.jsxs)("div", {
                    className: "mb-6 border border-red-500 p-2",
                    children: [
                      "Something went wrong",
                      " ",
                      /* @__PURE__ */ (0, import_jsx_runtime.jsx)("span", {
                        role: "img",
                        "aria-label": "sad face",
                        children: "\u{1F613}"
                      })
                    ]
                  }),
                  children
                ]
              }),
              settings && settings
            ]
          })
        ]
      })
    ]
  });
}

// src/components/Input/index.tsx
var import_react_hook_form = require("react-hook-form");
var import_jsx_runtime = require("react/jsx-runtime");
var sizes = {
  small: {
    label: "mb-1 block text-sm font-medium text-gray-900",
    input: "block w-full rounded-lg border border-gray-300 bg-gray-50 p-2 text-sm text-gray-900 outline-none focus:border-blue-500 focus:ring-blue-500"
  },
  medium: {
    label: "block mb-2 text-sm font-medium text-gray-900",
    input: "block p-2 w-full text-gray-900 bg-gray-50 rounded-lg border border-gray-300 sm:text-sm outline-none focus:ring-blue-500 focus:border-blue-500"
  }
};
function Input({
  label,
  placeholder = "",
  helperText,
  id,
  type = "text",
  readOnly = false,
  validation,
  wrapperClass,
  className,
  inputSize = "medium",
  ...rest
}) {
  var _a, _b, _c, _d;
  const {
    register,
    formState: { errors }
  } = (0, import_react_hook_form.useFormContext)();
  return /* @__PURE__ */ (0, import_jsx_runtime.jsxs)("div", {
    className: wrapperClass,
    children: [
      label && /* @__PURE__ */ (0, import_jsx_runtime.jsx)("label", {
        htmlFor: id,
        className: `${sizes[inputSize].label}`,
        children: label
      }),
      /* @__PURE__ */ (0, import_jsx_runtime.jsx)("div", {
        className: "relative",
        children: /* @__PURE__ */ (0, import_jsx_runtime.jsx)("input", {
          ...register(id, validation),
          ...rest,
          className: `${sizes[inputSize].input} ${className}`,
          type,
          name: id,
          id,
          readOnly,
          placeholder,
          "aria-describedby": id
        })
      }),
      /* @__PURE__ */ (0, import_jsx_runtime.jsx)(import_jsx_runtime.Fragment, {
        children: (((_a = errors[id]) == null ? void 0 : _a.message) || helperText) && /* @__PURE__ */ (0, import_jsx_runtime.jsxs)("div", {
          className: "mt-1",
          children: [
            helperText && /* @__PURE__ */ (0, import_jsx_runtime.jsx)("p", {
              className: "text-xs text-gray-500",
              children: helperText
            }),
            ((_b = errors[id]) == null ? void 0 : _b.message) && /* @__PURE__ */ (0, import_jsx_runtime.jsx)("span", {
              className: "text-sm text-red-500",
              children: (_d = (_c = errors[id]) == null ? void 0 : _c.message) == null ? void 0 : _d.toString()
            })
          ]
        })
      })
    ]
  });
}

// src/components/MDEFloatingMenu/index.tsx
var import_react8 = require("@tiptap/react");
var import_react9 = require("react");

// src/components/MDEInsertImage/index.tsx
var import_react7 = require("react");

// src/components/MDEMenuButton/index.tsx
var import_jsx_runtime = require("react/jsx-runtime");
var MDEMenuButton = ({
  onClick,
  editor,
  children,
  name,
  disabled = false,
  attributes = {},
  tag = "button",
  htmlFor
}) => {
  const Tag = tag;
  const inputProps = {};
  if (htmlFor) {
    inputProps.htmlFor = htmlFor;
  }
  return /* @__PURE__ */ (0, import_jsx_runtime.jsx)(Tag, {
    onClick: (e) => {
      e.preventDefault();
      onClick();
    },
    title: name,
    className: `group border-r border-black py-2 px-3 last-of-type:border-r-0 disabled:cursor-not-allowed disabled:hover:bg-gray-600 ${editor.isActive(name, attributes) ? "is-active bg-black text-white [&>svg]:fill-white" : "bg-white text-black hover:bg-slate-100"}`,
    disabled,
    ...inputProps,
    children
  });
};
var MDEMenuButton_default = MDEMenuButton;

// src/components/MDEInsertImage/index.tsx
var import_jsx_runtime = require("react/jsx-runtime");
var isValidUrl = (urlString) => {
  try {
    return Boolean(new URL(urlString));
  } catch (e) {
    return false;
  }
};
var MDEInsertImage = ({ editor, setImageMenu }) => {
  const { setFiles } = (0, import_react7.useContext)(PostContext);
  const [showLink, setShowLink] = (0, import_react7.useState)(false);
  const [imageUrl, setImageUrl] = (0, import_react7.useState)("");
  const [errors, setErrors] = (0, import_react7.useState)({ imageUrl: "", uploadImage: "" });
  const addImageFile = async ({
    currentTarget
  }) => {
    var _a, _b;
    if (((_a = currentTarget.files) == null ? void 0 : _a.length) && ((_b = currentTarget.files) == null ? void 0 : _b[0]) !== null) {
      const file = currentTarget.files[0];
      const blob = URL.createObjectURL(file);
      editor.chain().focus().setImage({ src: blob, alt: "" }).run();
      const reader = new FileReader();
      reader.readAsArrayBuffer(file);
      reader.onloadend = () => {
        const bytes = reader.result;
        const buffer = Buffer.from(bytes, "binary");
        setFiles((files) => [
          ...files,
          {
            type: "images",
            blob,
            filename: file.name,
            content: buffer.toString("base64")
          }
        ]);
      };
      editor.chain().blur().run();
    }
  };
  const handleImageInput = (e) => {
    setImageUrl(e.target.value);
  };
  const addImageUrl = (0, import_react7.useCallback)(async () => {
    if (!isValidUrl(imageUrl)) {
      setErrors((oldState) => ({ ...oldState, imageUrl: "Invalid URL" }));
      return null;
    }
    if (imageUrl) {
      editor.chain().focus().setImage({ src: imageUrl, alt: "", title: "an-image-title" }).insertContent("").run();
      editor.chain().blur().run();
    }
    setShowLink(false);
  }, [editor, imageUrl]);
  return /* @__PURE__ */ (0, import_jsx_runtime.jsx)(import_jsx_runtime.Fragment, {
    children: showLink ? /* @__PURE__ */ (0, import_jsx_runtime.jsxs)("div", {
      className: "flex w-[500px] rounded-sm border border-black outline-none",
      children: [
        /* @__PURE__ */ (0, import_jsx_runtime.jsx)(MDEMenuButton_default, {
          onClick: () => setShowLink(false),
          editor,
          name: "back",
          children: /* @__PURE__ */ (0, import_jsx_runtime.jsxs)("svg", {
            xmlns: "http://www.w3.org/2000/svg",
            viewBox: "0 0 24 24",
            width: "24",
            height: "24",
            children: [
              /* @__PURE__ */ (0, import_jsx_runtime.jsx)("path", {
                fill: "none",
                d: "M0 0h24v24H0z"
              }),
              /* @__PURE__ */ (0, import_jsx_runtime.jsx)("path", {
                d: "M7.828 11H20v2H7.828l5.364 5.364-1.414 1.414L4 12l7.778-7.778 1.414 1.414z"
              })
            ]
          })
        }),
        /* @__PURE__ */ (0, import_jsx_runtime.jsxs)("div", {
          className: `relative w-[500px] border-r outline-none border-black`,
          children: [
            /* @__PURE__ */ (0, import_jsx_runtime.jsx)("input", {
              type: "text",
              className: `w-full h-full py-2 px-3 outline-none ${errors.imageUrl ? "bg-red-50" : "bg-white"}`,
              placeholder: "Insert link here",
              onChange: handleImageInput,
              value: imageUrl,
              onKeyDown: (e) => {
                if (e.key === "Enter") {
                  addImageUrl();
                }
                if (e.key === "Escape") {
                  setShowLink(false);
                }
              },
              onFocus: () => setErrors({ ...errors, imageUrl: "" }),
              autoFocus: true
            }),
            errors.imageUrl && /* @__PURE__ */ (0, import_jsx_runtime.jsx)("span", {
              className: "absolute text-red-500 top-10 left-0",
              children: errors.imageUrl
            })
          ]
        }),
        /* @__PURE__ */ (0, import_jsx_runtime.jsx)(MDEMenuButton_default, {
          onClick: addImageUrl,
          editor,
          name: "back",
          children: "Done"
        })
      ]
    }) : /* @__PURE__ */ (0, import_jsx_runtime.jsxs)("div", {
      className: "flex rounded-sm border border-black outline-none",
      children: [
        /* @__PURE__ */ (0, import_jsx_runtime.jsx)(MDEMenuButton_default, {
          onClick: () => setImageMenu(false),
          editor,
          name: "back",
          children: /* @__PURE__ */ (0, import_jsx_runtime.jsxs)("svg", {
            xmlns: "http://www.w3.org/2000/svg",
            viewBox: "0 0 24 24",
            width: "24",
            height: "24",
            children: [
              /* @__PURE__ */ (0, import_jsx_runtime.jsx)("path", {
                fill: "none",
                d: "M0 0h24v24H0z"
              }),
              /* @__PURE__ */ (0, import_jsx_runtime.jsx)("path", {
                d: "M7.828 11H20v2H7.828l5.364 5.364-1.414 1.414L4 12l7.778-7.778 1.414 1.414z"
              })
            ]
          })
        }),
        /* @__PURE__ */ (0, import_jsx_runtime.jsx)(MDEMenuButton_default, {
          onClick: () => setShowLink(true),
          editor,
          name: "imageFromLink",
          children: "From link"
        }),
        /* @__PURE__ */ (0, import_jsx_runtime.jsx)("label", {
          htmlFor: "upload-button",
          className: "group cursor-pointer border-l border-black py-2 px-3 last-of-type:border-r-0 disabled:cursor-not-allowed disabled:hover:bg-gray-600 hover:bg-slate-100",
          children: "From file"
        }),
        /* @__PURE__ */ (0, import_jsx_runtime.jsx)("input", {
          type: "file",
          accept: "image/*",
          id: "upload-button",
          onChange: addImageFile,
          className: "hidden"
        })
      ]
    })
  });
};
var MDEInsertImage_default = MDEInsertImage;

// src/components/MDEFloatingMenu/index.tsx
var import_jsx_runtime = require("react/jsx-runtime");
var MDEFloatingMenu = ({ editor }) => {
  const [imageMenu, setImageMenu] = (0, import_react9.useState)(false);
  return /* @__PURE__ */ (0, import_jsx_runtime.jsx)(import_jsx_runtime.Fragment, {
    children: /* @__PURE__ */ (0, import_jsx_runtime.jsx)(import_react8.FloatingMenu, {
      editor,
      tippyOptions: {
        duration: 100,
        onHidden: () => setImageMenu(false),
        offset: () => editor.isEmpty ? [0, 180] : [0, 10]
      },
      className: "prose-sm",
      children: !imageMenu ? /* @__PURE__ */ (0, import_jsx_runtime.jsxs)("div", {
        className: "rounded-sm border border-black",
        children: [
          /* @__PURE__ */ (0, import_jsx_runtime.jsx)(MDEMenuButton_default, {
            onClick: () => editor.chain().focus().toggleHeading({ level: 2 }).run(),
            editor,
            name: "heading",
            attributes: { level: 2 },
            children: /* @__PURE__ */ (0, import_jsx_runtime.jsx)("svg", {
              width: "24",
              height: "24",
              viewBox: "0 0 24 24",
              xmlns: "http://www.w3.org/2000/svg",
              children: /* @__PURE__ */ (0, import_jsx_runtime.jsx)("path", {
                d: "M13.4211 20H10.0526V7.36842H5V4H18.4737V7.36842H13.4211V20Z"
              })
            })
          }),
          /* @__PURE__ */ (0, import_jsx_runtime.jsx)(MDEMenuButton_default, {
            onClick: () => editor.chain().focus().toggleHeading({ level: 3 }).run(),
            editor,
            name: "heading",
            attributes: { level: 3 },
            children: /* @__PURE__ */ (0, import_jsx_runtime.jsx)("svg", {
              width: "24",
              height: "24",
              viewBox: "0 0 24 24",
              xmlns: "http://www.w3.org/2000/svg",
              children: /* @__PURE__ */ (0, import_jsx_runtime.jsx)("path", {
                d: "M13.25 18.875H10.75V9.5H7V7H17V9.5H13.25V18.875Z"
              })
            })
          }),
          /* @__PURE__ */ (0, import_jsx_runtime.jsx)(MDEMenuButton_default, {
            onClick: () => setImageMenu(true),
            editor,
            name: "image",
            children: /* @__PURE__ */ (0, import_jsx_runtime.jsxs)("svg", {
              xmlns: "http://www.w3.org/2000/svg",
              viewBox: "0 0 24 24",
              width: "24",
              height: "24",
              children: [
                /* @__PURE__ */ (0, import_jsx_runtime.jsx)("path", {
                  fill: "none",
                  d: "M0 0h24v24H0z"
                }),
                /* @__PURE__ */ (0, import_jsx_runtime.jsx)("path", {
                  d: "M4.828 21l-.02.02-.021-.02H2.992A.993.993 0 0 1 2 20.007V3.993A1 1 0 0 1 2.992 3h18.016c.548 0 .992.445.992.993v16.014a1 1 0 0 1-.992.993H4.828zM20 15V5H4v14L14 9l6 6zm0 2.828l-6-6L6.828 19H20v-1.172zM8 11a2 2 0 1 1 0-4 2 2 0 0 1 0 4z"
                })
              ]
            })
          }),
          /* @__PURE__ */ (0, import_jsx_runtime.jsx)(MDEMenuButton_default, {
            onClick: () => editor.chain().focus().toggleCodeBlock({ language: "javascript" }).run(),
            editor,
            name: "codeBlock",
            children: /* @__PURE__ */ (0, import_jsx_runtime.jsxs)("svg", {
              xmlns: "http://www.w3.org/2000/svg",
              viewBox: "0 0 24 24",
              width: "24",
              height: "24",
              children: [
                /* @__PURE__ */ (0, import_jsx_runtime.jsx)("path", {
                  fill: "none",
                  d: "M0 0h24v24H0z"
                }),
                /* @__PURE__ */ (0, import_jsx_runtime.jsx)("path", {
                  d: "M3 3h18a1 1 0 0 1 1 1v16a1 1 0 0 1-1 1H3a1 1 0 0 1-1-1V4a1 1 0 0 1 1-1zm1 2v14h16V5H4zm16 7l-3.536 3.536-1.414-1.415L17.172 12 15.05 9.879l1.414-1.415L20 12zM6.828 12l2.122 2.121-1.414 1.415L4 12l3.536-3.536L8.95 9.88 6.828 12zm4.416 5H9.116l3.64-10h2.128l-3.64 10z"
                })
              ]
            })
          }),
          /* @__PURE__ */ (0, import_jsx_runtime.jsx)(MDEMenuButton_default, {
            onClick: () => editor.chain().focus().toggleBlockquote().run(),
            editor,
            name: "blockquote",
            children: /* @__PURE__ */ (0, import_jsx_runtime.jsxs)("svg", {
              xmlns: "http://www.w3.org/2000/svg",
              viewBox: "0 0 24 24",
              width: "24",
              height: "24",
              children: [
                /* @__PURE__ */ (0, import_jsx_runtime.jsx)("path", {
                  fill: "none",
                  d: "M0 0h24v24H0z"
                }),
                /* @__PURE__ */ (0, import_jsx_runtime.jsx)("path", {
                  d: "M4.583 17.321C3.553 16.227 3 15 3 13.011c0-3.5 2.457-6.637 6.03-8.188l.893 1.378c-3.335 1.804-3.987 4.145-4.247 5.621.537-.278 1.24-.375 1.929-.311 1.804.167 3.226 1.648 3.226 3.489a3.5 3.5 0 0 1-3.5 3.5c-1.073 0-2.099-.49-2.748-1.179zm10 0C13.553 16.227 13 15 13 13.011c0-3.5 2.457-6.637 6.03-8.188l.893 1.378c-3.335 1.804-3.987 4.145-4.247 5.621.537-.278 1.24-.375 1.929-.311 1.804.167 3.226 1.648 3.226 3.489a3.5 3.5 0 0 1-3.5 3.5c-1.073 0-2.099-.49-2.748-1.179z"
                })
              ]
            })
          })
        ]
      }) : /* @__PURE__ */ (0, import_jsx_runtime.jsx)(MDEInsertImage_default, {
        editor,
        setImageMenu
      })
    })
  });
};
var MDEFloatingMenu_default = MDEFloatingMenu;

// src/components/MDEImageMenu/index.tsx
var import_react10 = require("react");
var import_jsx_runtime = require("react/jsx-runtime");
var MDEUImageMenu = ({ editor, setImageSelected }) => {
  const { setFiles } = (0, import_react10.useContext)(PostContext);
  const [showLink, setShowLink] = (0, import_react10.useState)(false);
  const [url, setUrl] = (0, import_react10.useState)("");
  const [showAltText, setShowAltText] = (0, import_react10.useState)(false);
  const [altText, setAltText] = (0, import_react10.useState)("");
  const setLink = (0, import_react10.useCallback)(() => {
    editor.chain().focus().extendMarkRange("link").setLink({ href: url }).run();
    if (url === "" || url === void 0) {
      editor.chain().focus().extendMarkRange("link").unsetLink().run();
    }
    setShowLink(false);
    editor.chain().blur().run();
    setUrl("");
  }, [editor, url]);
  const addAltText = (0, import_react10.useCallback)(() => {
    editor.chain().focus().extendMarkRange("link").unsetLink().updateAttributes("image", {
      alt: altText
    }).setLink({ href: editor.getAttributes("link").href }).run();
    setShowAltText(false);
    setImageSelected(true);
    editor.chain().blur().run();
    setUrl("");
    setAltText("");
  }, [editor, altText, setImageSelected]);
  const removeImage = () => {
    const blob = editor.getAttributes("image").src;
    setFiles((oldState) => {
      return oldState.filter((file) => {
        return file.blob !== blob;
      });
    });
    editor.chain().focus().deleteSelection().run();
    setImageSelected(false);
  };
  return /* @__PURE__ */ (0, import_jsx_runtime.jsxs)(import_jsx_runtime.Fragment, {
    children: [
      showAltText && /* @__PURE__ */ (0, import_jsx_runtime.jsxs)(import_jsx_runtime.Fragment, {
        children: [
          /* @__PURE__ */ (0, import_jsx_runtime.jsx)(MDEMenuButton_default, {
            onClick: () => {
              setShowAltText(false);
              setImageSelected(true);
            },
            editor,
            name: "back",
            children: /* @__PURE__ */ (0, import_jsx_runtime.jsxs)("svg", {
              xmlns: "http://www.w3.org/2000/svg",
              viewBox: "0 0 24 24",
              width: "24",
              height: "24",
              children: [
                /* @__PURE__ */ (0, import_jsx_runtime.jsx)("path", {
                  fill: "none",
                  d: "M0 0h24v24H0z"
                }),
                /* @__PURE__ */ (0, import_jsx_runtime.jsx)("path", {
                  d: "M7.828 11H20v2H7.828l5.364 5.364-1.414 1.414L4 12l7.778-7.778 1.414 1.414z"
                })
              ]
            })
          }),
          /* @__PURE__ */ (0, import_jsx_runtime.jsx)("input", {
            id: "alt-text",
            name: "alt-text",
            required: true,
            className: "w-[500px] border-r border-black py-2 px-3 outline-none",
            placeholder: "Insert alt text here",
            onChange: (e) => {
              setAltText(e.target.value.trim());
            },
            onKeyDown: (e) => {
              if (e.key === "Enter") {
                addAltText();
              }
              if (e.key === "Escape") {
                setShowAltText(false);
                setImageSelected(true);
              }
            },
            defaultValue: altText,
            autoFocus: true
          }),
          /* @__PURE__ */ (0, import_jsx_runtime.jsx)(MDEMenuButton_default, {
            onClick: addAltText,
            editor,
            name: "addAltText",
            children: "Done"
          })
        ]
      }),
      showLink && /* @__PURE__ */ (0, import_jsx_runtime.jsxs)(import_jsx_runtime.Fragment, {
        children: [
          /* @__PURE__ */ (0, import_jsx_runtime.jsx)(MDEMenuButton_default, {
            onClick: () => {
              if (editor.isActive("image")) {
                setImageSelected(true);
              }
              setShowLink(false);
            },
            editor,
            name: "back",
            children: /* @__PURE__ */ (0, import_jsx_runtime.jsxs)("svg", {
              xmlns: "http://www.w3.org/2000/svg",
              viewBox: "0 0 24 24",
              width: "24",
              height: "24",
              children: [
                /* @__PURE__ */ (0, import_jsx_runtime.jsx)("path", {
                  fill: "none",
                  d: "M0 0h24v24H0z"
                }),
                /* @__PURE__ */ (0, import_jsx_runtime.jsx)("path", {
                  d: "M7.828 11H20v2H7.828l5.364 5.364-1.414 1.414L4 12l7.778-7.778 1.414 1.414z"
                })
              ]
            })
          }),
          /* @__PURE__ */ (0, import_jsx_runtime.jsx)("input", {
            id: "link",
            name: "link",
            type: "url",
            required: true,
            className: "w-[500px] border-r border-black py-2 px-3 outline-none",
            placeholder: "Insert link here",
            onChange: (e) => {
              setUrl(e.target.value.trim());
            },
            onKeyDown: (e) => {
              if (e.key === "Enter") {
                setLink();
              }
              if (e.key === "Escape") {
                setShowLink(false);
              }
            },
            autoFocus: true,
            defaultValue: url
          }),
          /* @__PURE__ */ (0, import_jsx_runtime.jsx)(MDEMenuButton_default, {
            onClick: setLink,
            editor,
            name: "submitLink",
            children: "Done"
          })
        ]
      }),
      !showAltText && !showLink && /* @__PURE__ */ (0, import_jsx_runtime.jsxs)(import_jsx_runtime.Fragment, {
        children: [
          /* @__PURE__ */ (0, import_jsx_runtime.jsx)(MDEMenuButton_default, {
            onClick: () => {
              setUrl(editor.getAttributes("link").href);
              setShowLink(true);
            },
            editor,
            name: "link",
            children: /* @__PURE__ */ (0, import_jsx_runtime.jsxs)("svg", {
              xmlns: "http://www.w3.org/2000/svg",
              viewBox: "0 0 24 24",
              width: "24",
              height: "24",
              children: [
                /* @__PURE__ */ (0, import_jsx_runtime.jsx)("path", {
                  fill: "none",
                  d: "M0 0h24v24H0z"
                }),
                /* @__PURE__ */ (0, import_jsx_runtime.jsx)("path", {
                  d: "M18.364 15.536L16.95 14.12l1.414-1.414a5 5 0 1 0-7.071-7.071L9.879 7.05 8.464 5.636 9.88 4.222a7 7 0 0 1 9.9 9.9l-1.415 1.414zm-2.828 2.828l-1.415 1.414a7 7 0 0 1-9.9-9.9l1.415-1.414L7.05 9.88l-1.414 1.414a5 5 0 1 0 7.071 7.071l1.414-1.414 1.415 1.414zm-.708-10.607l1.415 1.415-7.071 7.07-1.415-1.414 7.071-7.07z"
                })
              ]
            })
          }),
          /* @__PURE__ */ (0, import_jsx_runtime.jsx)(MDEMenuButton_default, {
            onClick: () => {
              setAltText(editor.getAttributes("image").alt);
              setShowAltText(true);
            },
            editor,
            name: "image",
            attributes: editor.getAttributes("image").alt ? { alt: editor.getAttributes("image").alt } : { alt: false },
            children: "Alt Text"
          }),
          /* @__PURE__ */ (0, import_jsx_runtime.jsx)(MDEMenuButton_default, {
            onClick: removeImage,
            editor,
            name: "remove-image",
            children: "Remove Image"
          })
        ]
      })
    ]
  });
};
var MDEImageMenu_default = MDEUImageMenu;

// src/components/MDEMenu/index.tsx
var import_react11 = require("@tiptap/react");
var import_react12 = require("react");
var import_jsx_runtime = require("react/jsx-runtime");
var MDEMenu = ({ editor }) => {
  const [imageSelected, setImageSelected] = (0, import_react12.useState)(false);
  const [showLink, setShowLink] = (0, import_react12.useState)(false);
  const [url, setUrl] = (0, import_react12.useState)("");
  const setLink = (0, import_react12.useCallback)(() => {
    editor.chain().focus().extendMarkRange("link").setLink({ href: url }).run();
    if (url === "" || url === void 0) {
      editor.chain().focus().extendMarkRange("link").unsetLink().run();
    }
    setShowLink(false);
    editor.chain().blur().run();
    setUrl("");
  }, [editor, url]);
  (0, import_react12.useEffect)(() => {
    const activeImage = () => {
      if (editor.isActive("image")) {
        setImageSelected(true);
      }
    };
    editor.on("selectionUpdate", activeImage);
    editor.on("focus", activeImage);
  }, [editor]);
  return /* @__PURE__ */ (0, import_jsx_runtime.jsx)(import_react11.BubbleMenu, {
    editor,
    tippyOptions: {
      duration: 100,
      maxWidth: 500,
      onHidden: () => {
        setImageSelected(false);
        setShowLink(false);
      }
    },
    shouldShow: ({ editor: editor2, view, state, from: from2, to }) => {
      const { doc, selection } = state;
      const { empty } = selection;
      const isEmptyTextBlock = !doc.textBetween(from2, to).length && (0, import_react11.isTextSelection)(state.selection);
      if (!view.hasFocus() || empty || isEmptyTextBlock || editor2.isActive("codeBlock")) {
        return false;
      }
      return true;
    },
    children: /* @__PURE__ */ (0, import_jsx_runtime.jsxs)("div", {
      className: "flex rounded-sm border border-black prose-sm",
      children: [
        showLink && /* @__PURE__ */ (0, import_jsx_runtime.jsxs)(import_jsx_runtime.Fragment, {
          children: [
            /* @__PURE__ */ (0, import_jsx_runtime.jsx)(MDEMenuButton_default, {
              onClick: () => {
                setShowLink(false);
              },
              editor,
              name: "back",
              children: /* @__PURE__ */ (0, import_jsx_runtime.jsxs)("svg", {
                xmlns: "http://www.w3.org/2000/svg",
                viewBox: "0 0 24 24",
                width: "24",
                height: "24",
                children: [
                  /* @__PURE__ */ (0, import_jsx_runtime.jsx)("path", {
                    fill: "none",
                    d: "M0 0h24v24H0z"
                  }),
                  /* @__PURE__ */ (0, import_jsx_runtime.jsx)("path", {
                    d: "M7.828 11H20v2H7.828l5.364 5.364-1.414 1.414L4 12l7.778-7.778 1.414 1.414z"
                  })
                ]
              })
            }),
            /* @__PURE__ */ (0, import_jsx_runtime.jsx)("input", {
              id: "link",
              name: "link",
              type: "url",
              required: true,
              className: "w-[500px] border-r border-black py-2 px-3 outline-none",
              placeholder: "Insert link here",
              onChange: (e) => {
                setUrl(e.target.value.trim());
              },
              onKeyDown: (e) => {
                if (e.key === "Enter") {
                  setLink();
                }
                if (e.key === "Escape") {
                  setShowLink(false);
                }
              },
              autoFocus: true,
              defaultValue: url
            }),
            /* @__PURE__ */ (0, import_jsx_runtime.jsx)(MDEMenuButton_default, {
              onClick: setLink,
              editor,
              name: "submitLink",
              children: "Done"
            })
          ]
        }),
        imageSelected && /* @__PURE__ */ (0, import_jsx_runtime.jsx)(MDEImageMenu_default, {
          editor,
          setImageSelected
        }),
        !imageSelected && !showLink && /* @__PURE__ */ (0, import_jsx_runtime.jsxs)(import_jsx_runtime.Fragment, {
          children: [
            /* @__PURE__ */ (0, import_jsx_runtime.jsx)(MDEMenuButton_default, {
              onClick: () => editor.chain().focus().toggleBold().run(),
              editor,
              name: "bold",
              children: /* @__PURE__ */ (0, import_jsx_runtime.jsxs)("svg", {
                xmlns: "http://www.w3.org/2000/svg",
                viewBox: "0 0 24 24",
                width: "24",
                height: "24",
                children: [
                  /* @__PURE__ */ (0, import_jsx_runtime.jsx)("path", {
                    fill: "none",
                    d: "M0 0h24v24H0z"
                  }),
                  /* @__PURE__ */ (0, import_jsx_runtime.jsx)("path", {
                    d: "M8 11h4.5a2.5 2.5 0 1 0 0-5H8v5zm10 4.5a4.5 4.5 0 0 1-4.5 4.5H6V4h6.5a4.5 4.5 0 0 1 3.256 7.606A4.498 4.498 0 0 1 18 15.5zM8 13v5h5.5a2.5 2.5 0 1 0 0-5H8z"
                  })
                ]
              })
            }),
            /* @__PURE__ */ (0, import_jsx_runtime.jsx)(MDEMenuButton_default, {
              onClick: () => editor.chain().focus().toggleItalic().run(),
              editor,
              name: "italic",
              children: /* @__PURE__ */ (0, import_jsx_runtime.jsxs)("svg", {
                xmlns: "http://www.w3.org/2000/svg",
                viewBox: "0 0 24 24",
                width: "24",
                height: "24",
                children: [
                  /* @__PURE__ */ (0, import_jsx_runtime.jsx)("path", {
                    fill: "none",
                    d: "M0 0h24v24H0z"
                  }),
                  /* @__PURE__ */ (0, import_jsx_runtime.jsx)("path", {
                    d: "M15 20H7v-2h2.927l2.116-12H9V4h8v2h-2.927l-2.116 12H15z"
                  })
                ]
              })
            }),
            /* @__PURE__ */ (0, import_jsx_runtime.jsx)(MDEMenuButton_default, {
              onClick: () => {
                setUrl(editor.getAttributes("link").href);
                setShowLink(true);
              },
              editor,
              name: "link",
              children: /* @__PURE__ */ (0, import_jsx_runtime.jsxs)("svg", {
                xmlns: "http://www.w3.org/2000/svg",
                viewBox: "0 0 24 24",
                width: "24",
                height: "24",
                children: [
                  /* @__PURE__ */ (0, import_jsx_runtime.jsx)("path", {
                    fill: "none",
                    d: "M0 0h24v24H0z"
                  }),
                  /* @__PURE__ */ (0, import_jsx_runtime.jsx)("path", {
                    d: "M18.364 15.536L16.95 14.12l1.414-1.414a5 5 0 1 0-7.071-7.071L9.879 7.05 8.464 5.636 9.88 4.222a7 7 0 0 1 9.9 9.9l-1.415 1.414zm-2.828 2.828l-1.415 1.414a7 7 0 0 1-9.9-9.9l1.415-1.414L7.05 9.88l-1.414 1.414a5 5 0 1 0 7.071 7.071l1.414-1.414 1.415 1.414zm-.708-10.607l1.415 1.415-7.071 7.07-1.415-1.414 7.071-7.07z"
                  })
                ]
              })
            }),
            /* @__PURE__ */ (0, import_jsx_runtime.jsx)(MDEMenuButton_default, {
              onClick: () => editor.chain().focus().toggleCode().run(),
              editor,
              name: "code",
              children: /* @__PURE__ */ (0, import_jsx_runtime.jsxs)("svg", {
                xmlns: "http://www.w3.org/2000/svg",
                viewBox: "0 0 24 24",
                width: "24",
                height: "24",
                children: [
                  /* @__PURE__ */ (0, import_jsx_runtime.jsx)("path", {
                    fill: "none",
                    d: "M0 0h24v24H0z"
                  }),
                  /* @__PURE__ */ (0, import_jsx_runtime.jsx)("path", {
                    d: "M23 12l-7.071 7.071-1.414-1.414L20.172 12l-5.657-5.657 1.414-1.414L23 12zM3.828 12l5.657 5.657-1.414 1.414L1 12l7.071-7.071 1.414 1.414L3.828 12z"
                  })
                ]
              })
            }),
            /* @__PURE__ */ (0, import_jsx_runtime.jsx)(MDEMenuButton_default, {
              onClick: () => editor.chain().focus().toggleHeading({ level: 2 }).run(),
              editor,
              name: "heading",
              attributes: { level: 2 },
              children: /* @__PURE__ */ (0, import_jsx_runtime.jsx)("svg", {
                width: "24",
                height: "24",
                viewBox: "0 0 24 24",
                xmlns: "http://www.w3.org/2000/svg",
                children: /* @__PURE__ */ (0, import_jsx_runtime.jsx)("path", {
                  d: "M13.4211 20H10.0526V7.36842H5V4H18.4737V7.36842H13.4211V20Z"
                })
              })
            }),
            /* @__PURE__ */ (0, import_jsx_runtime.jsx)(MDEMenuButton_default, {
              onClick: () => editor.chain().focus().toggleHeading({ level: 3 }).run(),
              editor,
              name: "heading",
              attributes: { level: 3 },
              children: /* @__PURE__ */ (0, import_jsx_runtime.jsx)("svg", {
                width: "24",
                height: "24",
                viewBox: "0 0 24 24",
                xmlns: "http://www.w3.org/2000/svg",
                children: /* @__PURE__ */ (0, import_jsx_runtime.jsx)("path", {
                  d: "M13.25 18.875H10.75V9.5H7V7H17V9.5H13.25V18.875Z"
                })
              })
            }),
            /* @__PURE__ */ (0, import_jsx_runtime.jsx)(MDEMenuButton_default, {
              onClick: () => editor.chain().focus().toggleCodeBlock({ language: "javascript" }).run(),
              editor,
              name: "codeBlock",
              children: /* @__PURE__ */ (0, import_jsx_runtime.jsxs)("svg", {
                xmlns: "http://www.w3.org/2000/svg",
                viewBox: "0 0 24 24",
                width: "24",
                height: "24",
                children: [
                  /* @__PURE__ */ (0, import_jsx_runtime.jsx)("path", {
                    fill: "none",
                    d: "M0 0h24v24H0z"
                  }),
                  /* @__PURE__ */ (0, import_jsx_runtime.jsx)("path", {
                    d: "M3 3h18a1 1 0 0 1 1 1v16a1 1 0 0 1-1 1H3a1 1 0 0 1-1-1V4a1 1 0 0 1 1-1zm1 2v14h16V5H4zm16 7l-3.536 3.536-1.414-1.415L17.172 12 15.05 9.879l1.414-1.415L20 12zM6.828 12l2.122 2.121-1.414 1.415L4 12l3.536-3.536L8.95 9.88 6.828 12zm4.416 5H9.116l3.64-10h2.128l-3.64 10z"
                  })
                ]
              })
            }),
            /* @__PURE__ */ (0, import_jsx_runtime.jsx)(MDEMenuButton_default, {
              onClick: () => editor.chain().focus().toggleBlockquote().run(),
              editor,
              name: "blockquote",
              children: /* @__PURE__ */ (0, import_jsx_runtime.jsxs)("svg", {
                xmlns: "http://www.w3.org/2000/svg",
                viewBox: "0 0 24 24",
                width: "24",
                height: "24",
                children: [
                  /* @__PURE__ */ (0, import_jsx_runtime.jsx)("path", {
                    fill: "none",
                    d: "M0 0h24v24H0z"
                  }),
                  /* @__PURE__ */ (0, import_jsx_runtime.jsx)("path", {
                    d: "M4.583 17.321C3.553 16.227 3 15 3 13.011c0-3.5 2.457-6.637 6.03-8.188l.893 1.378c-3.335 1.804-3.987 4.145-4.247 5.621.537-.278 1.24-.375 1.929-.311 1.804.167 3.226 1.648 3.226 3.489a3.5 3.5 0 0 1-3.5 3.5c-1.073 0-2.099-.49-2.748-1.179zm10 0C13.553 16.227 13 15 13 13.011c0-3.5 2.457-6.637 6.03-8.188l.893 1.378c-3.335 1.804-3.987 4.145-4.247 5.621.537-.278 1.24-.375 1.929-.311 1.804.167 3.226 1.648 3.226 3.489a3.5 3.5 0 0 1-3.5 3.5c-1.073 0-2.099-.49-2.748-1.179z"
                  })
                ]
              })
            }),
            /* @__PURE__ */ (0, import_jsx_runtime.jsx)(MDEMenuButton_default, {
              onClick: () => editor.chain().focus().clearNodes().run(),
              editor,
              name: "clear",
              children: /* @__PURE__ */ (0, import_jsx_runtime.jsxs)("svg", {
                xmlns: "http://www.w3.org/2000/svg",
                viewBox: "0 0 24 24",
                width: "24",
                height: "24",
                children: [
                  /* @__PURE__ */ (0, import_jsx_runtime.jsx)("path", {
                    fill: "none",
                    d: "M0 0h24v24H0z"
                  }),
                  /* @__PURE__ */ (0, import_jsx_runtime.jsx)("path", {
                    d: "M18.537 19.567A9.961 9.961 0 0 1 12 22C6.477 22 2 17.523 2 12S6.477 2 12 2s10 4.477 10 10c0 2.136-.67 4.116-1.81 5.74L17 12h3a8 8 0 1 0-2.46 5.772l.997 1.795z"
                  })
                ]
              })
            })
          ]
        })
      ]
    })
  });
};
var MDEMenu_default = MDEMenu;

// src/components/MDEditor/index.tsx
var import_react13 = require("@tiptap/react");
var import_react_hook_form2 = require("react-hook-form");
var import_jsx_runtime = require("react/jsx-runtime");
var MDEditor = ({ id, editor }) => {
  var _a, _b, _c;
  const {
    watch,
    formState: { errors }
  } = (0, import_react_hook_form2.useFormContext)();
  const watchContent = watch("content");
  return /* @__PURE__ */ (0, import_jsx_runtime.jsxs)(import_jsx_runtime.Fragment, {
    children: [
      editor && /* @__PURE__ */ (0, import_jsx_runtime.jsx)(MDEMenu_default, {
        editor
      }),
      editor && /* @__PURE__ */ (0, import_jsx_runtime.jsx)(MDEFloatingMenu_default, {
        editor
      }),
      /* @__PURE__ */ (0, import_jsx_runtime.jsx)(import_react13.EditorContent, {
        name: "content",
        value: watchContent,
        editor
      }),
      /* @__PURE__ */ (0, import_jsx_runtime.jsx)("div", {
        className: "mt-1",
        children: ((_a = errors[id]) == null ? void 0 : _a.message) && /* @__PURE__ */ (0, import_jsx_runtime.jsx)("span", {
          className: "text-sm text-red-500",
          children: (_c = (_b = errors[id]) == null ? void 0 : _b.message) == null ? void 0 : _c.toString()
        })
      })
    ]
  });
};
var MDEditor_default = MDEditor;

// src/components/PostSettings/index.tsx
var import_router3 = require("next/router");
var import_react19 = require("react");
var import_react_hook_form4 = require("react-hook-form");
var import_url_slug = require("url-slug");

// src/components/Accordion/index.tsx
var import_react14 = require("react");
var import_jsx_runtime = require("react/jsx-runtime");
var Accordion = ({ title, callback, children }) => {
  const [show, setShow] = (0, import_react14.useState)(false);
  const handleShow = () => {
    setShow(!show);
    if (callback) {
      callback();
    }
  };
  return /* @__PURE__ */ (0, import_jsx_runtime.jsxs)("div", {
    className: "w-full border-b first:border-t",
    children: [
      /* @__PURE__ */ (0, import_jsx_runtime.jsx)("h2", {
        id: "accordion-collapse-heading-1",
        children: /* @__PURE__ */ (0, import_jsx_runtime.jsxs)("button", {
          type: "button",
          className: "flex items-center justify-between w-full text-sm font-medium text-gray-900 p-4 hover:bg-gray-50 focus:outline-none focus:outline-blue-300 focus:outline-offset-[-1px]",
          onClick: handleShow,
          children: [
            /* @__PURE__ */ (0, import_jsx_runtime.jsx)("span", {
              children: title
            }),
            /* @__PURE__ */ (0, import_jsx_runtime.jsx)("svg", {
              "data-accordion-icon": true,
              className: `w-6 h-6 shrink-0 ${show ? "" : "rotate-180"}`,
              fill: "currentColor",
              viewBox: "0 0 20 20",
              xmlns: "http://www.w3.org/2000/svg",
              children: /* @__PURE__ */ (0, import_jsx_runtime.jsx)("path", {
                fillRule: "evenodd",
                d: "M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z",
                clipRule: "evenodd"
              })
            })
          ]
        })
      }),
      /* @__PURE__ */ (0, import_jsx_runtime.jsx)("div", {
        className: show ? "block" : "hidden",
        children: /* @__PURE__ */ (0, import_jsx_runtime.jsx)("div", {
          className: "p-4 font-light border-gray-200 border-t",
          children
        })
      })
    ]
  });
};
var Accordion_default = Accordion;

// src/components/DateTimePicker/index.tsx
var import_react15 = require("react");
var import_react_datepicker = __toESM(require("react-datepicker"));
var import_jsx_runtime = require("react/jsx-runtime");
var options = {
  year: "numeric",
  month: "long",
  day: "numeric"
};
var getYear = (date2) => {
  return date2.getFullYear();
};
var getMonth = (date2) => {
  return date2.getMonth();
};
var years = Array.from(
  { length: 100 },
  (_, i) => new Date().getFullYear() - i
);
var months = [
  "January",
  "February",
  "March",
  "April",
  "May",
  "June",
  "July",
  "August",
  "September",
  "October",
  "November",
  "December"
];
var DateTimePicker = ({ date: date2, setDate, id, label }) => {
  const DatePickerButton = (props, ref) => /* @__PURE__ */ (0, import_jsx_runtime.jsx)("button", {
    ...props,
    ref,
    className: "block cursor-pointer appearance-none rounded-lg border border-gray-300 bg-gray-50 p-2 text-sm text-gray-900 focus:border-blue-500 focus:ring-blue-500",
    disabled: !date2,
    children: date2 ? date2.toLocaleDateString("en-US", options) : "Loading"
  });
  return /* @__PURE__ */ (0, import_jsx_runtime.jsxs)(import_jsx_runtime.Fragment, {
    children: [
      label && /* @__PURE__ */ (0, import_jsx_runtime.jsx)("label", {
        className: "block text-sm font-medium text-gray-900",
        htmlFor: id,
        children: label
      }),
      /* @__PURE__ */ (0, import_jsx_runtime.jsx)("div", {
        children: /* @__PURE__ */ (0, import_jsx_runtime.jsx)(import_react_datepicker.default, {
          name: id,
          selected: date2,
          onChange: (date3) => {
            setDate(date3);
          },
          renderCustomHeader: ({
            date: date3,
            changeYear,
            changeMonth,
            decreaseMonth,
            increaseMonth,
            prevMonthButtonDisabled,
            nextMonthButtonDisabled
          }) => /* @__PURE__ */ (0, import_jsx_runtime.jsxs)("div", {
            className: "react-datepicker__header ",
            children: [
              /* @__PURE__ */ (0, import_jsx_runtime.jsx)("select", {
                className: "react-datepicker__current-month appearance-none cursor-pointer hover:text-blue-500",
                value: getYear(date3),
                onChange: ({ target: { value } }) => changeYear(Number(value)),
                children: years.map((option) => /* @__PURE__ */ (0, import_jsx_runtime.jsx)("option", {
                  value: option,
                  children: option
                }, option))
              }),
              /* @__PURE__ */ (0, import_jsx_runtime.jsx)("select", {
                className: "react-datepicker__current-month appearance-none cursor-pointer hover:text-blue-500",
                value: months[getMonth(date3)],
                onChange: ({ target: { value } }) => changeMonth(months.indexOf(value)),
                children: months.map((option) => /* @__PURE__ */ (0, import_jsx_runtime.jsx)("option", {
                  value: option,
                  children: option
                }, option))
              }),
              /* @__PURE__ */ (0, import_jsx_runtime.jsx)("button", {
                onClick: decreaseMonth,
                disabled: prevMonthButtonDisabled,
                type: "button",
                className: "react-datepicker__navigation react-datepicker__navigation--previous",
                "aria-label": "Previous Month",
                children: /* @__PURE__ */ (0, import_jsx_runtime.jsx)("span", {
                  className: "react-datepicker__navigation-icon react-datepicker__navigation-icon--previous",
                  children: "Previous Month"
                })
              }),
              /* @__PURE__ */ (0, import_jsx_runtime.jsx)("button", {
                onClick: increaseMonth,
                disabled: nextMonthButtonDisabled,
                type: "button",
                className: "react-datepicker__navigation react-datepicker__navigation--next",
                "aria-label": "Next Month",
                children: /* @__PURE__ */ (0, import_jsx_runtime.jsx)("span", {
                  className: "react-datepicker__navigation-icon react-datepicker__navigation-icon--next",
                  children: "Next Month"
                })
              })
            ]
          }),
          customInput: (0, import_react15.createElement)((0, import_react15.forwardRef)(DatePickerButton)),
          showTimeInput: true,
          timeInputLabel: "Time:"
        })
      })
    ]
  });
};
var DateTimePicker_default = DateTimePicker;

// src/components/DeletePostButton/index.tsx
var import_react17 = require("react");

// src/utils/createCommitInput.ts
var import_js_base64 = require("js-base64");
var createCommitInput = ({
  owner,
  slug,
  oldSlug,
  content,
  oid,
  files = [],
  repoSlug,
  contentPath,
  monorepoPath,
  collection
}) => {
  let fileChanges = {};
  const additions = [];
  const deletions = [];
  if (slug && content) {
    let newContent = content;
    if (files.length > 0) {
      files.forEach(({ filename, blob, type, content: fileContents }) => {
        if (blob && content.search(blob) !== -1) {
          const randString = window.btoa(Math.random().toString()).substring(10, 6);
          const newFilename = filename.toLowerCase().replace(/[^a-zA-Z0-9-_\.]/g, "-").replace(/(\.[^\.]*)?$/, `-${randString}$1`);
          additions.push({
            path: `${monorepoPath ? monorepoPath + "/" : ""}public/${type}/${newFilename}`,
            contents: fileContents
          });
          newContent = newContent.replace(blob, `/${type}/${newFilename}`);
        }
      });
    }
    additions.push({
      path: `${monorepoPath ? monorepoPath + "/" : ""}${contentPath}/${collection}/${slug}.md`,
      contents: (0, import_js_base64.encode)(newContent)
    });
    fileChanges = { additions };
  }
  if (oldSlug) {
    deletions.push({
      path: `${monorepoPath ? monorepoPath + "/" : ""}${contentPath}/${collection}/${oldSlug}.md`
    });
    fileChanges = { ...fileChanges, deletions };
  }
  const headline = slug ? `feat(${collection}): ${slug}` : `feat(${collection}): remove ${oldSlug}`;
  return {
    input: {
      branch: {
        repositoryNameWithOwner: `${owner}/${repoSlug}`,
        branchName: "main"
      },
      message: {
        headline
      },
      fileChanges,
      expectedHeadOid: oid
    }
  };
};

// src/utils/useOid.tsx
var import_react16 = require("react");
var useOid = () => {
  var _a;
  const { repoSlug, repoOwner } = (0, import_react16.useContext)(OutstaticContext);
  const { session } = useOstSession();
  const [oidQuery] = useOidLazyQuery({
    variables: {
      owner: repoOwner || ((_a = session == null ? void 0 : session.user) == null ? void 0 : _a.login) || "",
      name: repoSlug
    },
    fetchPolicy: "no-cache"
  });
  const fetchOid = async () => {
    var _a2, _b, _c, _d, _e;
    try {
      const { data: oidData, error: oidError } = await oidQuery();
      if (oidError) {
        console.error(oidError);
      }
      return (_e = (_d = (_c = (_b = (_a2 = oidData.repository) == null ? void 0 : _a2.ref) == null ? void 0 : _b.target) == null ? void 0 : _c.history) == null ? void 0 : _d.nodes[0]) == null ? void 0 : _e.oid;
    } catch (error) {
      console.error(error);
    }
  };
  return fetchOid;
};
var useOid_default = useOid;

// src/components/Modal/index.tsx
var import_jsx_runtime = require("react/jsx-runtime");
var Modal = ({ children, title, close }) => /* @__PURE__ */ (0, import_jsx_runtime.jsx)("div", {
  className: "fixed inset-x-0 z-50 flex w-full  items-center justify-center overflow-y-auto overflow-x-hidden bg-[rgba(0,0,0,0.5)] md:inset-0 md:h-full",
  children: /* @__PURE__ */ (0, import_jsx_runtime.jsx)("div", {
    className: "relative h-full w-full max-w-2xl p-4 md:h-auto",
    children: /* @__PURE__ */ (0, import_jsx_runtime.jsxs)("div", {
      className: "relative rounded-lg bg-white shadow",
      children: [
        /* @__PURE__ */ (0, import_jsx_runtime.jsxs)("div", {
          className: "flex items-start justify-between rounded-t border-b p-4",
          children: [
            /* @__PURE__ */ (0, import_jsx_runtime.jsx)("h3", {
              className: "text-xl font-semibold text-gray-900",
              children: title
            }),
            /* @__PURE__ */ (0, import_jsx_runtime.jsx)("button", {
              type: "button",
              className: "ml-auto inline-flex items-center rounded-lg bg-transparent p-1.5 text-sm text-gray-400 hover:bg-gray-200 hover:text-gray-900 dark:hover:bg-gray-600 dark:hover:text-white",
              "data-modal-toggle": "defaultModal",
              onClick: close,
              children: /* @__PURE__ */ (0, import_jsx_runtime.jsx)("svg", {
                className: "h-5 w-5",
                fill: "currentColor",
                viewBox: "0 0 20 20",
                xmlns: "http://www.w3.org/2000/svg",
                children: /* @__PURE__ */ (0, import_jsx_runtime.jsx)("path", {
                  fillRule: "evenodd",
                  d: "M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z",
                  clipRule: "evenodd"
                })
              })
            })
          ]
        }),
        children
      ]
    })
  })
});
var Modal_default = Modal;

// src/components/DeletePostButton/index.tsx
var import_jsx_runtime = require("react/jsx-runtime");
var DeletePostButton = ({
  slug,
  disabled = false,
  onComplete = () => {
  },
  collection,
  className
}) => {
  const [showDeleteModal, setShowDeleteModal] = (0, import_react17.useState)(false);
  const [deleting, setDeleting] = (0, import_react17.useState)(false);
  const { session } = useOstSession();
  const [createCommit] = useCreateCommitMutation();
  const { repoOwner, repoSlug, contentPath, monorepoPath } = (0, import_react17.useContext)(OutstaticContext);
  const fetchOid = useOid_default();
  const deletePost = async (slug2) => {
    var _a;
    setDeleting(true);
    try {
      const oid = await fetchOid();
      const owner = repoOwner || ((_a = session == null ? void 0 : session.user) == null ? void 0 : _a.login) || "";
      const commitInput = createCommitInput({
        owner,
        oldSlug: slug2,
        oid,
        repoSlug,
        contentPath,
        monorepoPath,
        collection
      });
      await createCommit({ variables: commitInput });
      setShowDeleteModal(false);
      if (onComplete)
        onComplete();
    } catch (error) {
    }
  };
  return /* @__PURE__ */ (0, import_jsx_runtime.jsxs)(import_jsx_runtime.Fragment, {
    children: [
      /* @__PURE__ */ (0, import_jsx_runtime.jsxs)("button", {
        onClick: () => setShowDeleteModal(true),
        type: "button",
        disabled,
        className: `z-10 inline-block text-gray-500 hover:bg-white focus:ring-4 focus:outline-none focus:ring-gray-200 rounded-lg text-sm p-1.5 ${className}`,
        title: "Delete post",
        children: [
          /* @__PURE__ */ (0, import_jsx_runtime.jsx)("span", {
            className: "sr-only",
            children: "Delete post"
          }),
          /* @__PURE__ */ (0, import_jsx_runtime.jsxs)("svg", {
            xmlns: "http://www.w3.org/2000/svg",
            viewBox: "0 0 24 24",
            width: "24",
            height: "24",
            children: [
              /* @__PURE__ */ (0, import_jsx_runtime.jsx)("path", {
                fill: "none",
                d: "M0 0h24v24H0z"
              }),
              /* @__PURE__ */ (0, import_jsx_runtime.jsx)("path", {
                d: "M17 6h5v2h-2v13a1 1 0 0 1-1 1H5a1 1 0 0 1-1-1V8H2V6h5V3a1 1 0 0 1 1-1h8a1 1 0 0 1 1 1v3zm1 2H6v12h12V8zm-9 3h2v6H9v-6zm4 0h2v6h-2v-6zM9 4v2h6V4H9z"
              })
            ]
          })
        ]
      }),
      showDeleteModal && /* @__PURE__ */ (0, import_jsx_runtime.jsxs)(Modal_default, {
        title: "Delete Post",
        close: () => setShowDeleteModal(false),
        children: [
          /* @__PURE__ */ (0, import_jsx_runtime.jsxs)("div", {
            className: "space-y-6 p-6 text-left",
            children: [
              /* @__PURE__ */ (0, import_jsx_runtime.jsx)("p", {
                className: "text-base leading-relaxed text-gray-500",
                children: "Are you sure you want to delete this post?"
              }),
              /* @__PURE__ */ (0, import_jsx_runtime.jsx)("p", {
                className: "text-base leading-relaxed text-gray-500",
                children: "This action cannot be undone."
              })
            ]
          }),
          /* @__PURE__ */ (0, import_jsx_runtime.jsxs)("div", {
            className: "flex items-center space-x-2 rounded-b border-t p-6",
            children: [
              /* @__PURE__ */ (0, import_jsx_runtime.jsx)("button", {
                type: "button",
                className: "flex rounded-lg bg-red-700 px-5 py-2.5 text-center text-sm font-medium text-white hover:bg-red-800 focus:outline-none",
                onClick: () => {
                  deletePost(slug);
                },
                children: deleting ? /* @__PURE__ */ (0, import_jsx_runtime.jsxs)(import_jsx_runtime.Fragment, {
                  children: [
                    /* @__PURE__ */ (0, import_jsx_runtime.jsxs)("svg", {
                      className: "mr-3 -ml-1 h-5 w-5 animate-spin text-white",
                      xmlns: "http://www.w3.org/2000/svg",
                      fill: "none",
                      viewBox: "0 0 24 24",
                      children: [
                        /* @__PURE__ */ (0, import_jsx_runtime.jsx)("circle", {
                          className: "opacity-25",
                          cx: "12",
                          cy: "12",
                          r: "10",
                          stroke: "currentColor",
                          strokeWidth: "4"
                        }),
                        /* @__PURE__ */ (0, import_jsx_runtime.jsx)("path", {
                          className: "opacity-75",
                          fill: "currentColor",
                          d: "M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"
                        })
                      ]
                    }),
                    "Deleting"
                  ]
                }) : "Delete"
              }),
              /* @__PURE__ */ (0, import_jsx_runtime.jsx)("button", {
                type: "button",
                className: "rounded-lg border border-gray-200 px-5 py-2.5 text-sm font-medium focus:z-10 focus:outline-none focus:ring-4 order-gray-600 bg-gray-800 text-white hover:border-gray-600 hover:bg-gray-700 focus:ring-gray-700",
                onClick: () => setShowDeleteModal(false),
                children: "Cancel"
              })
            ]
          })
        ]
      })
    ]
  });
};
var DeletePostButton_default = DeletePostButton;

// src/components/TextArea/index.tsx
var import_react_hook_form3 = require("react-hook-form");
var import_jsx_runtime = require("react/jsx-runtime");
function TextArea({
  label,
  placeholder = "",
  helperText,
  id,
  type = "text",
  readOnly = false,
  validation,
  wrapperClass,
  ...rest
}) {
  var _a, _b, _c;
  const {
    register,
    formState: { errors }
  } = (0, import_react_hook_form3.useFormContext)();
  return /* @__PURE__ */ (0, import_jsx_runtime.jsxs)("div", {
    className: wrapperClass,
    children: [
      label && /* @__PURE__ */ (0, import_jsx_runtime.jsx)("label", {
        htmlFor: id,
        className: "mb-1 block text-sm font-medium text-gray-900",
        children: label
      }),
      /* @__PURE__ */ (0, import_jsx_runtime.jsx)("div", {
        className: "relative",
        children: /* @__PURE__ */ (0, import_jsx_runtime.jsx)("textarea", {
          ...register(id, validation),
          ...rest,
          name: id,
          id,
          readOnly,
          placeholder,
          "aria-describedby": id
        })
      }),
      /* @__PURE__ */ (0, import_jsx_runtime.jsxs)("div", {
        className: "mt-1",
        children: [
          helperText && /* @__PURE__ */ (0, import_jsx_runtime.jsx)("p", {
            className: "text-xs text-gray-500",
            children: helperText
          }),
          ((_a = errors[id]) == null ? void 0 : _a.message) && /* @__PURE__ */ (0, import_jsx_runtime.jsx)("span", {
            className: "text-sm text-red-500",
            children: (_c = (_b = errors[id]) == null ? void 0 : _b.message) == null ? void 0 : _c.toString()
          })
        ]
      })
    ]
  });
}

// src/components/PostSettingsImageSelection/index.tsx
var import_react18 = require("react");
var import_jsx_runtime = require("react/jsx-runtime");
function resolve(path, obj, separator = ".") {
  var properties = Array.isArray(path) ? path : path.split(separator);
  return [...properties].reduce(
    (prev, curr) => prev == null ? void 0 : prev[curr],
    obj
  );
}
var PostSettingsImageSelection = ({
  name,
  description,
  label
}) => {
  const { post, editPost, setFiles } = (0, import_react18.useContext)(PostContext);
  const [showImage, setShowImage] = (0, import_react18.useState)(false);
  const [showImageOptions, setShowImageOptions] = (0, import_react18.useState)(false);
  const [showLink, setShowLink] = (0, import_react18.useState)(false);
  const [previewLoading, setPreviewLoading] = (0, import_react18.useState)(true);
  const [loadingError, setLoadingError] = (0, import_react18.useState)(false);
  const [image, setImage] = (0, import_react18.useState)("");
  const resolvedImage = resolve(name, post);
  (0, import_react18.useEffect)(() => {
    const image2 = resolvedImage == null ? void 0 : resolvedImage.replace("/images/", `/api/outstatic/images/`);
    setImage(image2 || "");
    setShowImageOptions(!resolvedImage);
    setShowImage(!!resolvedImage);
  }, [resolvedImage]);
  const addImageFile = async ({
    currentTarget
  }) => {
    var _a, _b;
    if (((_a = currentTarget.files) == null ? void 0 : _a.length) && ((_b = currentTarget.files) == null ? void 0 : _b[0]) !== null) {
      const file = currentTarget.files[0];
      const blob = URL.createObjectURL(file);
      editPost(name, blob);
      setShowImage(true);
      const reader = new FileReader();
      reader.readAsArrayBuffer(file);
      reader.onloadend = () => {
        const bytes = reader.result;
        const buffer = Buffer.from(bytes, "binary");
        setFiles((files) => [
          ...files,
          {
            type: "images",
            blob,
            filename: file.name,
            content: buffer.toString("base64")
          }
        ]);
      };
    }
  };
  return /* @__PURE__ */ (0, import_jsx_runtime.jsxs)(import_jsx_runtime.Fragment, {
    children: [
      loadingError && /* @__PURE__ */ (0, import_jsx_runtime.jsx)("div", {
        className: "p-4 mb-4 text-sm text-red-700 bg-red-100 rounded-lg dark:bg-red-200 dark:text-red-800",
        role: "alert",
        children: "The image failed to load, try submitting again."
      }),
      showImage && /* @__PURE__ */ (0, import_jsx_runtime.jsxs)(import_jsx_runtime.Fragment, {
        children: [
          /* @__PURE__ */ (0, import_jsx_runtime.jsx)("div", {
            className: "mb-1 block text-sm font-medium text-gray-900",
            children: description
          }),
          /* @__PURE__ */ (0, import_jsx_runtime.jsxs)("div", {
            className: `w-full relative bg-slate-100 ${previewLoading ? "h-48" : ""}`,
            children: [
              previewLoading && /* @__PURE__ */ (0, import_jsx_runtime.jsx)("div", {
                className: `animate-pulse w-full h-48 bg-slate-200 absolute`
              }),
              /* @__PURE__ */ (0, import_jsx_runtime.jsx)("img", {
                src: image,
                className: "w-full max-h-48 object-contain",
                onLoad: () => {
                  setShowLink(false);
                  setPreviewLoading(false);
                  setLoadingError(false);
                },
                onError: () => {
                  setPreviewLoading(false);
                  setLoadingError(true);
                  editPost(name, "");
                  setShowLink(false);
                },
                alt: description
              })
            ]
          }),
          /* @__PURE__ */ (0, import_jsx_runtime.jsx)("div", {
            className: "w-full flex justify-between mt-2",
            children: /* @__PURE__ */ (0, import_jsx_runtime.jsx)("button", {
              onClick: () => {
                editPost(name, "");
                setShowImage(false);
                setShowLink(false);
              },
              className: "rounded-lg border border-red-700 bg-red-700 px-5 py-2.5 text-center text-sm font-medium text-white hover:bg-red-800 focus:outline-none",
              children: "Remove"
            })
          })
        ]
      }),
      showLink && /* @__PURE__ */ (0, import_jsx_runtime.jsxs)(import_jsx_runtime.Fragment, {
        children: [
          /* @__PURE__ */ (0, import_jsx_runtime.jsx)(Input, {
            label: `${description} URL`,
            name,
            id: name,
            defaultValue: resolvedImage,
            inputSize: "small",
            helperText: "Remember to save the post after adding the image URL",
            onBlur: (e) => {
              if (e.target.value) {
                setPreviewLoading(true);
                setShowLink(false);
                editPost(name, e.target.value);
              }
            }
          }),
          /* @__PURE__ */ (0, import_jsx_runtime.jsx)("div", {
            className: "w-full flex justify-between mt-2",
            children: /* @__PURE__ */ (0, import_jsx_runtime.jsx)("button", {
              onClick: () => {
                setShowLink(false);
                setShowImageOptions(true);
              },
              type: "button",
              className: "rounded-lg border border-gray-200 bg-white px-5 py-2.5 text-sm font-medium text-gray-500 hover:bg-gray-100 hover:text-gray-900 focus:z-10 focus:outline-none focus:ring-4 focus:ring-blue-300",
              children: "Cancel"
            })
          })
        ]
      }),
      showImageOptions && /* @__PURE__ */ (0, import_jsx_runtime.jsxs)(import_jsx_runtime.Fragment, {
        children: [
          /* @__PURE__ */ (0, import_jsx_runtime.jsx)("span", {
            className: "mb-1 block text-sm font-medium text-gray-900",
            children: label ?? "Add an image"
          }),
          /* @__PURE__ */ (0, import_jsx_runtime.jsxs)("div", {
            className: "w-full flex justify-between mt-2",
            children: [
              /* @__PURE__ */ (0, import_jsx_runtime.jsx)("button", {
                onClick: () => {
                  setShowLink(true);
                  setShowImageOptions(false);
                  setShowImage(false);
                  setLoadingError(false);
                },
                type: "button",
                className: "flex rounded-lg border border-gray-600 bg-gray-800 px-5 py-2.5 text-sm font-medium text-white hover:border-gray-600 hover:bg-gray-700 focus:outline-none focus:ring-4 focus:ring-gray-700 disabled:cursor-not-allowed disabled:bg-gray-600 md:mb-2",
                children: "From link"
              }),
              /* @__PURE__ */ (0, import_jsx_runtime.jsx)("label", {
                htmlFor: `${name}-upload`,
                className: "flex cursor-pointer rounded-lg border border-gray-600 bg-gray-800 px-5 py-2.5 text-sm font-medium text-white hover:border-gray-600 hover:bg-gray-700 focus:outline-none focus:ring-4 focus:ring-gray-700 disabled:cursor-not-allowed disabled:bg-gray-600 md:mb-2",
                children: "From file"
              }),
              /* @__PURE__ */ (0, import_jsx_runtime.jsx)("input", {
                type: "file",
                accept: "image/*",
                id: `${name}-upload`,
                onChange: addImageFile,
                className: "hidden"
              })
            ]
          })
        ]
      })
    ]
  });
};
var PostSettingsImageSelection_default = PostSettingsImageSelection;

// src/components/PostSettings/index.tsx
var import_jsx_runtime = require("react/jsx-runtime");
var PostSettings = ({
  saveFunc,
  loading,
  validation,
  showDelete
}) => {
  var _a;
  const { register } = (0, import_react_hook_form4.useFormContext)();
  const router3 = (0, import_router3.useRouter)();
  const { post, editPost, hasChanges, collection } = (0, import_react19.useContext)(PostContext);
  return /* @__PURE__ */ (0, import_jsx_runtime.jsxs)("aside", {
    className: "relative w-full border-b border-gray-300 bg-white md:w-64 md:flex-none md:flex-col md:flex-wrap md:items-start md:justify-start md:border-b-0 md:border-l md:py-6 max-h-[calc(100vh-53px)]",
    children: [
      /* @__PURE__ */ (0, import_jsx_runtime.jsx)("div", {
        className: "relative hidden w-full items-center justify-between md:mb-4 md:flex px-4",
        children: /* @__PURE__ */ (0, import_jsx_runtime.jsx)(DateTimePicker_default, {
          id: "publishedAt",
          label: "Date",
          date: post.publishedAt,
          setDate: (publishedAt) => editPost("publishedAt", publishedAt)
        })
      }),
      /* @__PURE__ */ (0, import_jsx_runtime.jsxs)("div", {
        className: "relative hidden w-full items-center justify-between md:mb-4 md:flex px-4",
        children: [
          /* @__PURE__ */ (0, import_jsx_runtime.jsx)("label", {
            htmlFor: "status",
            className: "block text-sm font-medium text-gray-900",
            children: "Status"
          }),
          /* @__PURE__ */ (0, import_jsx_runtime.jsxs)("select", {
            ...register("status", validation),
            name: "status",
            id: "status",
            defaultValue: post.status,
            className: "block cursor-pointer appearance-none rounded-lg border border-gray-300 bg-gray-50 p-2 text-sm text-gray-900 outline-none focus:border-blue-500 focus:ring-blue-500",
            children: [
              /* @__PURE__ */ (0, import_jsx_runtime.jsx)("option", {
                value: "draft",
                children: "Draft"
              }),
              /* @__PURE__ */ (0, import_jsx_runtime.jsx)("option", {
                value: "published",
                children: "Published"
              })
            ]
          })
        ]
      }),
      /* @__PURE__ */ (0, import_jsx_runtime.jsxs)("div", {
        className: `flex w-full pb-4 px-4 ${showDelete ? "justify-between items-center" : "justify-end"}`,
        children: [
          showDelete && /* @__PURE__ */ (0, import_jsx_runtime.jsx)(DeletePostButton_default, {
            disabled: loading,
            slug: post.slug,
            onComplete: () => {
              router3.push(`/outstatic/${collection}`);
            },
            collection,
            className: "hover:bg-slate-200 max-h-[2.25rem]"
          }),
          /* @__PURE__ */ (0, import_jsx_runtime.jsx)("button", {
            onClick: saveFunc,
            type: "button",
            disabled: loading || !hasChanges,
            className: "flex rounded-lg border border-gray-600 bg-gray-800 px-5 py-2.5 text-sm font-medium text-white hover:border-gray-600 hover:bg-gray-700 focus:outline-none focus:ring-4 focus:ring-gray-700 disabled:cursor-not-allowed disabled:bg-gray-600",
            children: loading ? /* @__PURE__ */ (0, import_jsx_runtime.jsxs)(import_jsx_runtime.Fragment, {
              children: [
                /* @__PURE__ */ (0, import_jsx_runtime.jsxs)("svg", {
                  className: "mr-3 -ml-1 h-5 w-5 animate-spin text-white",
                  xmlns: "http://www.w3.org/2000/svg",
                  fill: "none",
                  viewBox: "0 0 24 24",
                  children: [
                    /* @__PURE__ */ (0, import_jsx_runtime.jsx)("circle", {
                      className: "opacity-25",
                      cx: "12",
                      cy: "12",
                      r: "10",
                      stroke: "currentColor",
                      strokeWidth: "4"
                    }),
                    /* @__PURE__ */ (0, import_jsx_runtime.jsx)("path", {
                      className: "opacity-75",
                      fill: "currentColor",
                      d: "M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"
                    })
                  ]
                }),
                "Saving"
              ]
            }) : "Save"
          })
        ]
      }),
      /* @__PURE__ */ (0, import_jsx_runtime.jsxs)("div", {
        className: "w-full",
        children: [
          /* @__PURE__ */ (0, import_jsx_runtime.jsxs)(Accordion_default, {
            title: "Author",
            children: [
              /* @__PURE__ */ (0, import_jsx_runtime.jsx)(Input, {
                label: "Name",
                name: "author.name",
                id: "author.name",
                defaultValue: (_a = post.author) == null ? void 0 : _a.name,
                inputSize: "small",
                wrapperClass: "mb-4"
              }),
              /* @__PURE__ */ (0, import_jsx_runtime.jsx)(PostSettingsImageSelection_default, {
                label: "Add an avatar",
                name: "author.picture",
                description: "Author Avatar"
              })
            ]
          }),
          /* @__PURE__ */ (0, import_jsx_runtime.jsx)(Accordion_default, {
            title: "URL Slug",
            children: /* @__PURE__ */ (0, import_jsx_runtime.jsx)(Input, {
              label: "Write a slug (optional)",
              name: "slug",
              id: "slug",
              defaultValue: post.slug,
              inputSize: "small",
              validation: {
                onChange: (e) => {
                  editPost(
                    "slug",
                    (0, import_url_slug.convert)(e.target.value, { dictionary: { "'": "" } })
                  );
                }
              }
            })
          }),
          /* @__PURE__ */ (0, import_jsx_runtime.jsx)(Accordion_default, {
            title: "Description",
            children: /* @__PURE__ */ (0, import_jsx_runtime.jsx)(TextArea, {
              name: "description",
              type: "textarea",
              label: "Write a description (optional)",
              id: "description",
              rows: 5,
              className: "block w-full rounded-lg border border-gray-300 bg-gray-50 p-2 text-sm text-gray-900 outline-none focus:border-blue-500 focus:ring-blue-500"
            })
          }),
          /* @__PURE__ */ (0, import_jsx_runtime.jsx)(Accordion_default, {
            title: "Cover Image",
            children: /* @__PURE__ */ (0, import_jsx_runtime.jsx)(PostSettingsImageSelection_default, {
              name: "coverImage",
              description: "Cover Image"
            })
          })
        ]
      }),
      /* @__PURE__ */ (0, import_jsx_runtime.jsx)("hr", {
        className: "pb-16"
      })
    ]
  });
};
var PostSettings_default = PostSettings;

// src/components/PostTitleInput/index.tsx
var import_react20 = require("react");
var import_react_hook_form5 = require("react-hook-form");
var import_react_textarea_autosize = __toESM(require("react-textarea-autosize"));
var import_url_slug2 = __toESM(require("url-slug"));
var import_jsx_runtime = require("react/jsx-runtime");
function PostTitle({
  label,
  placeholder = "",
  helperText,
  id,
  readOnly = false,
  wrapperClass,
  ...rest
}) {
  var _a, _b, _c;
  const {
    register,
    formState: { errors },
    setValue
  } = (0, import_react_hook_form5.useFormContext)();
  const { editor } = (0, import_react20.useContext)(PostContext);
  return /* @__PURE__ */ (0, import_jsx_runtime.jsxs)("div", {
    className: wrapperClass,
    children: [
      /* @__PURE__ */ (0, import_jsx_runtime.jsx)("div", {
        className: "relative",
        children: /* @__PURE__ */ (0, import_jsx_runtime.jsx)(import_react_textarea_autosize.default, {
          ...register(id, {
            onChange: (e) => {
              const segments = new URL(document.location.href).pathname.split(
                "/"
              );
              const last = segments.pop() || segments.pop();
              if (last === "new") {
                setValue(
                  "slug",
                  (0, import_url_slug2.default)(e.target.value, { dictionary: { "'": "" } })
                );
              }
            }
          }),
          ...rest,
          name: id,
          id,
          readOnly,
          placeholder,
          "aria-describedby": id,
          autoFocus: true,
          onKeyDown: (e) => {
            if (e.key.toLowerCase() === "enter") {
              e.preventDefault();
              editor.commands.focus("start");
            }
          }
        })
      }),
      /* @__PURE__ */ (0, import_jsx_runtime.jsxs)("div", {
        className: "mt-1",
        children: [
          helperText && /* @__PURE__ */ (0, import_jsx_runtime.jsx)("p", {
            className: "text-xs text-gray-500",
            children: helperText
          }),
          ((_a = errors[id]) == null ? void 0 : _a.message) && /* @__PURE__ */ (0, import_jsx_runtime.jsx)("span", {
            className: "text-sm text-red-500",
            children: (_c = (_b = errors[id]) == null ? void 0 : _b.message) == null ? void 0 : _c.toString()
          })
        ]
      })
    ]
  });
}

// src/components/PostsTable/index.tsx
var import_link3 = __toESM(require("next/link"));
var import_react21 = require("react");
var import_jsx_runtime = require("react/jsx-runtime");
var options2 = {
  year: "numeric",
  month: "long",
  day: "numeric"
};
var PostsTable = (props) => {
  const [posts, setPosts] = (0, import_react21.useState)(props.posts);
  return /* @__PURE__ */ (0, import_jsx_runtime.jsxs)("table", {
    className: "w-full text-left text-sm text-gray-500",
    children: [
      /* @__PURE__ */ (0, import_jsx_runtime.jsx)("thead", {
        className: "bg-gray-50 text-xs uppercase text-gray-700 border-b",
        children: /* @__PURE__ */ (0, import_jsx_runtime.jsxs)("tr", {
          children: [
            /* @__PURE__ */ (0, import_jsx_runtime.jsx)("th", {
              scope: "col",
              className: "px-6 py-3",
              children: "TITLE"
            }),
            /* @__PURE__ */ (0, import_jsx_runtime.jsx)("th", {
              scope: "col",
              className: "px-6 py-3",
              children: "STATUS"
            }),
            /* @__PURE__ */ (0, import_jsx_runtime.jsx)("th", {
              scope: "col",
              className: "px-6 py-3",
              children: "DATE"
            }),
            /* @__PURE__ */ (0, import_jsx_runtime.jsx)("th", {
              scope: "col",
              className: "px-6 py-3"
            })
          ]
        })
      }),
      /* @__PURE__ */ (0, import_jsx_runtime.jsx)("tbody", {
        children: posts && posts.map(({ slug, title, status, publishedAt }) => /* @__PURE__ */ (0, import_jsx_runtime.jsxs)("tr", {
          className: "border-b bg-white hover:bg-gray-50",
          children: [
            /* @__PURE__ */ (0, import_jsx_runtime.jsx)("th", {
              scope: "row",
              className: "relative whitespace-nowrap px-6 py-4 text-base font-semibold text-gray-900 group",
              children: /* @__PURE__ */ (0, import_jsx_runtime.jsx)(import_link3.default, {
                href: `/outstatic/${props.collection}/${slug}`,
                children: /* @__PURE__ */ (0, import_jsx_runtime.jsx)("a", {
                  className: "group-hover:text-blue-500",
                  children: /* @__PURE__ */ (0, import_jsx_runtime.jsxs)("div", {
                    children: [
                      title,
                      /* @__PURE__ */ (0, import_jsx_runtime.jsx)("div", {
                        className: "absolute top-0 bottom-0 left-0 right-40 cursor-pointer"
                      })
                    ]
                  })
                })
              })
            }),
            /* @__PURE__ */ (0, import_jsx_runtime.jsx)("td", {
              className: "px-6 py-4 text-base font-semibold capitalize text-gray-900",
              children: status
            }),
            /* @__PURE__ */ (0, import_jsx_runtime.jsx)("td", {
              className: "px-6 py-4 text-base font-semibold text-gray-900",
              children: publishedAt.toLocaleDateString("en-US", options2)
            }),
            /* @__PURE__ */ (0, import_jsx_runtime.jsx)("td", {
              className: "px-6 py-4 text-right",
              children: /* @__PURE__ */ (0, import_jsx_runtime.jsx)(DeletePostButton_default, {
                slug,
                disabled: false,
                onComplete: () => setPosts(posts.filter((p) => p.slug !== slug)),
                collection: props.collection
              })
            })
          ]
        }, slug))
      })
    ]
  });
};
var PostsTable_default = PostsTable;

// src/utils/collectionCommitInput.ts
var import_js_base642 = require("js-base64");
var collectionCommitInput = ({
  owner,
  oid,
  remove = false,
  repoSlug,
  contentPath,
  monorepoPath,
  collection
}) => {
  let fileChanges = {};
  const additions = [];
  const deletions = [];
  if (remove) {
    deletions.push({
      path: `${monorepoPath ? monorepoPath + "/" : ""}${contentPath}/${collection}`
    });
    fileChanges = { ...fileChanges, deletions };
  } else {
    additions.push({
      path: `${monorepoPath ? monorepoPath + "/" : ""}${contentPath}/${collection}/.gitkeep`,
      contents: (0, import_js_base642.encode)("")
    });
    fileChanges = { additions };
  }
  const headline = !remove ? `feat(content): create ${collection}` : `feat(content): remove ${collection}`;
  return {
    input: {
      branch: {
        repositoryNameWithOwner: `${owner}/${repoSlug}`,
        branchName: "main"
      },
      message: {
        headline
      },
      fileChanges,
      expectedHeadOid: oid
    }
  };
};

// src/utils/useNavigationLock.tsx
var import_router4 = require("next/router");
var import_react22 = require("react");
var useNavigationLock = (isEnabled = true, warningText = "You have unsaved changes \u2013 are you sure you wish to leave this page?") => {
  const router3 = (0, import_router4.useRouter)();
  (0, import_react22.useEffect)(() => {
    const handleWindowClose = (e) => {
      if (!isEnabled)
        return;
      e.preventDefault();
      return e.returnValue = warningText;
    };
    const handleBrowseAway = () => {
      if (!isEnabled)
        return;
      if (window.confirm(warningText))
        return;
      router3.events.emit("routeChangeError");
      if (router3.asPath !== window.location.pathname) {
        window.history.pushState("", "", router3.asPath);
      }
      throw "Navigation cancelled";
    };
    window.addEventListener("beforeunload", handleWindowClose);
    router3.events.on("routeChangeStart", handleBrowseAway);
    return () => {
      window.removeEventListener("beforeunload", handleWindowClose);
      router3.events.off("routeChangeStart", handleBrowseAway);
    };
  }, [isEnabled, router3, warningText]);
};
var useNavigationLock_default = useNavigationLock;

// src/pages/edit-collection/index.tsx
var import_jsx_runtime = require("react/jsx-runtime");
function EditCollection() {
  const {
    pages: pages2,
    contentPath,
    monorepoPath,
    session,
    repoSlug,
    repoOwner,
    addPage
  } = (0, import_react23.useContext)(OutstaticContext);
  const router3 = (0, import_router5.useRouter)();
  const [createCommit] = useCreateCommitMutation();
  const fetchOid = useOid_default();
  const [hasChanges, setHasChanges] = (0, import_react23.useState)(false);
  const [pluralized, setPlural] = (0, import_react23.useState)("");
  const pagesRegex = new RegExp(`^(?!${pages2.join("$|")}$)`, "i");
  const createCollection = yup.object().shape({
    name: yup.string().matches(pagesRegex, `${pluralized} is already taken.`).matches(/^[aA-zZ\s]+$/, "Only alphabets are allowed for this field.").required("Collection name is required.")
  });
  const [loading, setLoading] = (0, import_react23.useState)(false);
  const methods = (0, import_react_hook_form6.useForm)({
    resolver: (0, import_yup.yupResolver)(createCollection)
  });
  const onSubmit = async ({ name }) => {
    var _a;
    setLoading(true);
    setHasChanges(false);
    try {
      const oid = await fetchOid();
      const owner = repoOwner || ((_a = session == null ? void 0 : session.user) == null ? void 0 : _a.login) || "";
      const collection = (0, import_url_slug3.convert)(name, { dictionary: { "'": "" } });
      const commitInput = collectionCommitInput({
        owner,
        oid,
        repoSlug,
        contentPath,
        monorepoPath,
        collection
      });
      const created = await createCommit({ variables: commitInput });
      if (created) {
        addPage(collection);
        setLoading(false);
        router3.push(`/outstatic/${collection}`);
      }
    } catch (error) {
      setLoading(false);
      setHasChanges(false);
      console.log({ error });
    }
  };
  (0, import_react23.useEffect)(() => {
    const subscription = methods.watch(() => setHasChanges(true));
    return () => subscription.unsubscribe();
  }, [methods]);
  useNavigationLock_default(hasChanges);
  return /* @__PURE__ */ (0, import_jsx_runtime.jsx)(import_react_hook_form6.FormProvider, {
    ...methods,
    children: /* @__PURE__ */ (0, import_jsx_runtime.jsxs)(AdminLayout, {
      title: "New Collection",
      children: [
        /* @__PURE__ */ (0, import_jsx_runtime.jsx)("div", {
          className: "mb-8 flex h-12 items-center",
          children: /* @__PURE__ */ (0, import_jsx_runtime.jsx)("h1", {
            className: "mr-12 text-2xl",
            children: "Create a Collection"
          })
        }),
        /* @__PURE__ */ (0, import_jsx_runtime.jsxs)("form", {
          className: "max-w-5xl w-full flex mb-4 items-start",
          onSubmit: methods.handleSubmit(onSubmit),
          children: [
            /* @__PURE__ */ (0, import_jsx_runtime.jsx)(Input, {
              label: "Collection Name",
              id: "name",
              inputSize: "medium",
              className: "w-full max-w-sm md:w-80",
              placeholder: "Ex: Posts",
              type: "text",
              helperText: "Use the plural form of the collection name, ex: Docs",
              validation: {
                onChange: (e) => {
                  setPlural((0, import_pluralize.plural)(e.target.value));
                },
                onBlur: (e) => {
                  methods.setValue("name", (0, import_pluralize.plural)(e.target.value));
                }
              }
            }),
            /* @__PURE__ */ (0, import_jsx_runtime.jsx)("button", {
              type: "submit",
              disabled: loading || !hasChanges,
              className: "flex rounded-lg border border-gray-600 bg-gray-800 px-5 py-2 text-sm font-medium text-white hover:border-gray-600 hover:bg-gray-700 focus:outline-none focus:ring-4 focus:ring-gray-700 disabled:cursor-not-allowed disabled:bg-gray-600 ml-2 mt-7 mb-5",
              children: loading ? /* @__PURE__ */ (0, import_jsx_runtime.jsxs)(import_jsx_runtime.Fragment, {
                children: [
                  /* @__PURE__ */ (0, import_jsx_runtime.jsxs)("svg", {
                    className: "mr-3 -ml-1 h-5 w-5 animate-spin text-white",
                    xmlns: "http://www.w3.org/2000/svg",
                    fill: "none",
                    viewBox: "0 0 24 24",
                    children: [
                      /* @__PURE__ */ (0, import_jsx_runtime.jsx)("circle", {
                        className: "opacity-25",
                        cx: "12",
                        cy: "12",
                        r: "10",
                        stroke: "currentColor",
                        strokeWidth: "4"
                      }),
                      /* @__PURE__ */ (0, import_jsx_runtime.jsx)("path", {
                        className: "opacity-75",
                        fill: "currentColor",
                        d: "M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"
                      })
                    ]
                  }),
                  "Saving"
                ]
              }) : "Save"
            })
          ]
        }),
        pluralized && /* @__PURE__ */ (0, import_jsx_runtime.jsxs)("div", {
          className: "p-4 mb-4 text-sm max-w-xl text-blue-700 bg-blue-100 rounded-lg",
          role: "alert",
          children: [
            "The collection will appear as",
            " ",
            /* @__PURE__ */ (0, import_jsx_runtime.jsx)("span", {
              className: "font-semibold capitalize",
              children: pluralized
            }),
            " on the sidebar."
          ]
        })
      ]
    })
  });
}

// src/pages/collections.tsx
var import_link4 = __toESM(require("next/link"));
var import_react24 = require("react");
var import_jsx_runtime = require("react/jsx-runtime");
function Collections() {
  const {
    collections,
    session,
    repoSlug,
    contentPath,
    monorepoPath,
    removePage
  } = (0, import_react24.useContext)(OutstaticContext);
  const [showDeleteModal, setShowDeleteModal] = (0, import_react24.useState)(false);
  const [selectedCollection, setSelectedCollection] = (0, import_react24.useState)("");
  const [deleting, setDeleting] = (0, import_react24.useState)(false);
  const [createCommit] = useCreateCommitMutation();
  const fetchOid = useOid_default();
  const deletePost = async (collection) => {
    var _a;
    try {
      const oid = await fetchOid();
      const owner = ((_a = session == null ? void 0 : session.user) == null ? void 0 : _a.login) || "";
      const commitInput = collectionCommitInput({
        owner,
        oid,
        repoSlug,
        remove: true,
        contentPath,
        monorepoPath,
        collection
      });
      await createCommit({ variables: commitInput });
      setShowDeleteModal(false);
      removePage(collection);
    } catch (error) {
    }
  };
  return /* @__PURE__ */ (0, import_jsx_runtime.jsxs)(AdminLayout, {
    title: "Collections",
    children: [
      collections.length === 0 ? /* @__PURE__ */ (0, import_jsx_runtime.jsxs)("div", {
        className: "max-w-2xl",
        children: [
          /* @__PURE__ */ (0, import_jsx_runtime.jsx)("div", {
            className: "absolute bottom-0 left-0 md:left-64 right-0 md:top-36",
            children: /* @__PURE__ */ (0, import_jsx_runtime.jsx)("svg", {
              fill: "none",
              className: "h-full w-full",
              xmlns: "http://www.w3.org/2000/svg",
              children: /* @__PURE__ */ (0, import_jsx_runtime.jsx)("path", {
                d: "m1555.43 194.147c-100.14 46.518-204.72 78.763-313.64 96.841-78.16 12.972-282.29 0-291.79-143.988-1.58-23.948 1-89.4705 67-127 58-32.9805 115.15-13.36095 142.5 5.5 27.35 18.861 45.02 44.5 54 73 16.37 51.951-9.22 115.124-30.65 161.874-57.09 124.562-177.31 219.357-311.976 246.789-142.617 29.052-292.036-9.369-430.683-41.444-100.166-23.173-196.003-36.724-298.229-15.203-48.046 10.115-94.9295 24.91-139.962 44.112",
                className: "stroke-slate-900",
                strokeWidth: "2"
              })
            })
          }),
          /* @__PURE__ */ (0, import_jsx_runtime.jsxs)("div", {
            className: "relative",
            children: [
              /* @__PURE__ */ (0, import_jsx_runtime.jsx)("div", {
                className: "mb-8 flex h-12 items-center",
                children: /* @__PURE__ */ (0, import_jsx_runtime.jsx)("h1", {
                  className: "mr-12 text-2xl",
                  children: "Welcome to Outstatic!"
                })
              }),
              /* @__PURE__ */ (0, import_jsx_runtime.jsxs)("div", {
                className: "mb-20 max-w-2xl p-8 px-4 md:p-8 text-black bg-white rounded-lg border border-gray-200 shadow-md prose prose-base",
                children: [
                  /* @__PURE__ */ (0, import_jsx_runtime.jsx)("p", {
                    children: "To get started you will need to create a new Collection. Collections are the main building block of your Outstatic website."
                  }),
                  /* @__PURE__ */ (0, import_jsx_runtime.jsx)("p", {
                    children: "Create your first Collection by clicking the button below."
                  }),
                  /* @__PURE__ */ (0, import_jsx_runtime.jsx)(import_link4.default, {
                    href: "/outstatic/collections/new",
                    children: /* @__PURE__ */ (0, import_jsx_runtime.jsx)("a", {
                      className: "rounded-lg border px-5 py-2.5 text-sm font-medium focus:outline-none focus:ring-4 border-gray-600 bg-gray-800 text-white hover:border-gray-600 hover:bg-gray-700 focus:ring-gray-700 no-underline",
                      children: "New Collection"
                    })
                  }),
                  /* @__PURE__ */ (0, import_jsx_runtime.jsxs)("p", {
                    children: [
                      "To learn more about how Collections work",
                      " ",
                      /* @__PURE__ */ (0, import_jsx_runtime.jsx)("a", {
                        href: "https://outstatic.com/docs/collections",
                        target: "_blank",
                        rel: "noreferrer",
                        children: "click here"
                      }),
                      "."
                    ]
                  })
                ]
              })
            ]
          })
        ]
      }) : /* @__PURE__ */ (0, import_jsx_runtime.jsxs)(import_jsx_runtime.Fragment, {
        children: [
          /* @__PURE__ */ (0, import_jsx_runtime.jsxs)("div", {
            className: "mb-8 flex h-12 items-center",
            children: [
              /* @__PURE__ */ (0, import_jsx_runtime.jsx)("h1", {
                className: "mr-12 text-2xl",
                children: "Collections"
              }),
              /* @__PURE__ */ (0, import_jsx_runtime.jsx)(import_link4.default, {
                href: "/outstatic/collections/new",
                children: /* @__PURE__ */ (0, import_jsx_runtime.jsx)("a", {
                  className: "rounded-lg border px-5 py-2.5 text-sm font-medium focus:outline-none focus:ring-4 border-gray-600 bg-gray-800 text-white hover:border-gray-600 hover:bg-gray-700 focus:ring-gray-700",
                  children: "New Collection"
                })
              })
            ]
          }),
          /* @__PURE__ */ (0, import_jsx_runtime.jsx)("div", {
            className: "max-w-5xl w-full grid grid-cols-3 gap-6",
            children: collections.map((collection) => /* @__PURE__ */ (0, import_jsx_runtime.jsxs)("div", {
              className: "relative flex p-6 justify-between items-center max-w-sm bg-white rounded-lg border border-gray-200 shadow-md hover:bg-slate-100",
              children: [
                /* @__PURE__ */ (0, import_jsx_runtime.jsx)(import_link4.default, {
                  href: `/outstatic/${collection}`,
                  children: /* @__PURE__ */ (0, import_jsx_runtime.jsxs)("h5", {
                    className: "text-2xl cursor-pointer font-bold tracking-tight text-gray-900 capitalize hover:text-blue-500",
                    children: [
                      collection,
                      /* @__PURE__ */ (0, import_jsx_runtime.jsx)("span", {
                        className: "absolute top-0 bottom-0 left-0 right-16"
                      })
                    ]
                  })
                }),
                /* @__PURE__ */ (0, import_jsx_runtime.jsxs)("button", {
                  className: "z-10 inline-block text-gray-500 hover:bg-white focus:ring-4 focus:outline-none focus:ring-gray-200 rounded-lg text-sm p-1.5",
                  type: "button",
                  onClick: () => {
                    setShowDeleteModal(true);
                    setSelectedCollection(collection);
                  },
                  children: [
                    /* @__PURE__ */ (0, import_jsx_runtime.jsx)("span", {
                      className: "sr-only",
                      children: "Delete content"
                    }),
                    /* @__PURE__ */ (0, import_jsx_runtime.jsxs)("svg", {
                      xmlns: "http://www.w3.org/2000/svg",
                      viewBox: "0 0 24 24",
                      width: "24",
                      height: "24",
                      children: [
                        /* @__PURE__ */ (0, import_jsx_runtime.jsx)("path", {
                          fill: "none",
                          d: "M0 0h24v24H0z"
                        }),
                        /* @__PURE__ */ (0, import_jsx_runtime.jsx)("path", {
                          d: "M17 6h5v2h-2v13a1 1 0 0 1-1 1H5a1 1 0 0 1-1-1V8H2V6h5V3a1 1 0 0 1 1-1h8a1 1 0 0 1 1 1v3zm1 2H6v12h12V8zm-9 3h2v6H9v-6zm4 0h2v6h-2v-6zM9 4v2h6V4H9z"
                        })
                      ]
                    })
                  ]
                })
              ]
            }, collection))
          })
        ]
      }),
      showDeleteModal && /* @__PURE__ */ (0, import_jsx_runtime.jsxs)(Modal_default, {
        title: "Delete Collection",
        close: () => {
          setShowDeleteModal(false);
          setSelectedCollection("");
        },
        children: [
          /* @__PURE__ */ (0, import_jsx_runtime.jsxs)("div", {
            className: "space-y-6 p-6 text-left",
            children: [
              /* @__PURE__ */ (0, import_jsx_runtime.jsx)("p", {
                className: "text-base leading-relaxed text-gray-500",
                children: "Are you sure you want to delete this collection?"
              }),
              /* @__PURE__ */ (0, import_jsx_runtime.jsx)("p", {
                className: "text-base leading-relaxed text-gray-500",
                children: "This action cannot be undone."
              })
            ]
          }),
          /* @__PURE__ */ (0, import_jsx_runtime.jsxs)("div", {
            className: "flex items-center space-x-2 rounded-b border-t p-6",
            children: [
              /* @__PURE__ */ (0, import_jsx_runtime.jsx)("button", {
                type: "button",
                className: "flex rounded-lg bg-red-700 px-5 py-2.5 text-center text-sm font-medium text-white hover:bg-red-800 focus:outline-none",
                onClick: () => {
                  setDeleting(true);
                  deletePost(selectedCollection);
                },
                children: deleting ? /* @__PURE__ */ (0, import_jsx_runtime.jsxs)(import_jsx_runtime.Fragment, {
                  children: [
                    /* @__PURE__ */ (0, import_jsx_runtime.jsxs)("svg", {
                      className: "mr-3 -ml-1 h-5 w-5 animate-spin text-white",
                      xmlns: "http://www.w3.org/2000/svg",
                      fill: "none",
                      viewBox: "0 0 24 24",
                      children: [
                        /* @__PURE__ */ (0, import_jsx_runtime.jsx)("circle", {
                          className: "opacity-25",
                          cx: "12",
                          cy: "12",
                          r: "10",
                          stroke: "currentColor",
                          strokeWidth: "4"
                        }),
                        /* @__PURE__ */ (0, import_jsx_runtime.jsx)("path", {
                          className: "opacity-75",
                          fill: "currentColor",
                          d: "M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"
                        })
                      ]
                    }),
                    "Deleting"
                  ]
                }) : "Delete"
              }),
              /* @__PURE__ */ (0, import_jsx_runtime.jsx)("button", {
                type: "button",
                className: "rounded-lg border border-gray-200 px-5 py-2.5 text-sm font-medium focus:z-10 focus:outline-none focus:ring-4 order-gray-600 bg-gray-800 text-white hover:border-gray-600 hover:bg-gray-700 focus:ring-gray-700",
                onClick: () => {
                  setShowDeleteModal(false);
                  setSelectedCollection("");
                },
                children: "Cancel"
              })
            ]
          })
        ]
      })
    ]
  });
}

// src/pages/edit-document/index.tsx
var import_yup2 = require("@hookform/resolvers/yup");
var import_gray_matter = __toESM(require("gray-matter"));
var import_head3 = __toESM(require("next/head"));
var import_router6 = require("next/router");
var import_pluralize2 = require("pluralize");
var import_react27 = require("react");
var import_react_hook_form7 = require("react-hook-form");
var import_showdown2 = __toESM(require("showdown"));

// src/utils/deepReplace.ts
var deepReplace = (obj, key, value) => {
  const dates = {};
  Object.entries(obj).forEach(([k, v]) => {
    if (!isNaN(new Date(v).getMonth())) {
      dates[k] = k === key ? value : v;
    }
  });
  const clone = JSON.parse(JSON.stringify(obj));
  const keys = key.split(".");
  const lastKey = keys.pop();
  const lastObj = keys.reduce((clone2, key2) => clone2[key2], clone);
  try {
    if (lastObj[lastKey] !== void 0) {
      lastObj[lastKey] = value;
    }
  } catch {
    console.log(`Key ${key} not found`);
  }
  return { ...clone, ...dates };
};

// src/utils/getLocalDate.ts
var getLocalDate = () => {
  const offDate = new Date().valueOf() - new Date().getTimezoneOffset() * 6e3;
  return new Date(offDate);
};

// src/utils/mergeMdMeta.ts
var import_showdown = __toESM(require("showdown"));
var import_dompurify = __toESM(require("dompurify"));

// src/utils/replaceImageSrc.ts
var replaceImageSrcRoot = (html, from2, to) => {
  const doc = new DOMParser().parseFromString(html, "text/html");
  doc.querySelectorAll("img").forEach((img) => {
    const src = img.getAttribute("src") || "";
    img.setAttribute("src", src.replace(from2, to));
  });
  return doc.getElementsByTagName("body")[0].innerHTML;
};

// src/utils/mergeMdMeta.ts
var mergeMdMeta = (data) => {
  const meta = Object.entries(
    (({ content, publishedAt, ...meta2 }) => meta2)(data)
  );
  if (data.publishedAt) {
    meta.push(["publishedAt", data.publishedAt.toISOString()]);
  }
  let merged = "---\n";
  Object.entries(meta).forEach(([_, value]) => {
    if (value[1] instanceof Object) {
      merged += `${value[0]}:
`;
      Object.entries(value[1]).forEach(([key, value2]) => {
        merged += `  ${key}: '${import_dompurify.default.sanitize(value2).replaceAll(
          "'",
          "''"
        )}'
`;
      });
    } else {
      merged += `${value[0]}: '${import_dompurify.default.sanitize(value[1]).replaceAll(
        "'",
        "''"
      )}'
`;
    }
  });
  merged += "---\n\n";
  const converter = new import_showdown.default.Converter();
  let newContent = replaceImageSrcRoot(
    data.content,
    "/api/outstatic/images/",
    "/images/"
  );
  const imgFolderRegex = new RegExp(/(^\/api\/outstatic\/images\/)/gi);
  newContent = replaceImageSrcRoot(newContent, imgFolderRegex, `/images/`);
  newContent.replaceAll("<p><br></p>", "").replaceAll("<br></p>", "</p>");
  const markdown = converter.makeMarkdown(newContent);
  const cleanMarkdown = markdown.replaceAll("\n\n\n<!-- -->\n\n", "\n\n").replaceAll("](<", "](").replaceAll(">)", ")");
  merged += cleanMarkdown;
  return merged;
};

// src/utils/useTipTap.tsx
var import_extension_code_block_lowlight = __toESM(require("@tiptap/extension-code-block-lowlight"));
var import_extension_image = __toESM(require("@tiptap/extension-image"));
var import_extension_link = __toESM(require("@tiptap/extension-link"));
var import_extension_placeholder = __toESM(require("@tiptap/extension-placeholder"));
var import_react26 = require("@tiptap/react");
var import_starter_kit = __toESM(require("@tiptap/starter-kit"));
var import_lowlight = __toESM(require("lowlight"));

// src/components/CodeBlock/index.tsx
var import_react25 = require("@tiptap/react");
var import_jsx_runtime = require("react/jsx-runtime");
var CodeBlock = ({
  node: {
    attrs: { language: defaultLanguage }
  },
  updateAttributes,
  extension
}) => {
  return /* @__PURE__ */ (0, import_jsx_runtime.jsxs)(import_react25.NodeViewWrapper, {
    className: "relative",
    children: [
      /* @__PURE__ */ (0, import_jsx_runtime.jsx)("div", {
        className: "absolute top-0 right-6 rounded-b-md border border-t-0 border-gray-600 px-3 py-1",
        children: /* @__PURE__ */ (0, import_jsx_runtime.jsxs)("select", {
          contentEditable: false,
          defaultValue: defaultLanguage,
          className: "select-none bg-gradient-to-tr from-primary-300 to-primary-400 bg-clip-text font-medium text-white outline-none text-sm",
          onChange: (event) => updateAttributes({ language: event.target.value }),
          children: [
            /* @__PURE__ */ (0, import_jsx_runtime.jsx)("option", {
              value: "null",
              children: "auto"
            }),
            /* @__PURE__ */ (0, import_jsx_runtime.jsx)("option", {
              disabled: true,
              children: "\u2014"
            }),
            extension.options.lowlight.listLanguages().map((lang, index) => /* @__PURE__ */ (0, import_jsx_runtime.jsx)("option", {
              value: lang,
              children: lang
            }, index))
          ]
        })
      }),
      /* @__PURE__ */ (0, import_jsx_runtime.jsx)("pre", {
        className: "text-white bg-slate-900 rounded-md p-4 pt-12",
        children: /* @__PURE__ */ (0, import_jsx_runtime.jsx)(import_react25.NodeViewContent, {
          as: "code"
        })
      })
    ]
  });
};
var CodeBlock_default = CodeBlock;

// src/utils/useTipTap.tsx
var useTipTap = ({ ...rhfMethods }) => {
  const { setValue, trigger } = rhfMethods;
  const editor = (0, import_react26.useEditor)({
    extensions: [
      import_starter_kit.default.configure({
        codeBlock: false
      }),
      import_extension_image.default.extend({
        renderHTML({ HTMLAttributes }) {
          return [
            "img",
            {
              ...HTMLAttributes,
              onError: `this.classList.add("image-error");this.alt="Couldn't load image.";`
            }
          ];
        }
      }).configure({ inline: true }),
      import_extension_placeholder.default.configure({
        placeholder: "What's your story?",
        showOnlyWhenEditable: false
      }),
      import_extension_link.default.configure({ openOnClick: false }),
      import_extension_code_block_lowlight.default.extend({
        addNodeView() {
          return (0, import_react26.ReactNodeViewRenderer)(CodeBlock_default);
        }
      }).configure({
        lowlight: import_lowlight.default
      })
    ],
    onUpdate({ editor: editor2 }) {
      const val = editor2.getHTML();
      setValue("content", val && !editor2.isEmpty ? val : "");
      (async () => await trigger("content"))();
    }
  });
  return { editor };
};
var useTipTap_default = useTipTap;

// src/utils/yup.ts
var yup2 = __toESM(require("yup"));
var editPostSchema = yup2.object().shape({
  title: yup2.string().required("Title is required"),
  publishedAt: yup2.date().required("Date is required"),
  content: yup2.string().required("Content is required"),
  status: yup2.string().equals(["published", "draft"]).required("Status is missing"),
  author: yup2.object().shape({
    name: yup2.string(),
    picture: yup2.string()
  }),
  slug: yup2.string().matches(/^(?!new$)/, 'The word "new" is not a valid slug').required(),
  description: yup2.string(),
  coverImage: yup2.string()
});

// src/pages/edit-document/index.tsx
var import_jsx_runtime = require("react/jsx-runtime");
function EditDocument({ collection }) {
  var _a, _b, _c;
  const router3 = (0, import_router6.useRouter)();
  const slug = (_b = (_a = router3.query) == null ? void 0 : _a.ost) == null ? void 0 : _b[1];
  const { repoOwner, repoSlug, contentPath, monorepoPath } = (0, import_react27.useContext)(OutstaticContext);
  const { session } = useOstSession();
  const [loading, setLoading] = (0, import_react27.useState)(false);
  const [hasChanges, setHasChanges] = (0, import_react27.useState)(false);
  const [files, setFiles] = (0, import_react27.useState)([]);
  const [createCommit] = useCreateCommitMutation();
  const fetchOid = useOid_default();
  const [showDelete, setShowDelete] = (0, import_react27.useState)(false);
  const methods = (0, import_react_hook_form7.useForm)({ resolver: (0, import_yup2.yupResolver)(editPostSchema) });
  const { editor } = useTipTap_default({ ...methods });
  const editPost = (property, value) => {
    const formValues = methods.getValues();
    const newValue = deepReplace(formValues, property, value);
    methods.reset(newValue);
  };
  const { data: postQueryData } = usePostQuery({
    variables: {
      owner: repoOwner || ((_c = session == null ? void 0 : session.user) == null ? void 0 : _c.login) || "",
      name: repoSlug,
      filePath: `HEAD:${monorepoPath ? monorepoPath + "/" : ""}${contentPath}/${collection}/${slug}.md`
    },
    fetchPolicy: "network-only",
    skip: slug === "new" || !slug
  });
  const onSubmit = async (data) => {
    var _a2;
    setLoading(true);
    try {
      const post = methods.getValues();
      const content = mergeMdMeta({ ...data });
      const oid = await fetchOid();
      const owner = repoOwner || ((_a2 = session == null ? void 0 : session.user) == null ? void 0 : _a2.login) || "";
      const newSlug = post.slug;
      const oldSlug = slug !== newSlug && slug !== "new" ? slug : void 0;
      const commitInput = createCommitInput({
        owner,
        slug: newSlug,
        oldSlug,
        content,
        oid,
        files,
        repoSlug,
        contentPath,
        monorepoPath,
        collection
      });
      await createCommit({ variables: commitInput });
      setLoading(false);
      setHasChanges(false);
      window.history.replaceState("", "", `/outstatic/${collection}/${newSlug}`);
      setShowDelete(true);
    } catch (error) {
      setLoading(false);
      console.log({ error });
    }
  };
  (0, import_react27.useEffect)(() => {
    var _a2;
    const postQueryObject = (_a2 = postQueryData == null ? void 0 : postQueryData.repository) == null ? void 0 : _a2.object;
    if ((postQueryObject == null ? void 0 : postQueryObject.__typename) === "Blob") {
      let mdContent = postQueryObject.text;
      const {
        data: { title, publishedAt, status, description, coverImage, author },
        content
      } = (0, import_gray_matter.default)(mdContent);
      const parseContent = () => {
        const converter = new import_showdown2.default.Converter({ noHeaderId: true });
        let newContent = converter.makeHtml(content);
        const regex = new RegExp(/(^\/images\/)/gi);
        newContent = replaceImageSrcRoot(
          newContent,
          regex,
          "/api/outstatic/images/"
        );
        return newContent;
      };
      const parsedContent = parseContent();
      const newDate = publishedAt ? new Date(publishedAt) : getLocalDate();
      const post = {
        title,
        publishedAt: newDate,
        content: parsedContent,
        status,
        author: {
          name: author == null ? void 0 : author.name,
          picture: (author == null ? void 0 : author.picture) || ""
        },
        slug,
        description,
        coverImage
      };
      methods.reset(post);
      editor.commands.setContent(parsedContent);
      editor.commands.focus("start");
      setShowDelete(slug !== "new");
    } else {
      if (slug) {
        const formData = methods.getValues();
        methods.reset({
          ...formData,
          author: {
            name: session == null ? void 0 : session.user.name,
            picture: (session == null ? void 0 : session.user.image) ?? ""
          },
          coverImage: "",
          publishedAt: slug === "new" ? getLocalDate() : formData.publishedAt
        });
      }
    }
    const subscription = methods.watch(() => setHasChanges(true));
    return () => subscription.unsubscribe();
  }, [postQueryData, methods, slug, editor, session]);
  useNavigationLock_default(hasChanges);
  return /* @__PURE__ */ (0, import_jsx_runtime.jsxs)(import_jsx_runtime.Fragment, {
    children: [
      /* @__PURE__ */ (0, import_jsx_runtime.jsxs)(import_head3.default, {
        children: [
          /* @__PURE__ */ (0, import_jsx_runtime.jsx)("link", {
            rel: "preconnect",
            href: "https://fonts.googleapis.com"
          }),
          /* @__PURE__ */ (0, import_jsx_runtime.jsx)("link", {
            rel: "preconnect",
            href: "https://fonts.gstatic.com",
            crossOrigin: "true"
          }),
          /* @__PURE__ */ (0, import_jsx_runtime.jsx)("link", {
            href: "https://fonts.googleapis.com/css2?family=Lora:ital,wght@0,500;0,600;0,700;1,400;1,500;1,600;1,700&family=PT+Serif:ital,wght@0,400;0,700;1,400;1,700&display=swap",
            rel: "stylesheet"
          })
        ]
      }),
      /* @__PURE__ */ (0, import_jsx_runtime.jsx)(PostContext.Provider, {
        value: {
          editor,
          post: methods.getValues(),
          editPost,
          files,
          setFiles,
          hasChanges,
          collection
        },
        children: /* @__PURE__ */ (0, import_jsx_runtime.jsx)(import_react_hook_form7.FormProvider, {
          ...methods,
          children: /* @__PURE__ */ (0, import_jsx_runtime.jsx)(AdminLayout, {
            title: methods.getValues("title"),
            settings: /* @__PURE__ */ (0, import_jsx_runtime.jsx)(PostSettings_default, {
              loading,
              saveFunc: methods.handleSubmit(onSubmit),
              showDelete
            }),
            children: /* @__PURE__ */ (0, import_jsx_runtime.jsxs)("form", {
              className: "m-auto max-w-[700px] space-y-4",
              children: [
                /* @__PURE__ */ (0, import_jsx_runtime.jsx)(PostTitle, {
                  id: "title",
                  className: "w-full resize-none outline-none bg-white text-5xl scrollbar-hide min-h-[55px] overflow-hidden",
                  placeholder: `Your ${(0, import_pluralize2.singular)(collection)} title`
                }),
                /* @__PURE__ */ (0, import_jsx_runtime.jsx)("div", {
                  className: "min-h-full prose prose-xl",
                  children: /* @__PURE__ */ (0, import_jsx_runtime.jsx)(MDEditor_default, {
                    editor,
                    id: "content"
                  })
                })
              ]
            })
          })
        })
      })
    ]
  });
}

// src/pages/list.tsx
var import_gray_matter2 = __toESM(require("gray-matter"));
var import_link5 = __toESM(require("next/link"));
var import_pluralize3 = require("pluralize");
var import_react28 = require("react");
var import_jsx_runtime = require("react/jsx-runtime");
function List({ collection }) {
  var _a, _b, _c, _d, _e;
  const { repoOwner, repoSlug, contentPath, monorepoPath, session } = (0, import_react28.useContext)(OutstaticContext);
  const { data, error, loading } = usePostsQuery({
    variables: {
      owner: repoOwner || ((_a = session == null ? void 0 : session.user) == null ? void 0 : _a.login) || "",
      name: repoSlug || "",
      contentPath: `HEAD:${monorepoPath ? monorepoPath + "/" : ""}${contentPath}/${collection}` || ""
    },
    fetchPolicy: "network-only",
    onError: ({ graphQLErrors }) => {
      var _a2;
      if (graphQLErrors && ((_a2 = graphQLErrors == null ? void 0 : graphQLErrors[0]) == null ? void 0 : _a2.type) === "NOT_FOUND") {
        ostSignOut();
        return null;
      }
      return null;
    }
  });
  let posts = [];
  const entries = ((_c = (_b = data == null ? void 0 : data.repository) == null ? void 0 : _b.object) == null ? void 0 : _c.__typename) === "Tree" && ((_e = (_d = data == null ? void 0 : data.repository) == null ? void 0 : _d.object) == null ? void 0 : _e.entries);
  if (entries) {
    entries.forEach((post) => {
      var _a2, _b2, _c2;
      if (post.name.slice(-3) === ".md") {
        const {
          data: { title, publishedAt, status, author }
        } = (0, import_gray_matter2.default)(
          ((_a2 = post == null ? void 0 : post.object) == null ? void 0 : _a2.__typename) === "Blob" && ((_b2 = post == null ? void 0 : post.object) == null ? void 0 : _b2.text) ? (_c2 = post == null ? void 0 : post.object) == null ? void 0 : _c2.text : ""
        );
        posts.push({
          title,
          status,
          publishedAt: publishedAt ? new Date(publishedAt) : new Date(),
          slug: post.name.replace(".md", ""),
          author
        });
      }
    });
    posts.sort((a, b) => Number(b.publishedAt) - Number(a.publishedAt));
  }
  return /* @__PURE__ */ (0, import_jsx_runtime.jsxs)(AdminLayout, {
    error,
    title: collection[0].toUpperCase() + collection.slice(1),
    children: [
      /* @__PURE__ */ (0, import_jsx_runtime.jsxs)("div", {
        className: "mb-8 flex h-12 items-center",
        children: [
          /* @__PURE__ */ (0, import_jsx_runtime.jsx)("h1", {
            className: "mr-12 text-2xl capitalize",
            children: collection
          }),
          /* @__PURE__ */ (0, import_jsx_runtime.jsx)(import_link5.default, {
            href: `/outstatic/${collection}/new`,
            children: /* @__PURE__ */ (0, import_jsx_runtime.jsxs)("a", {
              className: "rounded-lg border px-5 py-2.5 text-sm font-medium focus:outline-none focus:ring-4 border-gray-600 bg-gray-800 text-white hover:border-gray-600 hover:bg-gray-700 focus:ring-gray-700 capitalize",
              children: [
                "New ",
                (0, import_pluralize3.singular)(collection)
              ]
            })
          })
        ]
      }),
      posts.length > 0 && /* @__PURE__ */ (0, import_jsx_runtime.jsx)("div", {
        className: "relative overflow-x-auto shadow-md sm:rounded-lg",
        children: /* @__PURE__ */ (0, import_jsx_runtime.jsx)(PostsTable_default, {
          posts,
          collection
        })
      }),
      posts.length === 0 && !loading && /* @__PURE__ */ (0, import_jsx_runtime.jsxs)("div", {
        className: "max-w-2xl",
        children: [
          /* @__PURE__ */ (0, import_jsx_runtime.jsx)("div", {
            className: "absolute bottom-0 left-0 md:left-64 right-0 md:top-36",
            children: /* @__PURE__ */ (0, import_jsx_runtime.jsx)("svg", {
              fill: "none",
              className: "h-full w-full",
              xmlns: "http://www.w3.org/2000/svg",
              children: /* @__PURE__ */ (0, import_jsx_runtime.jsx)("path", {
                d: "m1555.43 194.147c-100.14 46.518-204.72 78.763-313.64 96.841-78.16 12.972-282.29 0-291.79-143.988-1.58-23.948 1-89.4705 67-127 58-32.9805 115.15-13.36095 142.5 5.5 27.35 18.861 45.02 44.5 54 73 16.37 51.951-9.22 115.124-30.65 161.874-57.09 124.562-177.31 219.357-311.976 246.789-142.617 29.052-292.036-9.369-430.683-41.444-100.166-23.173-196.003-36.724-298.229-15.203-48.046 10.115-94.9295 24.91-139.962 44.112",
                className: "stroke-slate-900",
                strokeWidth: "2"
              })
            })
          }),
          /* @__PURE__ */ (0, import_jsx_runtime.jsx)("div", {
            className: "relative",
            children: /* @__PURE__ */ (0, import_jsx_runtime.jsxs)("div", {
              className: "mb-20 max-w-2xl p-8 px-4 md:p-8 text-black bg-white rounded-lg border border-gray-200 shadow-md prose prose-base",
              children: [
                /* @__PURE__ */ (0, import_jsx_runtime.jsx)("p", {
                  children: "This collection has no documents yet."
                }),
                /* @__PURE__ */ (0, import_jsx_runtime.jsxs)("p", {
                  children: [
                    "Create your first",
                    " ",
                    /* @__PURE__ */ (0, import_jsx_runtime.jsx)("span", {
                      className: "capitalize",
                      children: (0, import_pluralize3.singular)(collection)
                    }),
                    " by clicking the button below."
                  ]
                }),
                /* @__PURE__ */ (0, import_jsx_runtime.jsx)(import_link5.default, {
                  href: `/outstatic/${collection}/new`,
                  children: /* @__PURE__ */ (0, import_jsx_runtime.jsxs)("a", {
                    className: "rounded-lg border px-5 py-2.5 text-sm font-medium focus:outline-none focus:ring-4 border-gray-600 bg-gray-800 text-white hover:border-gray-600 hover:bg-gray-700 focus:ring-gray-700 capitalize no-underline",
                    children: [
                      "New ",
                      (0, import_pluralize3.singular)(collection)
                    ]
                  })
                }),
                /* @__PURE__ */ (0, import_jsx_runtime.jsxs)("p", {
                  children: [
                    "To learn more about how documents work",
                    " ",
                    /* @__PURE__ */ (0, import_jsx_runtime.jsx)("a", {
                      href: "https://outstatic.com/docs/documents",
                      target: "_blank",
                      rel: "noreferrer",
                      children: "click here"
                    }),
                    "."
                  ]
                })
              ]
            })
          })
        ]
      })
    ]
  });
}

// src/pages/login.tsx
var import_head4 = __toESM(require("next/head"));
var import_link6 = __toESM(require("next/link"));
var import_jsx_runtime = require("react/jsx-runtime");
function Login() {
  return /* @__PURE__ */ (0, import_jsx_runtime.jsxs)(import_jsx_runtime.Fragment, {
    children: [
      /* @__PURE__ */ (0, import_jsx_runtime.jsx)(import_head4.default, {
        children: /* @__PURE__ */ (0, import_jsx_runtime.jsx)("title", {
          children: "Login to Outstatic"
        })
      }),
      /* @__PURE__ */ (0, import_jsx_runtime.jsx)("div", {
        className: "absolute bottom-10 w-full left-0 overflow-hidden z-0 md:-top-10",
        children: /* @__PURE__ */ (0, import_jsx_runtime.jsx)("svg", {
          width: "100%",
          height: "100%",
          viewBox: "0 0 1200 365",
          fill: "none",
          xmlns: "http://www.w3.org/2000/svg",
          children: /* @__PURE__ */ (0, import_jsx_runtime.jsx)("path", {
            d: "M-276.32 159.182C-232.477 130.613 -193.037 95.4797 -149.142 66.8773C-123.398 50.1026 -99.0091 30.5473 -69.5694 19.7442C-38.5686 8.36831 -2.85928 -3.31376 37.4064 4.54405C65.5725 10.0406 93.927 20.2194 125.473 43.3305C150.292 61.5127 166.609 84.5943 185.936 114.255C220.569 167.405 225.81 223.228 224.615 265.934C223.2 316.536 198.5 341.652 158.621 340.382C121.027 339.185 71.9868 320.328 45.0005 250.638C8.63388 156.723 111.095 159.937 149.344 159.325C235.509 157.945 334.997 185.056 433.145 218.102C547.034 256.448 651.041 336.753 780 356C940 384.5 1235.5 330.311 1237.95 70.5232",
            stroke: "#1E293B",
            className: "stroke-2 md:stroke-1",
            strokeLinecap: "round"
          })
        })
      }),
      /* @__PURE__ */ (0, import_jsx_runtime.jsxs)("main", {
        className: "relative flex h-screen flex-col items-center justify-center z-10 p-4",
        children: [
          /* @__PURE__ */ (0, import_jsx_runtime.jsx)("h1", {
            className: "mb-8 text-center text-xl font-semibold text-white",
            children: /* @__PURE__ */ (0, import_jsx_runtime.jsx)("svg", {
              fill: "none",
              height: "32",
              viewBox: "0 0 775 135",
              width: "200",
              xmlns: "http://www.w3.org/2000/svg",
              "aria-label": "Outstatic",
              children: /* @__PURE__ */ (0, import_jsx_runtime.jsxs)("g", {
                fill: "#1e293b",
                children: [
                  /* @__PURE__ */ (0, import_jsx_runtime.jsx)("path", {
                    d: "m63.9963 134.869c-11.3546 0-21.0957-1.913-29.2232-5.738-8.008-3.824-14.522-8.904-19.5419-15.239-5.02-6.454-8.72517-13.565-11.11562-21.3344-2.39045-7.769-3.585673-15.5379-3.585673-23.3069 0-7.5299 1.254983-15.1196 3.764953-22.769 2.62949-7.769 6.51394-14.8805 11.65344-21.3347 5.259-6.4543 11.773-11.6535 19.5419-15.59772 7.8885-3.94424 17.0917-5.91636 27.6097-5.91636 10.996 0 20.4383 1.97212 28.3268 5.91636 8.008 3.94422 14.5813 9.20322 19.7213 15.77692 5.139 6.4542 8.964 13.5061 11.474 21.1555 2.63 7.6494 3.944 15.2391 3.944 22.769 0 7.4104-1.314 15.0001-3.944 22.769-2.51 7.6495-6.394 14.7613-11.653 21.3343-5.14 6.455-11.5941 11.654-19.363 15.598-7.769 3.944-16.9722 5.917-27.6097 5.917zm.8964-9.323c6.9323 0 12.9084-1.554 17.9284-4.662 5.1394-3.107 9.3227-7.231 12.5498-12.37 3.3467-5.259 5.7971-10.9962 7.3511-17.2114 1.553-6.3347 2.33-12.6096 2.33-18.8248 0-7.6494-.896-15-2.689-22.0519-1.793-7.1713-4.5419-13.5658-8.2471-19.1833-3.5856-5.7371-8.0677-10.2192-13.4462-13.4463-5.3785-3.3466-11.5937-5.0199-18.6455-5.0199-6.9323 0-12.9682 1.6135-18.1077 4.8406-5.1394 3.2271-9.3227 7.4702-12.5498 12.7292-3.2271 5.1394-5.6773 10.8765-7.3506 17.2112-1.5538 6.2152-2.3307 12.4901-2.3307 18.8248 0 6.2151.8366 12.7889 2.5099 19.7212 1.6734 6.9323 4.2431 13.3865 7.7092 19.3626 3.4662 5.976 7.8885 10.817 13.267 14.522 5.4981 3.705 12.0718 5.558 19.7212 5.558z"
                  }),
                  /* @__PURE__ */ (0, import_jsx_runtime.jsx)("path", {
                    d: "m179.299 134.869c-6.693 0-12.251-1.255-16.673-3.765-4.303-2.51-7.53-6.634-9.681-12.371-2.152-5.857-3.227-13.566-3.227-23.1276v-28.1475c0-2.0319 0-4.1235 0-6.2749.119-2.271.358-4.4821.717-6.6335-2.032.1195-4.183.239-6.454.3585-2.271 0-4.303.0598-6.096.1793v-9.502h4.303c5.976 0 10.458-.5379 13.446-1.6136s5.08-2.2111 6.275-3.4064h6.813v54.6815c0 9.4422 1.314 16.4942 3.944 21.1552 2.629 4.662 7.052 6.933 13.267 6.813 4.064 0 7.948-1.195 11.653-3.586 3.825-2.39 6.933-5.199 9.323-8.426v-42.4901c0-2.6295.06-5.0797.179-7.3507.12-2.3904.359-4.6613.718-6.8127-2.152.1195-4.363.239-6.634.3585-2.271 0-4.363.0598-6.275.1793v-9.502h5.199c5.259 0 9.383-.5379 12.371-1.6136s5.139-2.2111 6.454-3.4064h6.813l-.179 65.9767c0 1.912-.06 4.542-.18 7.888-.119 3.227-.298 6.096-.538 8.606 2.032-.12 4.124-.239 6.275-.359 2.271-.119 4.363-.179 6.275-.179v9.502h-28.506c-.239-1.912-.478-3.705-.717-5.379-.119-1.673-.299-3.286-.538-4.84-3.705 3.466-8.008 6.514-12.908 9.143-4.901 2.63-10.04 3.945-15.419 3.945z"
                  }),
                  /* @__PURE__ */ (0, import_jsx_runtime.jsx)("path", {
                    d: "m283.918 134.869c-2.988 0-5.976-.419-8.964-1.255-2.988-.718-5.797-2.212-8.426-4.483-2.51-2.39-4.482-5.796-5.916-10.219-1.435-4.422-2.152-10.279-2.152-17.57l.359-48.9439h-13.267v-10.0399c3.227-.1196 6.514-1.3148 9.86-3.5857 3.347-2.2709 6.275-5.3187 8.785-9.1435 2.51-3.8247 4.243-7.9482 5.199-12.3705h8.427v25.0997h27.609v9.3227l-27.609.3586-.359 47.8687c0 4.5418.359 8.5458 1.076 12.0118.837 3.347 2.151 5.976 3.944 7.889 1.913 1.793 4.482 2.689 7.709 2.689 2.749 0 5.558-.837 8.427-2.51 2.988-1.673 5.796-4.422 8.426-8.247l6.096 5.378c-2.869 4.184-5.737 7.471-8.606 9.861-2.868 2.39-5.618 4.124-8.247 5.199-2.629 1.195-5.02 1.913-7.171 2.152-2.152.358-3.885.538-5.2.538z"
                  }),
                  /* @__PURE__ */ (0, import_jsx_runtime.jsx)("path", {
                    d: "m358.946 134.869c-5.618 0-10.817-.777-15.598-2.331-4.781-1.434-8.605-3.168-11.474-5.199l.538 5.916h-9.502l-.897-30.837h7.53c.239 4.423 1.614 8.427 4.124 12.012 2.51 3.586 5.737 6.395 9.681 8.427 4.064 2.031 8.426 3.047 13.088 3.047 2.749 0 5.438-.418 8.068-1.255 2.629-.956 4.84-2.33 6.633-4.123 1.793-1.913 2.689-4.243 2.689-6.992 0-2.988-.956-5.439-2.868-7.351-1.793-2.032-4.303-3.825-7.53-5.378-3.108-1.5542-6.693-3.108-10.757-4.6618-3.586-1.4342-7.231-2.9282-10.936-4.482-3.586-1.5538-6.933-3.4064-10.04-5.5578-3.108-2.1514-5.558-4.7809-7.351-7.8885-1.793-3.2271-2.689-7.1714-2.689-11.8327 0-2.749.538-5.6773 1.613-8.7849 1.076-3.2271 2.809-6.1554 5.2-8.7849 2.39-2.749 5.617-4.9602 9.681-6.6335 4.064-1.7928 9.084-2.6893 15.06-2.6893 3.227 0 6.812.5379 10.757 1.6136 4.063 1.0757 7.828 2.9283 11.295 5.5578l-.18-6.2749h9.502v31.5539h-7.709c-.358-4.1833-1.494-8.0678-3.406-11.6535-1.793-3.5856-4.363-6.5139-7.709-8.7849-3.347-2.2709-7.411-3.4064-12.192-3.4064-4.661 0-8.486 1.1953-11.474 3.5857-2.868 2.2709-4.303 5.1395-4.303 8.6056 0 3.4662 1.076 6.275 3.227 8.4264 2.271 2.1514 5.2 4.004 8.785 5.5578 3.586 1.5537 7.47 3.1075 11.654 4.6613 5.02 2.0319 9.741 4.2431 14.163 6.6335 4.422 2.3905 8.008 5.3785 10.757 8.9642s4.124 8.1273 4.124 13.6253c0 5.976-1.554 10.996-4.662 15.06-2.988 3.944-6.872 6.873-11.653 8.785s-9.861 2.869-15.239 2.869z"
                  }),
                  /* @__PURE__ */ (0, import_jsx_runtime.jsx)("path", {
                    d: "m439.216 134.869c-2.988 0-5.976-.419-8.964-1.255-2.988-.718-5.797-2.212-8.427-4.483-2.51-2.39-4.482-5.796-5.916-10.219-1.434-4.422-2.151-10.279-2.151-17.57l.358-48.9439h-13.267v-10.0399c3.227-.1196 6.514-1.3148 9.861-3.5857 3.346-2.2709 6.275-5.3187 8.785-9.1435 2.51-3.8247 4.243-7.9482 5.199-12.3705h8.426v25.0997h27.61v9.3227l-27.61.3586-.358 47.8687c0 4.5418.358 8.5458 1.075 12.0118.837 3.347 2.152 5.976 3.945 7.889 1.912 1.793 4.482 2.689 7.709 2.689 2.749 0 5.558-.837 8.426-2.51 2.988-1.673 5.797-4.422 8.426-8.247l6.096 5.378c-2.869 4.184-5.737 7.471-8.606 9.861-2.868 2.39-5.617 4.124-8.247 5.199-2.629 1.195-5.02 1.913-7.171 2.152-2.151.358-3.884.538-5.199.538z"
                  }),
                  /* @__PURE__ */ (0, import_jsx_runtime.jsx)("path", {
                    d: "m528.944 132c-.239-1.912-.418-3.586-.537-5.02-.12-1.434-.299-2.928-.538-4.482-4.064 4.064-8.427 7.171-13.088 9.323-4.661 2.032-9.502 3.048-14.522 3.048-8.606 0-15.119-2.092-19.542-6.275-4.303-4.303-6.454-9.622-6.454-15.957 0-5.498 1.614-10.279 4.841-14.3423 3.227-4.0638 7.47-7.3507 12.729-9.8606 5.259-2.6295 10.996-4.5419 17.211-5.7371 6.215-1.3148 12.311-1.9721 18.287-1.9721v-10.5778c0-3.8247-.359-7.3506-1.076-10.5777-.717-3.3466-2.211-6.0359-4.482-8.0678-2.151-2.1514-5.558-3.2271-10.219-3.2271-3.108-.1195-6.215.4781-9.323 1.7929-3.107 1.1952-5.498 3.2271-7.171 6.0956.956.9562 1.554 2.0917 1.793 3.4064.358 1.1952.538 2.3307.538 3.4064 0 1.6733-.718 3.5857-2.152 5.7371-1.434 2.0318-3.884 2.988-7.35 2.8685-2.869 0-5.08-.9562-6.634-2.8685-1.434-2.0319-2.151-4.3626-2.151-6.9921 0-4.3028 1.553-8.1275 4.661-11.4741 3.227-3.3467 7.59-5.9762 13.088-7.8885 5.498-1.9124 11.653-2.8686 18.466-2.8686 10.279 0 17.928 2.6893 22.948 8.0678 5.14 5.3785 7.709 13.8646 7.709 25.4583v12.3705c0 3.9443-.059 7.8885-.179 11.8328v12.55c0 1.793-.06 3.825-.179 6.095-.12 2.271-.299 4.662-.538 7.172 2.032-.12 4.124-.239 6.275-.359 2.151-.119 4.183-.179 6.096-.179v9.502zm-1.613-43.0281c-3.825.2391-7.769.7769-11.833 1.6136-3.944.8366-7.53 2.0916-10.757 3.7649s-5.856 3.8247-7.888 6.4546c-1.913 2.629-2.869 5.796-2.869 9.502.239 4.063 1.554 7.051 3.944 8.964 2.51 1.912 5.439 2.868 8.785 2.868 4.184 0 7.889-.777 11.116-2.33 3.227-1.674 6.394-3.945 9.502-6.813-.12-1.315-.179-2.63-.179-3.944 0-1.435 0-2.929 0-4.482 0-1.076 0-3.048 0-5.9168.119-2.988.179-6.2151.179-9.6813z"
                  }),
                  /* @__PURE__ */ (0, import_jsx_runtime.jsx)("path", {
                    d: "m602.217 134.869c-2.988 0-5.976-.419-8.964-1.255-2.988-.718-5.797-2.212-8.427-4.483-2.51-2.39-4.482-5.796-5.916-10.219-1.434-4.422-2.151-10.279-2.151-17.57l.358-48.9439h-13.267v-10.0399c3.227-.1196 6.514-1.3148 9.861-3.5857 3.346-2.2709 6.275-5.3187 8.785-9.1435 2.51-3.8247 4.243-7.9482 5.199-12.3705h8.426v25.0997h27.61v9.3227l-27.61.3586-.358 47.8687c0 4.5418.358 8.5458 1.075 12.0118.837 3.347 2.152 5.976 3.945 7.889 1.912 1.793 4.482 2.689 7.709 2.689 2.749 0 5.558-.837 8.426-2.51 2.988-1.673 5.797-4.422 8.426-8.247l6.096 5.378c-2.868 4.184-5.737 7.471-8.606 9.861-2.868 2.39-5.617 4.124-8.247 5.199-2.629 1.195-5.02 1.913-7.171 2.152-2.151.358-3.884.538-5.199.538z"
                  }),
                  /* @__PURE__ */ (0, import_jsx_runtime.jsx)("path", {
                    d: "m639.057 124.47c3.585 0 6.095-.837 7.53-2.51 1.434-1.673 2.271-4.004 2.51-6.992.358-2.988.538-6.454.538-10.398v-37.1121c0-2.0319.059-4.0638.179-6.0957.119-2.1514.299-4.4223.538-6.8127-2.032.1195-4.184.239-6.455.3585-2.27 0-4.362.0598-6.275.1793v-9.502c5.379 0 9.622-.2391 12.73-.7172 3.227-.5976 5.677-1.2549 7.35-1.9721 1.793-.7171 3.108-1.494 3.945-2.3307h6.812v69.2037c0 2.151-.059 4.362-.179 6.633-.119 2.152-.299 4.363-.538 6.634 1.913-.12 3.825-.179 5.737-.179 2.032-.12 3.885-.24 5.558-.359v9.502h-39.98zm19.183-100.3988c-3.107 0-5.737-1.1354-7.888-3.4063-2.152-2.3905-3.227-5.259-3.227-8.6057 0-3.34658 1.135-6.15536 3.406-8.42628 2.271-2.39045 4.841-3.5856788 7.709-3.5856788 3.108 0 5.677 1.1952288 7.709 3.5856788 2.152 2.27092 3.227 5.0797 3.227 8.42628 0 3.3467-1.075 6.2152-3.227 8.6057-2.032 2.2709-4.601 3.4063-7.709 3.4063z"
                  }),
                  /* @__PURE__ */ (0, import_jsx_runtime.jsx)("path", {
                    d: "m735.314 134.869c-8.008 0-15.359-1.793-22.052-5.379-6.693-3.705-12.072-8.964-16.136-15.777-3.944-6.813-5.916-15.0598-5.916-24.7411 0-6.4542 1.136-12.6096 3.407-18.4662 2.27-5.9761 5.438-11.2949 9.502-15.9562 4.183-4.6614 9.083-8.3068 14.701-10.9363 5.737-2.7491 12.072-4.1236 19.004-4.1236 7.052 0 13.088 1.0757 18.108 3.2271 5.019 2.1514 8.844 4.9602 11.474 8.4264 2.749 3.4661 4.123 7.2311 4.123 11.2948 0 2.8686-.837 5.3785-2.51 7.5299-1.673 2.1515-4.064 3.2272-7.171 3.2272-3.466.1195-5.917-.8965-7.351-3.0479-1.434-2.2709-2.151-4.3625-2.151-6.2749 0-1.0757.179-2.2709.538-3.5857.358-1.4342 1.016-2.6892 1.972-3.7649-.956-2.51-2.51-4.3626-4.662-5.5578-2.151-1.1952-4.362-1.9721-6.633-2.3307s-4.183-.5379-5.737-.5379c-7.291.1196-13.446 3.2869-18.466 9.5021-4.901 6.0956-7.351 14.9403-7.351 26.5339 0 7.4104 1.076 14.0439 3.227 19.9008 2.271 5.856 5.558 10.518 9.861 13.984s9.442 5.259 15.418 5.378c5.379 0 10.578-1.374 15.598-4.123 5.02-2.869 9.083-6.454 12.191-10.757l5.737 5.02c-3.466 5.378-7.47 9.621-12.012 12.729-4.422 3.107-8.964 5.319-13.625 6.633-4.542 1.315-8.905 1.973-13.088 1.973z"
                  })
                ]
              })
            })
          }),
          /* @__PURE__ */ (0, import_jsx_runtime.jsxs)("div", {
            className: "text-center mb-20 flex max-w-2xl flex-col items-center p-8 px-4 md:p-8 text-black bg-white rounded-lg border border-gray-200 shadow-md",
            children: [
              /* @__PURE__ */ (0, import_jsx_runtime.jsx)("p", {
                className: "mb-5",
                children: "Sign in with Github to access your\xA0dashboard."
              }),
              /* @__PURE__ */ (0, import_jsx_runtime.jsx)(import_link6.default, {
                href: "/api/outstatic/login",
                children: /* @__PURE__ */ (0, import_jsx_runtime.jsxs)("a", {
                  className: "mr-2 mb-2 inline-flex items-center rounded-lg bg-[#24292F] px-5 py-2.5 text-center text-sm font-medium text-white hover:bg-[#24292F]/90 focus:outline-none focus:ring-4 focus:ring-[#24292F]/50",
                  children: [
                    /* @__PURE__ */ (0, import_jsx_runtime.jsx)("svg", {
                      className: "mr-2 -ml-1 h-4 w-4",
                      "aria-hidden": "true",
                      focusable: "false",
                      "data-prefix": "fab",
                      "data-icon": "github",
                      role: "img",
                      xmlns: "http://www.w3.org/2000/svg",
                      viewBox: "0 0 496 512",
                      children: /* @__PURE__ */ (0, import_jsx_runtime.jsx)("path", {
                        fill: "currentColor",
                        d: "M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3 .3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5 .3-6.2 2.3zm44.2-1.7c-2.9 .7-4.9 2.6-4.6 4.9 .3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3 .7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3 .3 2.9 2.3 3.9 1.6 1 3.6 .7 4.3-.7 .7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3 .7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3 .7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"
                      })
                    }),
                    "Sign in with Github"
                  ]
                })
              })
            ]
          })
        ]
      })
    ]
  });
}

// src/pages/settings.tsx
var import_react29 = require("react");
var import_jsx_runtime = require("react/jsx-runtime");
function Settings() {
  const { repoSlug, contentPath } = (0, import_react29.useContext)(OutstaticContext);
  return /* @__PURE__ */ (0, import_jsx_runtime.jsxs)(AdminLayout, {
    title: "Settings",
    children: [
      /* @__PURE__ */ (0, import_jsx_runtime.jsx)("div", {
        className: "mb-8 flex h-12 items-center",
        children: /* @__PURE__ */ (0, import_jsx_runtime.jsx)("h1", {
          className: "mr-12 text-2xl",
          children: "Settings"
        })
      }),
      /* @__PURE__ */ (0, import_jsx_runtime.jsx)("div", {
        className: "max-w-lg",
        children: /* @__PURE__ */ (0, import_jsx_runtime.jsxs)("div", {
          className: "mb-20 max-w-2xl p-8 px-4 md:p-8 text-black bg-white rounded-lg border border-gray-200 shadow-md prose prose-base",
          children: [
            /* @__PURE__ */ (0, import_jsx_runtime.jsxs)("div", {
              children: [
                /* @__PURE__ */ (0, import_jsx_runtime.jsx)("label", {
                  className: "block mb-2 text-sm font-medium text-gray-900",
                  children: "Repository"
                }),
                /* @__PURE__ */ (0, import_jsx_runtime.jsx)("input", {
                  className: "cursor-not-allowed block p-2 w-full text-gray-900 bg-gray-50 rounded-lg border border-gray-300 sm:text-sm outline-none",
                  value: repoSlug,
                  readOnly: true
                })
              ]
            }),
            /* @__PURE__ */ (0, import_jsx_runtime.jsxs)("div", {
              className: "mt-4",
              children: [
                /* @__PURE__ */ (0, import_jsx_runtime.jsx)("label", {
                  className: "block mb-2 text-sm font-medium text-gray-900",
                  children: "Content Path"
                }),
                /* @__PURE__ */ (0, import_jsx_runtime.jsx)("input", {
                  className: "cursor-not-allowed block p-2 w-full text-gray-900 bg-gray-50 rounded-lg border border-gray-300 sm:text-sm outline-none",
                  value: `${contentPath}`,
                  readOnly: true
                })
              ]
            })
          ]
        })
      })
    ]
  });
}

// src/pages/welcome.tsx
var import_head5 = __toESM(require("next/head"));
var import_jsx_runtime = require("react/jsx-runtime");
function Welcome({ variables }) {
  return /* @__PURE__ */ (0, import_jsx_runtime.jsxs)(import_jsx_runtime.Fragment, {
    children: [
      /* @__PURE__ */ (0, import_jsx_runtime.jsx)(import_head5.default, {
        children: /* @__PURE__ */ (0, import_jsx_runtime.jsx)("title", {
          children: "Welcome to Outstatic"
        })
      }),
      /* @__PURE__ */ (0, import_jsx_runtime.jsx)("div", {
        className: "absolute bottom-10 w-full left-0 overflow-hidden z-0 md:-top-10",
        children: /* @__PURE__ */ (0, import_jsx_runtime.jsx)("svg", {
          width: "100%",
          height: "100%",
          viewBox: "0 0 1200 365",
          fill: "none",
          xmlns: "http://www.w3.org/2000/svg",
          children: /* @__PURE__ */ (0, import_jsx_runtime.jsx)("path", {
            d: "M-276.32 159.182C-232.477 130.613 -193.037 95.4797 -149.142 66.8773C-123.398 50.1026 -99.0091 30.5473 -69.5694 19.7442C-38.5686 8.36831 -2.85928 -3.31376 37.4064 4.54405C65.5725 10.0406 93.927 20.2194 125.473 43.3305C150.292 61.5127 166.609 84.5943 185.936 114.255C220.569 167.405 225.81 223.228 224.615 265.934C223.2 316.536 198.5 341.652 158.621 340.382C121.027 339.185 71.9868 320.328 45.0005 250.638C8.63388 156.723 111.095 159.937 149.344 159.325C235.509 157.945 334.997 185.056 433.145 218.102C547.034 256.448 651.041 336.753 780 356C940 384.5 1235.5 330.311 1237.95 70.5232",
            stroke: "#1E293B",
            className: "stroke-2 md:stroke-1",
            strokeLinecap: "round"
          })
        })
      }),
      /* @__PURE__ */ (0, import_jsx_runtime.jsxs)("main", {
        className: "relative flex h-screen flex-col items-center justify-center z-10 p-4",
        children: [
          /* @__PURE__ */ (0, import_jsx_runtime.jsx)("h1", {
            className: "mb-8 text-center text-xl font-semibold text-white",
            children: /* @__PURE__ */ (0, import_jsx_runtime.jsx)("svg", {
              fill: "none",
              height: "32",
              viewBox: "0 0 775 135",
              width: "200",
              xmlns: "http://www.w3.org/2000/svg",
              "aria-label": "Outstatic",
              children: /* @__PURE__ */ (0, import_jsx_runtime.jsxs)("g", {
                fill: "#1e293b",
                children: [
                  /* @__PURE__ */ (0, import_jsx_runtime.jsx)("path", {
                    d: "m63.9963 134.869c-11.3546 0-21.0957-1.913-29.2232-5.738-8.008-3.824-14.522-8.904-19.5419-15.239-5.02-6.454-8.72517-13.565-11.11562-21.3344-2.39045-7.769-3.585673-15.5379-3.585673-23.3069 0-7.5299 1.254983-15.1196 3.764953-22.769 2.62949-7.769 6.51394-14.8805 11.65344-21.3347 5.259-6.4543 11.773-11.6535 19.5419-15.59772 7.8885-3.94424 17.0917-5.91636 27.6097-5.91636 10.996 0 20.4383 1.97212 28.3268 5.91636 8.008 3.94422 14.5813 9.20322 19.7213 15.77692 5.139 6.4542 8.964 13.5061 11.474 21.1555 2.63 7.6494 3.944 15.2391 3.944 22.769 0 7.4104-1.314 15.0001-3.944 22.769-2.51 7.6495-6.394 14.7613-11.653 21.3343-5.14 6.455-11.5941 11.654-19.363 15.598-7.769 3.944-16.9722 5.917-27.6097 5.917zm.8964-9.323c6.9323 0 12.9084-1.554 17.9284-4.662 5.1394-3.107 9.3227-7.231 12.5498-12.37 3.3467-5.259 5.7971-10.9962 7.3511-17.2114 1.553-6.3347 2.33-12.6096 2.33-18.8248 0-7.6494-.896-15-2.689-22.0519-1.793-7.1713-4.5419-13.5658-8.2471-19.1833-3.5856-5.7371-8.0677-10.2192-13.4462-13.4463-5.3785-3.3466-11.5937-5.0199-18.6455-5.0199-6.9323 0-12.9682 1.6135-18.1077 4.8406-5.1394 3.2271-9.3227 7.4702-12.5498 12.7292-3.2271 5.1394-5.6773 10.8765-7.3506 17.2112-1.5538 6.2152-2.3307 12.4901-2.3307 18.8248 0 6.2151.8366 12.7889 2.5099 19.7212 1.6734 6.9323 4.2431 13.3865 7.7092 19.3626 3.4662 5.976 7.8885 10.817 13.267 14.522 5.4981 3.705 12.0718 5.558 19.7212 5.558z"
                  }),
                  /* @__PURE__ */ (0, import_jsx_runtime.jsx)("path", {
                    d: "m179.299 134.869c-6.693 0-12.251-1.255-16.673-3.765-4.303-2.51-7.53-6.634-9.681-12.371-2.152-5.857-3.227-13.566-3.227-23.1276v-28.1475c0-2.0319 0-4.1235 0-6.2749.119-2.271.358-4.4821.717-6.6335-2.032.1195-4.183.239-6.454.3585-2.271 0-4.303.0598-6.096.1793v-9.502h4.303c5.976 0 10.458-.5379 13.446-1.6136s5.08-2.2111 6.275-3.4064h6.813v54.6815c0 9.4422 1.314 16.4942 3.944 21.1552 2.629 4.662 7.052 6.933 13.267 6.813 4.064 0 7.948-1.195 11.653-3.586 3.825-2.39 6.933-5.199 9.323-8.426v-42.4901c0-2.6295.06-5.0797.179-7.3507.12-2.3904.359-4.6613.718-6.8127-2.152.1195-4.363.239-6.634.3585-2.271 0-4.363.0598-6.275.1793v-9.502h5.199c5.259 0 9.383-.5379 12.371-1.6136s5.139-2.2111 6.454-3.4064h6.813l-.179 65.9767c0 1.912-.06 4.542-.18 7.888-.119 3.227-.298 6.096-.538 8.606 2.032-.12 4.124-.239 6.275-.359 2.271-.119 4.363-.179 6.275-.179v9.502h-28.506c-.239-1.912-.478-3.705-.717-5.379-.119-1.673-.299-3.286-.538-4.84-3.705 3.466-8.008 6.514-12.908 9.143-4.901 2.63-10.04 3.945-15.419 3.945z"
                  }),
                  /* @__PURE__ */ (0, import_jsx_runtime.jsx)("path", {
                    d: "m283.918 134.869c-2.988 0-5.976-.419-8.964-1.255-2.988-.718-5.797-2.212-8.426-4.483-2.51-2.39-4.482-5.796-5.916-10.219-1.435-4.422-2.152-10.279-2.152-17.57l.359-48.9439h-13.267v-10.0399c3.227-.1196 6.514-1.3148 9.86-3.5857 3.347-2.2709 6.275-5.3187 8.785-9.1435 2.51-3.8247 4.243-7.9482 5.199-12.3705h8.427v25.0997h27.609v9.3227l-27.609.3586-.359 47.8687c0 4.5418.359 8.5458 1.076 12.0118.837 3.347 2.151 5.976 3.944 7.889 1.913 1.793 4.482 2.689 7.709 2.689 2.749 0 5.558-.837 8.427-2.51 2.988-1.673 5.796-4.422 8.426-8.247l6.096 5.378c-2.869 4.184-5.737 7.471-8.606 9.861-2.868 2.39-5.618 4.124-8.247 5.199-2.629 1.195-5.02 1.913-7.171 2.152-2.152.358-3.885.538-5.2.538z"
                  }),
                  /* @__PURE__ */ (0, import_jsx_runtime.jsx)("path", {
                    d: "m358.946 134.869c-5.618 0-10.817-.777-15.598-2.331-4.781-1.434-8.605-3.168-11.474-5.199l.538 5.916h-9.502l-.897-30.837h7.53c.239 4.423 1.614 8.427 4.124 12.012 2.51 3.586 5.737 6.395 9.681 8.427 4.064 2.031 8.426 3.047 13.088 3.047 2.749 0 5.438-.418 8.068-1.255 2.629-.956 4.84-2.33 6.633-4.123 1.793-1.913 2.689-4.243 2.689-6.992 0-2.988-.956-5.439-2.868-7.351-1.793-2.032-4.303-3.825-7.53-5.378-3.108-1.5542-6.693-3.108-10.757-4.6618-3.586-1.4342-7.231-2.9282-10.936-4.482-3.586-1.5538-6.933-3.4064-10.04-5.5578-3.108-2.1514-5.558-4.7809-7.351-7.8885-1.793-3.2271-2.689-7.1714-2.689-11.8327 0-2.749.538-5.6773 1.613-8.7849 1.076-3.2271 2.809-6.1554 5.2-8.7849 2.39-2.749 5.617-4.9602 9.681-6.6335 4.064-1.7928 9.084-2.6893 15.06-2.6893 3.227 0 6.812.5379 10.757 1.6136 4.063 1.0757 7.828 2.9283 11.295 5.5578l-.18-6.2749h9.502v31.5539h-7.709c-.358-4.1833-1.494-8.0678-3.406-11.6535-1.793-3.5856-4.363-6.5139-7.709-8.7849-3.347-2.2709-7.411-3.4064-12.192-3.4064-4.661 0-8.486 1.1953-11.474 3.5857-2.868 2.2709-4.303 5.1395-4.303 8.6056 0 3.4662 1.076 6.275 3.227 8.4264 2.271 2.1514 5.2 4.004 8.785 5.5578 3.586 1.5537 7.47 3.1075 11.654 4.6613 5.02 2.0319 9.741 4.2431 14.163 6.6335 4.422 2.3905 8.008 5.3785 10.757 8.9642s4.124 8.1273 4.124 13.6253c0 5.976-1.554 10.996-4.662 15.06-2.988 3.944-6.872 6.873-11.653 8.785s-9.861 2.869-15.239 2.869z"
                  }),
                  /* @__PURE__ */ (0, import_jsx_runtime.jsx)("path", {
                    d: "m439.216 134.869c-2.988 0-5.976-.419-8.964-1.255-2.988-.718-5.797-2.212-8.427-4.483-2.51-2.39-4.482-5.796-5.916-10.219-1.434-4.422-2.151-10.279-2.151-17.57l.358-48.9439h-13.267v-10.0399c3.227-.1196 6.514-1.3148 9.861-3.5857 3.346-2.2709 6.275-5.3187 8.785-9.1435 2.51-3.8247 4.243-7.9482 5.199-12.3705h8.426v25.0997h27.61v9.3227l-27.61.3586-.358 47.8687c0 4.5418.358 8.5458 1.075 12.0118.837 3.347 2.152 5.976 3.945 7.889 1.912 1.793 4.482 2.689 7.709 2.689 2.749 0 5.558-.837 8.426-2.51 2.988-1.673 5.797-4.422 8.426-8.247l6.096 5.378c-2.869 4.184-5.737 7.471-8.606 9.861-2.868 2.39-5.617 4.124-8.247 5.199-2.629 1.195-5.02 1.913-7.171 2.152-2.151.358-3.884.538-5.199.538z"
                  }),
                  /* @__PURE__ */ (0, import_jsx_runtime.jsx)("path", {
                    d: "m528.944 132c-.239-1.912-.418-3.586-.537-5.02-.12-1.434-.299-2.928-.538-4.482-4.064 4.064-8.427 7.171-13.088 9.323-4.661 2.032-9.502 3.048-14.522 3.048-8.606 0-15.119-2.092-19.542-6.275-4.303-4.303-6.454-9.622-6.454-15.957 0-5.498 1.614-10.279 4.841-14.3423 3.227-4.0638 7.47-7.3507 12.729-9.8606 5.259-2.6295 10.996-4.5419 17.211-5.7371 6.215-1.3148 12.311-1.9721 18.287-1.9721v-10.5778c0-3.8247-.359-7.3506-1.076-10.5777-.717-3.3466-2.211-6.0359-4.482-8.0678-2.151-2.1514-5.558-3.2271-10.219-3.2271-3.108-.1195-6.215.4781-9.323 1.7929-3.107 1.1952-5.498 3.2271-7.171 6.0956.956.9562 1.554 2.0917 1.793 3.4064.358 1.1952.538 2.3307.538 3.4064 0 1.6733-.718 3.5857-2.152 5.7371-1.434 2.0318-3.884 2.988-7.35 2.8685-2.869 0-5.08-.9562-6.634-2.8685-1.434-2.0319-2.151-4.3626-2.151-6.9921 0-4.3028 1.553-8.1275 4.661-11.4741 3.227-3.3467 7.59-5.9762 13.088-7.8885 5.498-1.9124 11.653-2.8686 18.466-2.8686 10.279 0 17.928 2.6893 22.948 8.0678 5.14 5.3785 7.709 13.8646 7.709 25.4583v12.3705c0 3.9443-.059 7.8885-.179 11.8328v12.55c0 1.793-.06 3.825-.179 6.095-.12 2.271-.299 4.662-.538 7.172 2.032-.12 4.124-.239 6.275-.359 2.151-.119 4.183-.179 6.096-.179v9.502zm-1.613-43.0281c-3.825.2391-7.769.7769-11.833 1.6136-3.944.8366-7.53 2.0916-10.757 3.7649s-5.856 3.8247-7.888 6.4546c-1.913 2.629-2.869 5.796-2.869 9.502.239 4.063 1.554 7.051 3.944 8.964 2.51 1.912 5.439 2.868 8.785 2.868 4.184 0 7.889-.777 11.116-2.33 3.227-1.674 6.394-3.945 9.502-6.813-.12-1.315-.179-2.63-.179-3.944 0-1.435 0-2.929 0-4.482 0-1.076 0-3.048 0-5.9168.119-2.988.179-6.2151.179-9.6813z"
                  }),
                  /* @__PURE__ */ (0, import_jsx_runtime.jsx)("path", {
                    d: "m602.217 134.869c-2.988 0-5.976-.419-8.964-1.255-2.988-.718-5.797-2.212-8.427-4.483-2.51-2.39-4.482-5.796-5.916-10.219-1.434-4.422-2.151-10.279-2.151-17.57l.358-48.9439h-13.267v-10.0399c3.227-.1196 6.514-1.3148 9.861-3.5857 3.346-2.2709 6.275-5.3187 8.785-9.1435 2.51-3.8247 4.243-7.9482 5.199-12.3705h8.426v25.0997h27.61v9.3227l-27.61.3586-.358 47.8687c0 4.5418.358 8.5458 1.075 12.0118.837 3.347 2.152 5.976 3.945 7.889 1.912 1.793 4.482 2.689 7.709 2.689 2.749 0 5.558-.837 8.426-2.51 2.988-1.673 5.797-4.422 8.426-8.247l6.096 5.378c-2.868 4.184-5.737 7.471-8.606 9.861-2.868 2.39-5.617 4.124-8.247 5.199-2.629 1.195-5.02 1.913-7.171 2.152-2.151.358-3.884.538-5.199.538z"
                  }),
                  /* @__PURE__ */ (0, import_jsx_runtime.jsx)("path", {
                    d: "m639.057 124.47c3.585 0 6.095-.837 7.53-2.51 1.434-1.673 2.271-4.004 2.51-6.992.358-2.988.538-6.454.538-10.398v-37.1121c0-2.0319.059-4.0638.179-6.0957.119-2.1514.299-4.4223.538-6.8127-2.032.1195-4.184.239-6.455.3585-2.27 0-4.362.0598-6.275.1793v-9.502c5.379 0 9.622-.2391 12.73-.7172 3.227-.5976 5.677-1.2549 7.35-1.9721 1.793-.7171 3.108-1.494 3.945-2.3307h6.812v69.2037c0 2.151-.059 4.362-.179 6.633-.119 2.152-.299 4.363-.538 6.634 1.913-.12 3.825-.179 5.737-.179 2.032-.12 3.885-.24 5.558-.359v9.502h-39.98zm19.183-100.3988c-3.107 0-5.737-1.1354-7.888-3.4063-2.152-2.3905-3.227-5.259-3.227-8.6057 0-3.34658 1.135-6.15536 3.406-8.42628 2.271-2.39045 4.841-3.5856788 7.709-3.5856788 3.108 0 5.677 1.1952288 7.709 3.5856788 2.152 2.27092 3.227 5.0797 3.227 8.42628 0 3.3467-1.075 6.2152-3.227 8.6057-2.032 2.2709-4.601 3.4063-7.709 3.4063z"
                  }),
                  /* @__PURE__ */ (0, import_jsx_runtime.jsx)("path", {
                    d: "m735.314 134.869c-8.008 0-15.359-1.793-22.052-5.379-6.693-3.705-12.072-8.964-16.136-15.777-3.944-6.813-5.916-15.0598-5.916-24.7411 0-6.4542 1.136-12.6096 3.407-18.4662 2.27-5.9761 5.438-11.2949 9.502-15.9562 4.183-4.6614 9.083-8.3068 14.701-10.9363 5.737-2.7491 12.072-4.1236 19.004-4.1236 7.052 0 13.088 1.0757 18.108 3.2271 5.019 2.1514 8.844 4.9602 11.474 8.4264 2.749 3.4661 4.123 7.2311 4.123 11.2948 0 2.8686-.837 5.3785-2.51 7.5299-1.673 2.1515-4.064 3.2272-7.171 3.2272-3.466.1195-5.917-.8965-7.351-3.0479-1.434-2.2709-2.151-4.3625-2.151-6.2749 0-1.0757.179-2.2709.538-3.5857.358-1.4342 1.016-2.6892 1.972-3.7649-.956-2.51-2.51-4.3626-4.662-5.5578-2.151-1.1952-4.362-1.9721-6.633-2.3307s-4.183-.5379-5.737-.5379c-7.291.1196-13.446 3.2869-18.466 9.5021-4.901 6.0956-7.351 14.9403-7.351 26.5339 0 7.4104 1.076 14.0439 3.227 19.9008 2.271 5.856 5.558 10.518 9.861 13.984s9.442 5.259 15.418 5.378c5.379 0 10.578-1.374 15.598-4.123 5.02-2.869 9.083-6.454 12.191-10.757l5.737 5.02c-3.466 5.378-7.47 9.621-12.012 12.729-4.422 3.107-8.964 5.319-13.625 6.633-4.542 1.315-8.905 1.973-13.088 1.973z"
                  })
                ]
              })
            })
          }),
          /* @__PURE__ */ (0, import_jsx_runtime.jsxs)("div", {
            className: "mb-20 max-w-2xl p-8 px-4 md:p-8 text-black bg-white rounded-lg border border-gray-200 shadow-md",
            children: [
              /* @__PURE__ */ (0, import_jsx_runtime.jsx)("p", {
                className: "mb-5",
                children: "Before you can access your admin area, make sure the following environment variables are set up:"
              }),
              /* @__PURE__ */ (0, import_jsx_runtime.jsx)("ul", {
                className: "mb-5",
                children: Object.entries(variables.required).map(([key, value]) => /* @__PURE__ */ (0, import_jsx_runtime.jsxs)("li", {
                  className: "mb-1",
                  children: [
                    `${value ? "\u2705" : "\u274C"} Variable`,
                    " ",
                    /* @__PURE__ */ (0, import_jsx_runtime.jsx)("span", {
                      className: "font-semibold",
                      children: key
                    }),
                    " ",
                    `is ${value ? "set." : "missing!"}`
                  ]
                }, key))
              }),
              !variables.optional.OST_CONTENT_PATH && /* @__PURE__ */ (0, import_jsx_runtime.jsxs)("p", {
                className: "mb-5 p-2 bg-blue-100 rounded",
                children: [
                  "Optional variable",
                  " ",
                  /* @__PURE__ */ (0, import_jsx_runtime.jsx)("span", {
                    className: "font-semibold",
                    children: "OST_CONTENT_PATH"
                  }),
                  " defines where your content is saved.",
                  /* @__PURE__ */ (0, import_jsx_runtime.jsx)("br", {}),
                  "Defaulting to ",
                  /* @__PURE__ */ (0, import_jsx_runtime.jsx)("code", {
                    children: "outstatic/content"
                  })
                ]
              }),
              !variables.optional.OST_REPO_OWNER && /* @__PURE__ */ (0, import_jsx_runtime.jsxs)("p", {
                className: "mb-5 p-2 bg-blue-100 rounded",
                children: [
                  "Optional variable",
                  " ",
                  /* @__PURE__ */ (0, import_jsx_runtime.jsx)("span", {
                    className: "font-semibold",
                    children: "OST_REPO_OWNER"
                  }),
                  " is not set.",
                  /* @__PURE__ */ (0, import_jsx_runtime.jsx)("br", {}),
                  "Defaulting to your Github user."
                ]
              }),
              /* @__PURE__ */ (0, import_jsx_runtime.jsx)("p", {
                children: "You need to restart Next.js to apply the changes."
              })
            ]
          })
        ]
      })
    ]
  });
}

// src/pages/index.tsx
var import_jsx_runtime = require("react/jsx-runtime");
var defaultPages = {
  settings: /* @__PURE__ */ (0, import_jsx_runtime.jsx)(Settings, {}),
  collections: void 0
};
var Outstatic = ({ missingEnvVars, providerData }) => {
  var _a, _b, _c, _d;
  const [pages2, setPages] = (0, import_react30.useState)(providerData == null ? void 0 : providerData.pages);
  const [collections, setCollections] = (0, import_react30.useState)(providerData == null ? void 0 : providerData.collections);
  const router3 = (0, import_router7.useRouter)();
  const client = useApollo(providerData == null ? void 0 : providerData.initialApolloState);
  const addPage = (page) => {
    if (pages2.includes(page))
      return;
    if (collections.includes(page))
      return;
    setPages([...pages2, page]);
    setCollections([...collections, page]);
  };
  const removePage = (page) => {
    setPages(pages2.filter((p) => p !== page));
    setCollections(collections.filter((p) => p !== page));
    console.log("removePage", page);
  };
  if (missingEnvVars)
    return /* @__PURE__ */ (0, import_jsx_runtime.jsx)(Welcome, {
      variables: missingEnvVars
    });
  const { session } = providerData;
  if (!session) {
    return /* @__PURE__ */ (0, import_jsx_runtime.jsx)(Login, {});
  }
  const slug = ((_b = (_a = router3.query) == null ? void 0 : _a.ost) == null ? void 0 : _b[0]) || "";
  const slug2 = ((_d = (_c = router3.query) == null ? void 0 : _c.ost) == null ? void 0 : _d[1]) || "";
  if (slug && !pages2.includes(slug)) {
    return /* @__PURE__ */ (0, import_jsx_runtime.jsx)(FourOhFour, {});
  }
  const isContent = slug && collections.includes(slug);
  return /* @__PURE__ */ (0, import_jsx_runtime.jsx)(OutstaticProvider, {
    ...providerData,
    pages: pages2,
    collections,
    addPage,
    removePage,
    children: /* @__PURE__ */ (0, import_jsx_runtime.jsxs)(import_client3.ApolloProvider, {
      client,
      children: [
        !slug && /* @__PURE__ */ (0, import_jsx_runtime.jsx)(Collections, {}),
        slug2 && isContent && /* @__PURE__ */ (0, import_jsx_runtime.jsx)(EditDocument, {
          collection: slug
        }),
        !slug2 && isContent ? /* @__PURE__ */ (0, import_jsx_runtime.jsx)(List, {
          collection: slug
        }) : defaultPages[slug],
        !!slug2 && !isContent && /* @__PURE__ */ (0, import_jsx_runtime.jsx)(EditCollection, {})
      ]
    })
  });
};
var OstSSP = async ({ req }) => {
  var _a, _b, _c, _d;
  if (envVars.hasMissingEnvVars) {
    return {
      props: {
        missingEnvVars: envVars.envVars
      }
    };
  }
  const session = await getLoginSession(req);
  const apolloClient2 = session ? initializeApollo(null, session) : null;
  let collections = [];
  if (apolloClient2) {
    try {
      const { data: postQueryData } = await apolloClient2.query({
        query: CollectionsDocument,
        variables: {
          name: process.env.OST_REPO_SLUG || process.env.VERCEL_GIT_REPO_SLUG,
          contentPath: `HEAD:${process.env.OST_MONOREPO_PATH ? process.env.OST_MONOREPO_PATH + "/" : ""}${process.env.OST_CONTENT_PATH || "outstatic/content"}`,
          owner: process.env.OST_REPO_OWNER || ((_a = session == null ? void 0 : session.user) == null ? void 0 : _a.login) || ""
        }
      });
      const postQueryObject = (_b = postQueryData == null ? void 0 : postQueryData.repository) == null ? void 0 : _b.object;
      if ((postQueryObject == null ? void 0 : postQueryObject.__typename) === "Tree") {
        collections = (_c = postQueryObject == null ? void 0 : postQueryObject.entries) == null ? void 0 : _c.map(
          (entry) => entry.name
        );
      }
    } catch (error) {
      console.log({ error });
    }
  }
  return {
    props: {
      missingEnvVars: false,
      providerData: {
        repoOwner: process.env.OST_REPO_OWNER || ((_d = session == null ? void 0 : session.user) == null ? void 0 : _d.login) || "",
        repoSlug: process.env.OST_REPO_SLUG || process.env.VERCEL_GIT_REPO_SLUG,
        contentPath: process.env.OST_CONTENT_PATH || "outstatic/content",
        monorepoPath: process.env.OST_MONOREPO_PATH || "",
        session: session || null,
        initialApolloState: (apolloClient2 == null ? void 0 : apolloClient2.cache.extract()) || null,
        collections,
        pages: [...Object.keys(defaultPages), ...collections]
      }
    }
  };
};

// src/pages/api/auth/callback.ts
var import_next_connect = require("next-connect");
var import_next_session = __toESM(require("next-session"));
var router = (0, import_next_connect.createRouter)();
var getSession2 = (0, import_next_session.default)();
async function getAccessToken(code) {
  const request = await fetch("https://github.com/login/oauth/access_token", {
    method: "POST",
    headers: {
      "Content-Type": "application/json"
    },
    body: JSON.stringify({
      client_id: process.env.OST_GITHUB_ID,
      client_secret: process.env.OST_GITHUB_SECRET,
      code
    })
  });
  const text = await request.text();
  const params = new URLSearchParams(text);
  return params.get("access_token");
}
async function fetchGitHubUser(token) {
  const request = await fetch("https://api.github.com/user", {
    headers: {
      Authorization: "token " + token
    }
  });
  return await request.json();
}
router.use(async (req, res, next) => {
  await getSession2(req, res);
  await next();
}).get(async (req, res) => {
  var _a;
  const code = (_a = req == null ? void 0 : req.query) == null ? void 0 : _a.code;
  const access_token = await getAccessToken(code);
  req.session.token = access_token;
  const userData = await fetchGitHubUser(access_token || "");
  if (!userData.email) {
    const emails = await (await fetch("https://api.github.com/user/emails", {
      headers: {
        Authorization: `token ${access_token}`
      }
    })).json();
    if ((emails === null || emails === void 0 ? void 0 : emails.length) > 0) {
      var _emails$find;
      userData.email = (_emails$find = emails.find(
        (email) => email.primary
      )) === null || _emails$find === void 0 ? void 0 : _emails$find.email;
      if (!userData.email)
        userData.email = emails[0].email;
    }
  }
  if (userData && access_token) {
    const { name, login, email, avatar_url } = userData;
    await setLoginSession(res, {
      user: { name, login, email, image: avatar_url },
      access_token,
      expires: new Date(Date.now() + MAX_AGE * 1e3)
    });
    res.redirect("/outstatic");
  } else {
    res.send("Login did not succeed!");
  }
});
var callback_default = router.handler({
  onError: (err, _, res) => {
    console.error(err);
    res.status(500).end("Something broke!");
  },
  onNoMatch: (_, res) => {
    res.status(404).end("Page is not found");
  }
});

// src/pages/api/auth/login.ts
var import_next_connect2 = require("next-connect");
var router2 = (0, import_next_connect2.createRouter)();
router2.get(async (_, res) => {
  res.redirect(
    `https://github.com/login/oauth/authorize?client_id=${process.env.OST_GITHUB_ID}&scope=repo%2C%20user&response_type=code`
  );
});
var login_default = router2.handler({
  onError: (_, __, res) => {
    res.status(500).end("Something broke 2!");
  },
  onNoMatch: (_, res) => {
    res.status(404).end("Page is not found");
  }
});

// src/pages/api/auth/signout.ts
async function logout(_, res) {
  removeTokenCookie(res);
  res.writeHead(302, { Location: "/" });
  res.end();
}

// src/pages/api/auth/user.ts
async function user(req, res) {
  try {
    const session = await getLoginSession(req);
    res.status(200).json({ session });
  } catch (error) {
    console.error(error);
    res.status(500).end("Authentication token is invalid, please log in");
  }
}

// src/pages/api/images/index.ts
var REPO_SLUG = process.env.OST_REPO_SLUG || process.env.VERCEL_GIT_REPO_SLUG;
var MONOREPO_PATH = process.env.OST_MONOREPO_PATH;
async function handler(req, res) {
  var _a, _b, _c;
  const session = await getLoginSession(req);
  if (session == null ? void 0 : session.access_token) {
    const response = await fetch(
      `https://raw.githubusercontent.com/${(_a = session == null ? void 0 : session.user) == null ? void 0 : _a.login}/${REPO_SLUG}/main/${MONOREPO_PATH ? MONOREPO_PATH + "/" : ""}public/images/${(_c = (_b = req.query) == null ? void 0 : _b.ost) == null ? void 0 : _c[1]}`,
      {
        headers: {
          authorization: `token ${session.access_token}`
        }
      }
    );
    if (response.status === 200 && response.body) {
      const buffer = Buffer.from(await response.arrayBuffer());
      res.setHeader("Cache-Control", "max-age=300");
      res.status(200).send(buffer);
      return;
    }
    res.status(response.status).send(response.statusText);
  } else {
    res.status(401);
    res.end();
  }
}

// src/pages/api/index.tsx
var pages = {
  callback: callback_default,
  login: login_default,
  signout: logout,
  user,
  images: handler
};
var OutstaticApi = (req, res) => {
  const { ost } = req.query;
  return pages[ost[0]](req, res);
};
// Annotate the CommonJS export names for ESM import in node:
0 && (module.exports = {
  OstSSP,
  Outstatic,
  OutstaticApi,
  OutstaticContext,
  OutstaticProvider,
  PostContext
});
